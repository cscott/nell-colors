/**
 * @license RequireJS domReady 1.0.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
/**
 * @license RequireJS text 1.0.7 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
/*!
 * iScroll v4.2.2 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
/*! @source http://purl.eligrey.com/github/BlobBuilder.js/blob/master/BlobBuilder.js */
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
/** @license
 * RequireJS plugin for loading web fonts using the WebFont Loader
 * Author: Miller Medeiros
 * Version: 0.2.0 (2011/12/06)
 * Released under the MIT license
 */
/** @license
 * RequireJS plugin for loading JSON files
 * - depends on Text plugin and it was HEAVILY "inspired" by it as well.
 * Author: Miller Medeiros
 * Version: 0.2.1 (2012/04/17)
 * Released under the MIT license
 */
define("domReady",[],function(){function i(a){for(var b=0,d;d=a[b];b++)d(c)}function j(){var a=d,c=e;b&&(a.length&&(d=[],i(a)),f.resourcesDone&&c.length&&(e=[],i(c)))}function k(){b||(b=!0,h&&clearInterval(h),j())}function l(a){return b?a(c):d.push(a),l}var a=typeof window!="undefined"&&window.document,b=!a,c=a?document:null,d=[],e=[],f=requirejs||require||{},g=f.resourcesReady,h;return"resourcesReady"in f&&(f.resourcesReady=function(a){g&&g(a),a&&j()}),a&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",k,!1),window.addEventListener("load",k,!1)):window.attachEvent&&(window.attachEvent("onload",k),self===self.top&&(h=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),k())}catch(a){}},30))),document.readyState==="complete"&&k()),l.withResources=function(a){return b&&f.resourcesDone?a(c):e.push(a),l},l.version="1.0.0",l.load=function(a,b,c,d){d.isBuild?c(null):l(c)},l}),define("img",[],function(){return{load:function(a,b,c,d){if(d.isBuild||typeof document=="undefined")c(null);else{var e=document.createElement("img");e.addEventListener("load",function(){c(e)}),e.src=b.toUrl(a)}}}}),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=typeof location!="undefined"&&location.href,e=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,g=d&&(location.port||undefined),h=[];define("text",[],function(){var i,j,k;return typeof window!="undefined"&&window.navigator&&window.document?j=function(a,b){var c=i.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(a){c.readyState===4&&b(c.responseText)},c.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node?(k=require.nodeRequire("fs"),j=function(a,b){var c=k.readFileSync(a,"utf8");c.indexOf("ï»¿")===0&&(c=c.substring(1)),b(c)}):typeof Packages!="undefined"?j=function(a,b){var c="utf-8",d=new java.io.File(a),e=java.lang.System.getProperty("line.separator"),f=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(d),c)),g,h,i="";try{g=new java.lang.StringBuffer,h=f.readLine(),h&&h.length()&&h.charAt(0)===65279&&(h=h.substring(1)),g.append(h);while((h=f.readLine())!==null)g.append(e),g.append(h);i=String(g.toString())}finally{f.close()}b(i)}:typeof XMLHttpRequest!="undefined"?j=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onreadystatechange=function(a){c.readyState===4&&b(c.responseText)},c.send(null)}:console.warn("No GET implementation found for text plugin."),i={version:"1.0.7",strip:function(a){if(a){a=a.replace(b,"");var d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var b,c,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(c=0;c<3;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw new Error("createXhr(): XMLHttpRequest not available");return b},get:j,parseName:function(a){var b=!1,c=a.indexOf("."),d=a.substring(0,c),e=a.substring(c+1,a.length);return c=e.indexOf("!"),c!==-1&&(b=e.substring(c+1,e.length),b=b==="strip",e=e.substring(0,c)),{moduleName:d,ext:e,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,c,d){var e=i.xdRegExp.exec(a),f,g,h;return e?(f=e[2],g=e[3],g=g.split(":"),h=g[1],g=g[0],(!f||f===b)&&(!g||g===c)&&(!h&&!g||h===d)):!0},finishLoad:function(a,b,c,d,e){c=b?i.strip(c):c,e.isBuild&&(h[a]=c),d(c)},load:function(a,b,c,h){if(h.isBuild&&!h.inlineText){c();return}var j=i.parseName(a),k=j.moduleName+"."+j.ext,l=b.toUrl(k),m=h&&h.text&&h.text.useXhr||i.useXhr;!d||m(l,e,f,g)?i.get(l,function(b){i.finishLoad(a,j.strip,b,c,h)}):b([k],function(a){i.finishLoad(j.moduleName+"."+j.ext,j.strip,a,c,h)})},write:function(a,b,c,d){if(b in h){var e=i.jsEscape(h[b]);c.asModule(a+"!"+b,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,b,c,d,e){var f=i.parseName(b),g=f.moduleName+"."+f.ext,h=c.toUrl(f.moduleName+"."+f.ext)+".js";i.load(g,c,function(b){var c=function(a){return d(h,a)};c.asModule=function(a,b){return d.asModule(a,h,b)},i.write(a,g,c,e)},e)}},i})}(),define("text!src/brushdialog.html",[],function(){return'<!-- this is innerHTML for a wrapper div -->\n    <div class="page_select">\n      <a class="brush_select" href="#"><span></span></a><!--\n      --><a class="color_select" href="#"><span></span></a>\n    </div>\n    <div class="panes">\n      <div class="brush_options">\n        <div class="stroke"></div>\n        <div class="shape" tabindex="0"><div class="scrollwrapper"><div class="allbrushes"></div></div></div>\n        <div class="spacing">\n          <div class="caption" data-amount="1"></div>\n          <a class="minus" href="#" tabindex="-1"></a><input class="brush_spacing" type="hidden" /><a class="plus" href="#" tabindex="-1"></a>\n        </div>\n        <div class="size">\n          <div class="caption" data-amount="1"></div>\n          <a class="minus" href="#" tabindex="-1"></a><input class="brush_size" type="hidden" /><a class="plus" href="#" tabindex="-1"></a>\n        </div>\n      </div>\n      <div class="color_options">\n        <div class="swatches">\n             <a href="#" class="white"><span></span></a><!--\n          --><a href="#" class="old"><span></span></a><!--\n          --><a          class="new" tabindex="-1"><span></span></a><!--\n          --><a href="#" class="black"><span></span></a>\n        </div>\n        <div class="wheel">\n          <div class="color" tabindex="0">\n            <div class="white"></div>\n            <div class="black"></div>\n          </div>\n          <div class="thumb"></div>\n          <input type="hidden" class="color_hue" />\n          <input type="hidden" class="color_saturation" />\n        </div>\n        <div class="lightness">\n          <input class="color_lightness" type="hidden" />\n        </div>\n      </div>\n    </div>\n    <div class="spacer"></div>\n    <div class="opacity_options">\n     <input class="color_opacity" type="hidden" />\n    </div>\n    <div class="close_pane">\n      <a class="closer" href="#"></a>\n    </div>\n    <input type="hidden" class="old_color_hue" />\n    <input type="hidden" class="old_color_saturation" />\n    <input type="hidden" class="old_color_lightness"  />\n    <input type="hidden" class="old_color_opacity"  />\n'}),define("src/coords",[],function(){var a=function(b){if(b.getBoundingClientRect){var c=b.getBoundingClientRect();return{x:c.left+document.body.scrollLeft,y:c.top+document.body.scrollTop}}var d={x:b.offsetLeft,y:b.offsetTop};if(b.offsetParent){var e=a(b.offsetParent);d.x+=e.x,d.y+=e.y}return d},b=function(b,c){var d,e,f;b=b||window.event;var g=b.target||b.srcElement;if(!window.opera&&typeof b.offsetX!="undefined"){f={x:b.offsetX,y:b.offsetY};var h=g;while(h)h.mouseX=f.x,h.mouseY=f.y,f.x+=h.offsetLeft,f.y+=h.offsetTop,h=h.offsetParent;h=c;var i={x:0,y:0};while(h){if(typeof h.mouseX!="undefined"){d=h.mouseX-i.x,e=h.mouseY-i.y;break}i.x+=h.offsetLeft,i.y+=h.offsetTop,h=h.offsetParent}h=g;while(h)h.mouseX=undefined,h.mouseY=undefined,h=h.offsetParent}else f=a(c),d=b.pageX-f.x,e=b.pageY-f.y;return{x:d,y:e}};return{getRelativeEventPosition:b,getAbsolutePosition:a}}),define("src/iscroll",[],function(){return function(a,b){function E(a){return e===""?a:(a=a.charAt(0).toUpperCase()+a.substr(1),e+a)}var c=Math,d=b.createElement("div").style,e=function(){var a="t,webkitT,MozT,msT,OT".split(","),b,c=0,e=a.length;for(;c<e;c++){b=a[c]+"ransform";if(b in d)return a[c].substr(0,a[c].length-1)}return!1}(),f=e?"-"+e.toLowerCase()+"-":"",g=E("transform"),h=E("transitionProperty"),i=E("transitionDuration"),j=E("transformOrigin"),k=E("transitionTimingFunction"),l=E("transitionDelay"),m=/android/gi.test(navigator.appVersion),n=/iphone|ipad/gi.test(navigator.appVersion),o=/hp-tablet/gi.test(navigator.appVersion),p=E("perspective")in d,q="ontouchstart"in a&&!o,r=!!e,s=E("transition")in d,t="onorientationchange"in a?"orientationchange":"resize",u=q?"touchstart":"mousedown",v=q?"touchmove":"mousemove",w=q?"touchend":"mouseup",x=q?"touchcancel":"mouseup",y=e=="Moz"?"DOMMouseScroll":"mousewheel",z=function(){if(e===!1)return!1;var a={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return a[e]}(),A=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),B=function(){return a.cancelRequestAnimationFrame||a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame||a.mozCancelRequestAnimationFrame||a.oCancelRequestAnimationFrame||a.msCancelRequestAnimationFrame||clearTimeout}(),C=p?" translateZ(0)":"",D=function(c,d){var e=this,l;e.wrapper=typeof c=="object"?c:b.getElementById(c),e.wrapper.style.overflow="hidden",e.scroller=e.wrapper.children[0],e.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:m,hideScrollbar:n,fadeScrollbar:n&&p,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(l in d)e.options[l]=d[l];e.x=e.options.x,e.y=e.options.y,e.options.useTransform=r&&e.options.useTransform,e.options.hScrollbar=e.options.hScroll&&e.options.hScrollbar,e.options.vScrollbar=e.options.vScroll&&e.options.vScrollbar,e.options.zoom=e.options.useTransform&&e.options.zoom,e.options.useTransition=s&&e.options.useTransition,e.options.zoom&&m&&(C=""),e.scroller.style[h]=e.options.useTransform?f+"transform":"top left",e.scroller.style[i]="0",e.scroller.style[j]="0 0",e.options.useTransition&&(e.scroller.style[k]="cubic-bezier(0.33,0.66,0.66,1)"),e.options.useTransform?e.scroller.style[g]="translate("+e.x+"px,"+e.y+"px)"+C:e.scroller.style.cssText+=";position:absolute;top:"+e.y+"px;left:"+e.x+"px",e.options.useTransition&&(e.options.fixedScrollbar=!0),e.refresh(),e._bind(t,a),e._bind(u),q||e.options.wheelAction!="none"&&e._bind(y),e.options.checkDOMChanges&&(e.checkDOMTime=setInterval(function(){e._checkDOMChanges()},500))};return D.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){var b=this;switch(a.type){case u:if(!q&&a.button!==0)return;b._start(a);break;case v:b._move(a);break;case w:case x:b._end(a);break;case t:b._resize();break;case y:b._wheel(a);break;case z:b._transitionEnd(a)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(a){var d=this,e;if(!d[a+"Scrollbar"]){d[a+"ScrollbarWrapper"]&&(r&&(d[a+"ScrollbarIndicator"].style[g]=""),d[a+"ScrollbarWrapper"].parentNode.removeChild(d[a+"ScrollbarWrapper"]),d[a+"ScrollbarWrapper"]=null,d[a+"ScrollbarIndicator"]=null);return}d[a+"ScrollbarWrapper"]||(e=b.createElement("div"),d.options.scrollbarClass?e.className=d.options.scrollbarClass+a.toUpperCase():e.style.cssText="position:absolute;z-index:100;"+(a=="h"?"height:7px;bottom:1px;left:2px;right:"+(d.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(d.hScrollbar?"7":"2")+"px;top:2px;right:1px"),e.style.cssText+=";pointer-events:none;"+f+"transition-property:opacity;"+f+"transition-duration:"+(d.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(d.options.hideScrollbar?"0":"1"),d.wrapper.appendChild(e),d[a+"ScrollbarWrapper"]=e,e=b.createElement("div"),d.options.scrollbarClass||(e.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+f+"background-clip:padding-box;"+f+"box-sizing:border-box;"+(a=="h"?"height:100%":"width:100%")+";"+f+"border-radius:3px;border-radius:3px"),e.style.cssText+=";pointer-events:none;"+f+"transition-property:"+f+"transform;"+f+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+f+"transition-duration:0;"+f+"transform: translate(0,0)"+C,d.options.useTransition&&(e.style.cssText+=";"+f+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),d[a+"ScrollbarWrapper"].appendChild(e),d[a+"ScrollbarIndicator"]=e),a=="h"?(d.hScrollbarSize=d.hScrollbarWrapper.clientWidth,d.hScrollbarIndicatorSize=c.max(c.round(d.hScrollbarSize*d.hScrollbarSize/d.scrollerW),8),d.hScrollbarIndicator.style.width=d.hScrollbarIndicatorSize+"px",d.hScrollbarMaxScroll=d.hScrollbarSize-d.hScrollbarIndicatorSize,d.hScrollbarProp=d.hScrollbarMaxScroll/d.maxScrollX):(d.vScrollbarSize=d.vScrollbarWrapper.clientHeight,d.vScrollbarIndicatorSize=c.max(c.round(d.vScrollbarSize*d.vScrollbarSize/d.scrollerH),8),d.vScrollbarIndicator.style.height=d.vScrollbarIndicatorSize+"px",d.vScrollbarMaxScroll=d.vScrollbarSize-d.vScrollbarIndicatorSize,d.vScrollbarProp=d.vScrollbarMaxScroll/d.maxScrollY),d._scrollbarPos(a,!0)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},m?200:0)},_pos:function(a,b){if(this.zoomed)return;a=this.hScroll?a:0,b=this.vScroll?b:0,this.options.useTransform?this.scroller.style[g]="translate("+a+"px,"+b+"px) scale("+this.scale+")"+C:(a=c.round(a),b=c.round(b),this.scroller.style.left=a+"px",this.scroller.style.top=b+"px"),this.x=a,this.y=b,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(a,b){var d=this,e=a=="h"?d.x:d.y,f;if(!d[a+"Scrollbar"])return;e=d[a+"ScrollbarProp"]*e,e<0?(d.options.fixedScrollbar||(f=d[a+"ScrollbarIndicatorSize"]+c.round(e*3),f<8&&(f=8),d[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=f+"px"),e=0):e>d[a+"ScrollbarMaxScroll"]&&(d.options.fixedScrollbar?e=d[a+"ScrollbarMaxScroll"]:(f=d[a+"ScrollbarIndicatorSize"]-c.round((e-d[a+"ScrollbarMaxScroll"])*3),f<8&&(f=8),d[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=f+"px",e=d[a+"ScrollbarMaxScroll"]+(d[a+"ScrollbarIndicatorSize"]-f))),d[a+"ScrollbarWrapper"].style[l]="0",d[a+"ScrollbarWrapper"].style.opacity=b&&d.options.hideScrollbar?"0":"1",d[a+"ScrollbarIndicator"].style[g]="translate("+(a=="h"?e+"px,0)":"0,"+e+"px)")+C},_start:function(b){var d=this,e=q?b.touches[0]:b,f,h,i,j,k;if(!d.enabled)return;d.options.onBeforeScrollStart&&d.options.onBeforeScrollStart.call(d,b),(d.options.useTransition||d.options.zoom)&&d._transitionTime(0),d.moved=!1,d.animating=!1,d.zoomed=!1,d.distX=0,d.distY=0,d.absDistX=0,d.absDistY=0,d.dirX=0,d.dirY=0,d.options.zoom&&q&&b.touches.length>1&&(j=c.abs(b.touches[0].pageX-b.touches[1].pageX),k=c.abs(b.touches[0].pageY-b.touches[1].pageY),d.touchesDistStart=c.sqrt(j*j+k*k),d.originX=c.abs(b.touches[0].pageX+b.touches[1].pageX-d.wrapperOffsetLeft*2)/2-d.x,d.originY=c.abs(b.touches[0].pageY+b.touches[1].pageY-d.wrapperOffsetTop*2)/2-d.y,d.options.onZoomStart&&d.options.onZoomStart.call(d,b));if(d.options.momentum){d.options.useTransform?(f=getComputedStyle(d.scroller,null)[g].replace(/[^0-9\-.,]/g,"").split(","),h=+f[4],i=+f[5]):(h=+getComputedStyle(d.scroller,null).left.replace(/[^0-9-]/g,""),i=+getComputedStyle(d.scroller,null).top.replace(/[^0-9-]/g,""));if(h!=d.x||i!=d.y)d.options.useTransition?d._unbind(z):B(d.aniTime),d.steps=[],d._pos(h,i),d.options.onScrollEnd&&d.options.onScrollEnd.call(d)}d.absStartX=d.x,d.absStartY=d.y,d.startX=d.x,d.startY=d.y,d.pointX=e.pageX,d.pointY=e.pageY,d.startTime=b.timeStamp||Date.now(),d.options.onScrollStart&&d.options.onScrollStart.call(d,b),d._bind(v,a),d._bind(w,a),d._bind(x,a)},_move:function(a){var b=this,d=q?a.touches[0]:a,e=d.pageX-b.pointX,f=d.pageY-b.pointY,h=b.x+e,i=b.y+f,j,k,l,m=a.timeStamp||Date.now();b.options.onBeforeScrollMove&&b.options.onBeforeScrollMove.call(b,a);if(b.options.zoom&&q&&a.touches.length>1){j=c.abs(a.touches[0].pageX-a.touches[1].pageX),k=c.abs(a.touches[0].pageY-a.touches[1].pageY),b.touchesDist=c.sqrt(j*j+k*k),b.zoomed=!0,l=1/b.touchesDistStart*b.touchesDist*this.scale,l<b.options.zoomMin?l=.5*b.options.zoomMin*Math.pow(2,l/b.options.zoomMin):l>b.options.zoomMax&&(l=2*b.options.zoomMax*Math.pow(.5,b.options.zoomMax/l)),b.lastScale=l/this.scale,h=this.originX-this.originX*b.lastScale+this.x,i=this.originY-this.originY*b.lastScale+this.y,this.scroller.style[g]="translate("+h+"px,"+i+"px) scale("+l+")"+C,b.options.onZoom&&b.options.onZoom.call(b,a);return}b.pointX=d.pageX,b.pointY=d.pageY;if(h>0||h<b.maxScrollX)h=b.options.bounce?b.x+e/2:h>=0||b.maxScrollX>=0?0:b.maxScrollX;if(i>b.minScrollY||i<b.maxScrollY)i=b.options.bounce?b.y+f/2:i>=b.minScrollY||b.maxScrollY>=0?b.minScrollY:b.maxScrollY;b.distX+=e,b.distY+=f,b.absDistX=c.abs(b.distX),b.absDistY=c.abs(b.distY);if(b.absDistX<6&&b.absDistY<6)return;b.options.lockDirection&&(b.absDistX>b.absDistY+5?(i=b.y,f=0):b.absDistY>b.absDistX+5&&(h=b.x,e=0)),b.moved=!0,b._pos(h,i),b.dirX=e>0?-1:e<0?1:0,b.dirY=f>0?-1:f<0?1:0,m-b.startTime>300&&(b.startTime=m,b.startX=b.x,b.startY=b.y),b.options.onScrollMove&&b.options.onScrollMove.call(b,a)},_end:function(d){if(q&&d.touches.length!==0)return;var e=this,f=q?d.changedTouches[0]:d,h,j,k={dist:0,time:0},l={dist:0,time:0},m=(d.timeStamp||Date.now())-e.startTime,n=e.x,o=e.y,p,r,s,t,u;e._unbind(v,a),e._unbind(w,a),e._unbind(x,a),e.options.onBeforeScrollEnd&&e.options.onBeforeScrollEnd.call(e,d);if(e.zoomed){u=e.scale*e.lastScale,u=Math.max(e.options.zoomMin,u),u=Math.min(e.options.zoomMax,u),e.lastScale=u/e.scale,e.scale=u,e.x=e.originX-e.originX*e.lastScale+e.x,e.y=e.originY-e.originY*e.lastScale+e.y,e.scroller.style[i]="200ms",e.scroller.style[g]="translate("+e.x+"px,"+e.y+"px) scale("+e.scale+")"+C,e.zoomed=!1,e.refresh(),e.options.onZoomEnd&&e.options.onZoomEnd.call(e,d);return}if(!e.moved){q&&(e.doubleTapTimer&&e.options.zoom?(clearTimeout(e.doubleTapTimer),e.doubleTapTimer=null,e.options.onZoomStart&&e.options.onZoomStart.call(e,d),e.zoom(e.pointX,e.pointY,e.scale==1?e.options.doubleTapZoom:1),e.options.onZoomEnd&&setTimeout(function(){e.options.onZoomEnd.call(e,d)},200)):this.options.handleClick&&(e.doubleTapTimer=setTimeout(function(){e.doubleTapTimer=null,h=f.target;while(h.nodeType!=1)h=h.parentNode;h.tagName!="SELECT"&&h.tagName!="INPUT"&&h.tagName!="TEXTAREA"&&(j=b.createEvent("MouseEvents"),j.initMouseEvent("click",!0,!0,d.view,1,f.screenX,f.screenY,f.clientX,f.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,null),j._fake=!0,h.dispatchEvent(j))},e.options.zoom?250:0))),e._resetPos(400),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d);return}if(m<300&&e.options.momentum){k=n?e._momentum(n-e.startX,m,-e.x,e.scrollerW-e.wrapperW+e.x,e.options.bounce?e.wrapperW:0):k,l=o?e._momentum(o-e.startY,m,-e.y,e.maxScrollY<0?e.scrollerH-e.wrapperH+e.y-e.minScrollY:0,e.options.bounce?e.wrapperH:0):l,n=e.x+k.dist,o=e.y+l.dist;if(e.x>0&&n>0||e.x<e.maxScrollX&&n<e.maxScrollX)k={dist:0,time:0};if(e.y>e.minScrollY&&o>e.minScrollY||e.y<e.maxScrollY&&o<e.maxScrollY)l={dist:0,time:0}}if(k.dist||l.dist){s=c.max(c.max(k.time,l.time),10),e.options.snap&&(p=n-e.absStartX,r=o-e.absStartY,c.abs(p)<e.options.snapThreshold&&c.abs(r)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(t=e._snap(n,o),n=t.x,o=t.y,s=c.max(t.time,s))),e.scrollTo(c.round(n),c.round(o),s),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d);return}if(e.options.snap){p=n-e.absStartX,r=o-e.absStartY,c.abs(p)<e.options.snapThreshold&&c.abs(r)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(t=e._snap(e.x,e.y),(t.x!=e.x||t.y!=e.y)&&e.scrollTo(t.x,t.y,t.time)),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d);return}e._resetPos(200),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,d)},_resetPos:function(a){var b=this,c=b.x>=0?0:b.x<b.maxScrollX?b.maxScrollX:b.x,d=b.y>=b.minScrollY||b.maxScrollY>0?b.minScrollY:b.y<b.maxScrollY?b.maxScrollY:b.y;if(c==b.x&&d==b.y){b.moved&&(b.moved=!1,b.options.onScrollEnd&&b.options.onScrollEnd.call(b)),b.hScrollbar&&b.options.hideScrollbar&&(e=="webkit"&&(b.hScrollbarWrapper.style[l]="300ms"),b.hScrollbarWrapper.style.opacity="0"),b.vScrollbar&&b.options.hideScrollbar&&(e=="webkit"&&(b.vScrollbarWrapper.style[l]="300ms"),b.vScrollbarWrapper.style.opacity="0");return}b.scrollTo(c,d,a||0)},_wheel:function(a){var b=this,c,d,e,f,g;if("wheelDeltaX"in a)c=a.wheelDeltaX/12,d=a.wheelDeltaY/12;else if("wheelDelta"in a)c=d=a.wheelDelta/12;else if("detail"in a)c=d=-a.detail*3;else return;if(b.options.wheelAction=="zoom"){g=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),g<b.options.zoomMin&&(g=b.options.zoomMin),g>b.options.zoomMax&&(g=b.options.zoomMax),g!=b.scale&&(!b.wheelZoomCount&&b.options.onZoomStart&&b.options.onZoomStart.call(b,a),b.wheelZoomCount++,b.zoom(a.pageX,a.pageY,g,400),setTimeout(function(){b.wheelZoomCount--,!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,a)},400));return}e=b.x+c,f=b.y+d,e>0?e=0:e<b.maxScrollX&&(e=b.maxScrollX),f>b.minScrollY?f=b.minScrollY:f<b.maxScrollY&&(f=b.maxScrollY),b.maxScrollY<0&&b.scrollTo(e,f,0)},_transitionEnd:function(a){var b=this;if(a.target!=b.scroller)return;b._unbind(z),b._startAni()},_startAni:function(){var a=this,b=a.x,d=a.y,e=Date.now(),f,g,h;if(a.animating)return;if(!a.steps.length){a._resetPos(400);return}f=a.steps.shift(),f.x==b&&f.y==d&&(f.time=0),a.animating=!0,a.moved=!0;if(a.options.useTransition){a._transitionTime(f.time),a._pos(f.x,f.y),a.animating=!1,f.time?a._bind(z):a._resetPos(0);return}h=function(){var i=Date.now(),j,k;if(i>=e+f.time){a._pos(f.x,f.y),a.animating=!1,a.options.onAnimationEnd&&a.options.onAnimationEnd.call(a),a._startAni();return}i=(i-e)/f.time-1,g=c.sqrt(1-i*i),j=(f.x-b)*g+b,k=(f.y-d)*g+d,a._pos(j,k),a.animating&&(a.aniTime=A(h))},h()},_transitionTime:function(a){a+="ms",this.scroller.style[i]=a,this.hScrollbar&&(this.hScrollbarIndicator.style[i]=a),this.vScrollbar&&(this.vScrollbarIndicator.style[i]=a)},_momentum:function(a,b,d,e,f){var g=6e-4,h=c.abs(a)/b,i=h*h/(2*g),j=0,k=0;return a>0&&i>d?(k=f/(6/(i/h*g)),d+=k,h=h*d/i,i=d):a<0&&i>e&&(k=f/(6/(i/h*g)),e+=k,h=h*e/i,i=e),i*=a<0?-1:1,j=h/g,{dist:i,time:c.round(j)}},_offset:function(a){var b=-a.offsetLeft,c=-a.offsetTop;while(a=a.offsetParent)b-=a.offsetLeft,c-=a.offsetTop;return a!=this.wrapper&&(b*=this.scale,c*=this.scale),{left:b,top:c}},_snap:function(a,b){var d=this,e,f,g,h,i,j;g=d.pagesX.length-1;for(e=0,f=d.pagesX.length;e<f;e++)if(a>=d.pagesX[e]){g=e;break}g==d.currPageX&&g>0&&d.dirX<0&&g--,a=d.pagesX[g],i=c.abs(a-d.pagesX[d.currPageX]),i=i?c.abs(d.x-a)/i*500:0,d.currPageX=g,g=d.pagesY.length-1;for(e=0;e<g;e++)if(b>=d.pagesY[e]){g=e;break}return g==d.currPageY&&g>0&&d.dirY<0&&g--,b=d.pagesY[g],j=c.abs(b-d.pagesY[d.currPageY]),j=j?c.abs(d.y-b)/j*500:0,d.currPageY=g,h=c.round(c.max(i,j))||200,{x:a,y:b,time:h}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){var b=this;b.scroller.style[g]="",b.hScrollbar=!1,b.vScrollbar=!1,b._scrollbar("h"),b._scrollbar("v"),b._unbind(t,a),b._unbind(u),b._unbind(v,a),b._unbind(w,a),b._unbind(x,a),b.options.hasTouch||b._unbind(y),b.options.useTransition&&b._unbind(z),b.options.checkDOMChanges&&clearInterval(b.checkDOMTime),b.options.onDestroy&&b.options.onDestroy.call(b)},refresh:function(){var a=this,b,d,e,f,g=0,h=0;a.scale<a.options.zoomMin&&(a.scale=a.options.zoomMin),a.wrapperW=a.wrapper.clientWidth||1,a.wrapperH=a.wrapper.clientHeight||1,a.minScrollY=-a.options.topOffset||0,a.scrollerW=c.round(a.scroller.offsetWidth*a.scale),a.scrollerH=c.round((a.scroller.offsetHeight+a.minScrollY)*a.scale),a.maxScrollX=a.wrapperW-a.scrollerW,a.maxScrollY=a.wrapperH-a.scrollerH+a.minScrollY,a.dirX=0,a.dirY=0,a.options.onRefresh&&a.options.onRefresh.call(a),a.hScroll=a.options.hScroll&&a.maxScrollX<0,a.vScroll=a.options.vScroll&&(!a.options.bounceLock&&!a.hScroll||a.scrollerH>a.wrapperH),a.hScrollbar=a.hScroll&&a.options.hScrollbar,a.vScrollbar=a.vScroll&&a.options.vScrollbar&&a.scrollerH>a.wrapperH,b=a._offset(a.wrapper),a.wrapperOffsetLeft=-b.left,a.wrapperOffsetTop=-b.top;if(typeof a.options.snap=="string"){a.pagesX=[],a.pagesY=[],f=a.scroller.querySelectorAll(a.options.snap);for(d=0,e=f.length;d<e;d++)g=a._offset(f[d]),g.left+=a.wrapperOffsetLeft,g.top+=a.wrapperOffsetTop,a.pagesX[d]=g.left<a.maxScrollX?a.maxScrollX:g.left*a.scale,a.pagesY[d]=g.top<a.maxScrollY?a.maxScrollY:g.top*a.scale}else if(typeof a.options.snap=="number"){a.pagesX=[];while(g>=a.maxScrollX)a.pagesX[h]=g,g-=a.options.snap,h++;a.maxScrollX%a.options.snap&&(a.pagesX[a.pagesX.length]=a.maxScrollX-a.pagesX[a.pagesX.length-1]+a.pagesX[a.pagesX.length-1]),g=0,h=0,a.pagesY=[];while(g>=a.maxScrollY)a.pagesY[h]=g,g-=a.options.snap,h++;a.maxScrollY%a.options.snap&&(a.pagesY[a.pagesY.length]=a.maxScrollY-a.pagesY[a.pagesY.length-1]+a.pagesY[a.pagesY.length-1])}else if(a.options.snap){a.pagesX=[];while(g>=a.maxScrollX)a.pagesX[h]=g,g-=a.wrapperW,h++;a.maxScrollX%a.wrapperW&&(a.pagesX[a.pagesX.length]=a.maxScrollX-a.pagesX[a.pagesX.length-1]+a.pagesX[a.pagesX.length-1]),g=0,h=0,a.pagesY=[];while(g>=a.maxScrollY)a.pagesY[h]=g,g-=a.wrapperH,h++;a.maxScrollY%a.wrapperH&&(a.pagesY[a.pagesY.length]=a.maxScrollY-a.pagesY[a.pagesY.length-1]+a.pagesY[a.pagesY.length-1])}a._scrollbar("h"),a._scrollbar("v"),a.zoomed||(a.scroller.style[i]="0",a._resetPos(400))},scrollTo:function(a,b,c,d){var e=this,f=a,g,h;e.stop(),f.length||(f=[{x:a,y:b,time:c,relative:d}]);for(g=0,h=f.length;g<h;g++)f[g].relative&&(f[g].x=e.x-f[g].x,f[g].y=e.y-f[g].y),e.steps.push({x:f[g].x,y:f[g].y,time:f[g].time||0});e._startAni()},scrollToElement:function(a,b){var d=this,e;a=a.nodeType?a:d.scroller.querySelector(a);if(!a)return;e=d._offset(a),e.left+=d.wrapperOffsetLeft,e.top+=d.wrapperOffsetTop,e.left=e.left>0?0:e.left<d.maxScrollX?d.maxScrollX:e.left,e.top=e.top>d.minScrollY?d.minScrollY:e.top<d.maxScrollY?d.maxScrollY:e.top,b=b===undefined?c.max(c.abs(e.left)*2,c.abs(e.top)*2):b,d.scrollTo(e.left,e.top,b)},scrollToPage:function(a,b,c){var d=this,e,f;c=c===undefined?400:c,d.options.onScrollStart&&d.options.onScrollStart.call(d),d.options.snap?(a=a=="next"?d.currPageX+1:a=="prev"?d.currPageX-1:a,b=b=="next"?d.currPageY+1:b=="prev"?d.currPageY-1:b,a=a<0?0:a>d.pagesX.length-1?d.pagesX.length-1:a,b=b<0?0:b>d.pagesY.length-1?d.pagesY.length-1:b,d.currPageX=a,d.currPageY=b,e=d.pagesX[a],f=d.pagesY[b]):(e=-d.wrapperW*a,f=-d.wrapperH*b,e<d.maxScrollX&&(e=d.maxScrollX),f<d.maxScrollY&&(f=d.maxScrollY)),d.scrollTo(e,f,c)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(v,a),this._unbind(w,a),this._unbind(x,a)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(z):B(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(a,b,c,d){var e=this,f=c/e.scale;if(!e.options.useTransform)return;e.zoomed=!0,d=d===undefined?200:d,a=a-e.wrapperOffsetLeft-e.x,b=b-e.wrapperOffsetTop-e.y,e.x=a-a*f+e.x,e.y=b-b*f+e.y,e.scale=c,e.refresh(),e.x=e.x>0?0:e.x<e.maxScrollX?e.maxScrollX:e.x,e.y=e.y>e.minScrollY?e.minScrollY:e.y<e.maxScrollY?e.maxScrollY:e.y,e.scroller.style[i]=d+"ms",e.scroller.style[g]="translate("+e.x+"px,"+e.y+"px) scale("+c+")"+C,e.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},d=null,D}(window,document)}),define("src/slider",[],function(){function s(a){function W(a){if(d&&!a)return;try{f(S,"mouseover",be),f(S,"mouseout",bf),f(S,"mousedown",bk),f(S,"touchstart",bk),f(U,"focus",_),f(U,"blur",ba),window.opera?f(U,"keypress",bd):(f(U,"keydown",bd),f(U,"keypress",bc)),f(U,"mousedown",bh),f(U,"touchstart",bh),f(U,"mouseup",bg),f(U,"touchend",bg),f(U,"touchcancel",bg),c&&!x&&(window.addEventListener&&!window.devicePixelRatio?window.removeEventListener("DOMMouseScroll",bb,!1):(f(document,"mousewheel",bb),f(window,"mousewheel",bb)))}catch(e){}clearTimeout(y),S.classList.add("slider-disabled"),S.setAttribute("aria-disabled",!0),b.disabled=d=!0,a||$("disable")}function X(a){if(!d&&!a)return;e(S,"mouseover",be),e(S,"mouseout",bf),e(S,"mousedown",bk),e(S,"touchstart",bk),window.opera?e(U,"keypress",bd):(e(U,"keydown",bd),e(U,"keypress",bc)),e(U,"focus",_),e(U,"blur",ba),e(U,"mousedown",bh),e(U,"touchstart",bh),e(U,"mouseup",bg),e(U,"touchend",bg),e(U,"touchcancel",bg),S.classList.remove("slider-disabled"),S.setAttribute("aria-disabled",!1),b.disabled=d=!1,a||$("enable")}function Y(){try{W(),S.parentNode.removeChild(S)}catch(a){}T=V=U=S=y=null,$("destroy"),v=null}function Z(){bn();try{var a=S.offsetWidth,b=S.offsetHeight,c=U.offsetWidth,d=U.offsetHeight,e=V.offsetHeight,f=V.offsetWidth;J=u?b-d:a-c,O=J/o,N=J/Math.ceil(k/m),B=a,A=b,bs()}catch(g){}$("redraw")}function $(a){var c={elem:b,value:h=="select"?b.options[b.selectedIndex].value:b.value};if(a in v)for(var d=0,e;e=v[a][d];d++)e(c)}function _(a){S.classList.add("focused"),c&&!x&&(e(window,"DOMMouseScroll",bb),e(document,"mousewheel",bb),window.opera||e(window,"mousewheel",bb)),$("focus")}function ba(a){S.classList.remove("focused"),S.classList.remove("fd-fc-slider-hover"),S.classList.remove("fd-slider-hover"),c&&!x&&(f(document,"mousewheel",bb),f(window,"DOMMouseScroll",bb),window.opera||f(window,"mousewheel",bb)),$("blur")}function bb(a){if(!z)return;a=a||window.event;var b=0;a.wheelDelta?(b=a.wheelDelta/120,window.opera&&window.opera.version()<9.2&&(b=-b)):a.detail&&(b=-a.detail/3),u&&(b=-b);if(b){var c=u?U.offsetTop:U.offsetLeft;c=b<0?Math.ceil(c+N):Math.floor(c-N),br(Math.min(Math.max(c,0),J))}return g(a)}function bc(a){return a=a||document.parentWindow.event,a.keyCode>=33&&a.keyCode<=40||!z||a.keyCode==45||a.keyCode==46?g(a):!0}function bd(a){if(!z)return!0;a=a||document.parentWindow.event;var c=a.keyCode!=null?a.keyCode:a.charCode;if(c<33||c>40&&c!=45&&c!=46)return!0;var d=h=="input"?parseFloat(b.value):b.selectedIndex;if(isNaN(d)||d<Math.min(i,j))d=Math.min(i,j);return c==37||c==40||c==46||c==34?d-=a.ctrlKey||c==34?m:l:c==39||c==38||c==45||c==33?d+=a.ctrlKey||c==33?m:l:c==35?d=j:c==36&&(d=i),bs(d),$("update"),g(a)}function be(a){this.classList.add("fd-slider-hover")}function bf(a){this.classList.remove("fd-slider-hover")}function bg(a){a=a||window.event,a.type==="mouseup"?(f(document,"mousemove",bj),f(document,"mouseup",bg)):(f(document,"touchmove",bj),f(document,"touchend",bg),f(document,"touchcancel",bg)),z=!0;if(window.opera)try{setTimeout(function(){onfocus()},0)}catch(b){}return document.body.classList.remove("slider-drag-vertical"),document.body.classList.remove("slider-drag-horizontal"),g(a)}function bh(a){a=a||window.event;if(a.touches){if(a.touches.length===0)return;a=r(a)}M=u?a.clientY:a.clientX,K=parseInt(u?U.offsetTop:U.offsetLeft)||0,z=!1,clearTimeout(y),y=null,a.type==="mousedown"?(e(document,"mousemove",bj),e(document,"mouseup",bg)):(e(document,"touchmove",bj),e(document,"touchend",bg),e(document,"touchcancel",bg));if(window.devicePixelRatio||document.all&&!window.opera)try{setTimeout(function(){U.focus()},0)}catch(b){}document.body.classList.add("slider-drag-"+(u?"vertical":"horizontal"))}function bi(a){return a=a||window.event,a.type==="mouseup"?f(document,"mouseup",bi):(f(document,"touchend",bi),f(document,"touchcancel",bi)),p||(clearTimeout(y),y=null,z=!0),g(a)}function bj(a){a=a||window.event;if(a.touches){if(a.touches.length===0)return;a=r(a)}br(bm(K+(u?a.clientY-M:a.clientX-M)))}function bk(a){a=a||window.event;if(a.touches){a.type==="touchstart"&&a.preventDefault();if(a.touches.length===0)return;a=r(a)}var b;a.target?b=a.target:a.srcElement&&(b=a.srcElement),b.nodeType==3&&(b=b.parentNode);if(b.className.search("fd-slider-handle")!=-1)return!0;try{setTimeout(function(){U.focus()},0)}catch(c){}clearTimeout(y),bn(),y=null,z=!1;var d=0,f=0,g=0;document.documentElement&&document.documentElement.scrollTop?(g=document.documentElement.scrollTop,f=document.documentElement.scrollLeft):document.body&&(g=document.body.scrollTop,f=document.body.scrollLeft),a.pageX?d=u?a.pageY:a.pageX:a.clientX&&(d=u?a.clientY+g:a.clientX+f),d-=u?I+Math.round(U.offsetHeight/2):H+Math.round(U.offsetWidth/2),d=bm(d),p?bq(d):t?(br(d),bh(a)):(a.type==="mousedown"?e(document,"mouseup",bi):(e(document,"touchend",bi),e(document,"touchcancel",bi)),L=d,bo())}function bl(a){var c=h=="input"?parseFloat(b.value):b.selectedIndex;if(isNaN(c)||c<Math.min(i,j))c=Math.min(i,j);c+=l*a,bs(c)}function bm(a){var b=a%O;return b&&b>=O/2?a+=O-b:a-=b,Math.min(Math.max(parseInt(a,10),0),J)}function bn(){var a=0,b=0,c=S;if(c.getBoundingClientRect){var d=c.getBoundingClientRect();H=d.left+document.body.scrollLeft,I=d.top+document.body.scrollTop;return}try{while(c.offsetParent)a+=c.offsetLeft,b+=c.offsetTop,c=c.offsetParent}catch(e){}H=a,I=b}function bo(){var a=u?U.offsetTop:U.offsetLeft;a=Math.round(L<a?Math.max(L,Math.floor(a-N)):Math.min(L,Math.ceil(a+N))),br(a),a!=L?y=setTimeout(bo,o>20?50:100):z=!0}function bq(a){z=!1,C=parseInt(a,10),D=parseInt(u?U.style.top:U.style.left,10),E=C-D,F=20,G=0,y||(y=setTimeout(bp,20))}function br(a){U.style[u?"top":"left"]=a+"px";var b=i+Math.round(a/O)*l;bt(h=="select"||l==1?Math.round(b):b)}function bs(a){var c=isNaN(a)?h=="input"?parseFloat(b.value):b.selectedIndex:a;isNaN(c)||c<Math.min(i,j)?c=Math.min(i,j):c>Math.max(i,j)&&(c=Math.max(i,j)),bt(c),U.style[u?"top":"left"]=Math.round((c-i)/l*O)+"px"}function bt(a){a=isNaN(a)?i:a;if(h=="select")try{a=parseInt(a,10);if(b.selectedIndex==a)return;b.options[a].selected=!0}catch(c){}else{a=(i+Math.round((a-i)/l)*l).toFixed(n);if(b.value==a)return;b.value=a}bv(),$("update")}function bu(){var a;if(b.parentNode&&b.parentNode.tagName.toLowerCase()=="label")a=b.parentNode;else{var c=document.getElementsByTagName("label");for(var d=0,e;e=c[d];d++)if(e.htmlFor&&e["htmlFor"]==b.id||e.getAttribute("for")==b.id){a=e;break}}return a&&!a.id&&(a.id=b.id+"_label"),a}function bv(){U.setAttribute("aria-valuenow",h=="select"?b.options[b.selectedIndex].value:b.value),U.setAttribute("aria-valuetext",h=="select"?b.options[b.selectedIndex].text:b.value)}function bw(a){return bs(),$("update"),!0}var b=a.inp,d=!1,h=b.tagName.toLowerCase(),i=+a.range[0],j=+a.range[1],k=Math.abs(j-i),l=h=="select"?1:+a.inc||1,m=a.maxInc?a.maxInc:l*2,n=a.inc.search(".")!=-1?a.inc.substr(a.inc.indexOf(".")+1,a.inc.length-1).length:0,o=Math.ceil(k/l),p=!!a.tween,q=!!a.fullARIA,s=!!a.hideInput,t=p?!1:!!a.clickJump,u=!!a.vertical,v=a.callbacks,w=a.classNames||"",x=!!a.noMouseWheel,y=null,z=!0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=this,Q={},R=null,S,T,U,V;j<i&&(l=-l,m=-m);var bp=function(){G++;var a=E,b=20,c=G,d=D,e=Math.ceil(c==b?d+a:a*(-Math.pow(2,-10*c/b)+1)+d);br(c==b?C:e),$("move"),c!=b?y=setTimeout(bp,20):(clearTimeout(y),y=null,z=!0)};return function(){s?b.classList.add("fd_hide_slider_input"):e(b,"change",bw),S=document.createElement("div"),S.className="fd-slider"+(u?"-vertical ":" ")+w,S.id="fd-slider-"+b.id,T=document.createElement("span"),T.className="fd-slider-inner",V=document.createElement("span"),V.className="fd-slider-bar",q?(U=document.createElement("span"),U.setAttribute("tabIndex","0")):(U=document.createElement("button"),U.setAttribute("type","button")),U.className="fd-slider-handle",U.appendChild(document.createTextNode(String.fromCharCode(160))),S.appendChild(T),S.appendChild(V),S.appendChild(U),b.parentNode.insertBefore(S,b),U.setAttribute("role","slider"),U.setAttribute("aria-valuemin",i),U.setAttribute("aria-valuemax",j);var a=bu();a&&(U.setAttribute("aria-labelledby",a.id),U.id="fd-slider-handle-"+b.id,a.setAttribute("for",U.id)),document.getElementById("fd_slider_describedby")&&U.setAttribute("aria-describedby","fd_slider_describedby"),b.getAttribute("disabled")==1?W(!0):X(!0),bv(),$("create"),Z()}(),{onResize:function(a){(S.offsetHeight!=A||S.offsetWidth!=B)&&Z()},destroy:function(){Y()},reset:function(){bs()},increment:function(a){bl(a)},disable:function(){W()},enable:function(){X()}}}function t(){e(window,"load",l),e(window,"unload",o),e(window,"resize",p)}var a={},b=0,c=!0,d=function(){c=!1},e=function(a,b,c){a.attachEvent?(a["e"+b+c]=c,a[b+c]=function(){a["e"+b+c](window.event)},a.attachEvent("on"+b,a[b+c])):a.addEventListener(b,c,!0)},f=function(a,b,c){if(a.detachEvent)try{a.detachEvent("on"+b,a[b+c]),a[b+c]=null}catch(d){}else a.removeEventListener(b,c,!0)},g=function(a){return a==null&&(a=document.parentWindow.event),a.stopPropagation&&(a.stopPropagation(),a.preventDefault()),!1},h=function(){if(!arguments.length)return[];var a=[];for(var b=0;b<arguments.length;b++)for(var c=0,d;d=arguments[b][c];c++)a[a.length]=d;return a},i=function(a){if(a==null)return{};var b,c,d={},e,f;for(var g=0,h;h=a[g];g++){c=h.match(/(fd_slider_cb_(update|create|destroy|redraw|move|focus|blur|enable|disable)_)([^\s|$]+)/i)[1],h=h.replace(new RegExp("^"+c),"").replace(/-/g,"."),c=c.replace(/^fd_slider_cb_/i,"").replace(/_$/,"");try{if(h.indexOf(".")!=-1){e=h.split("."),f=window;for(var i=0,j;j=f[e[i]];i++)j instanceof Function?function(){var a=j;b=function(b){a.apply(f,[b])}}():f=j}else b=window[h];if(b instanceof Function)c in d||(d[c]=[]),d[c][d[c].length]=b;else continue}catch(k){}}return d},j=function(a){if(a==null)return"";var b=[];for(var c=0,d;d=a[c];c++)b[b.length]=d.replace(/^fd_slider_cn_/,"");return b.join(" ")},k=function(b){return!b||!b.inp||!b.inp.id?!1:(m(b.inp.id),a[b.inp.id]=new s(b),!0)},l=function(a){var c=/fd_range_([-]{0,1}[0-9]+(d[0-9]+){0,1}){1}_([-]{0,1}[0-9]+(d[0-9]+){0,1}){1}/i,d=/fd_inc_([-]{0,1}[0-9]+(d[0-9]+){0,1}){1}/,e=/fd_maxinc_([-]{0,1}[0-9]+(d[0-9]+){0,1}){1}/,f=/((fd_slider_cb_(update|create|destroy|redraw|move|focus|blur|enable|disable)_)([^\s|$]+))/ig,g=/(fd_slider_cn_([a-zA-Z0-9_\-]+))/ig,l=a&&a.tagName&&a.tagName.search(/input|select/i)!=-1?[a]:h(document.getElementsByTagName("input"),document.getElementsByTagName("select")),m,n,o;for(var p=0,q;q=l[p];p++)if(q.tagName.toLowerCase()=="input"&&q.type=="text"&&(q.className.search(c)!=-1||q.className.search(/fd_slider/)!=-1)||q.tagName.toLowerCase()=="select"&&q.className.search(/fd_slider/)!=-1){if(!a&&q.id&&document.getElementById("fd-slider-"+q.id))continue;q.id||q.id=="sldr"+b++,o={inp:q,inc:q.className.search(d)!=-1?q.className.match(d)[0].replace("fd_inc_","").replace("d","."):"1",maxInc:q.className.search(e)!=-1?q.className.match(e)[0].replace("fd_maxinc_","").replace("d","."):!1,range:[0,100],callbacks:i(q.className.match(f)),classNames:j(q.className.match(g)),tween:q.className.search(/fd_tween/i)!=-1,vertical:q.className.search(/fd_vertical/i)!=-1,hideInput:q.className.search(/fd_hide_input/i)!=-1,clickJump:q.className.search(/fd_jump/i)!=-1,fullARIA:q.className.search(/fd_full_aria/i)!=-1,noMouseWheel:q.className.search(/fd_disable_mousewheel/i)!=-1},q.tagName.toLowerCase()=="select"?o.range=[0,q.options.length-1]:q.className.search(c)!=-1&&(m=q.className.match(c)[0].replace("fd_range_","").replace(/d/g,".").split("_"),o.range=[m[0],m[1]]),k(o)}return!0},m=function(b){return b in a?(a[b].destroy(),delete a[b],!0):!1},n=function(b){for(slider in a)a[slider].destroy()},o=function(b){n(),a=null,f(window,"unload",o),f(window,"resize",p),q()},p=function(b){for(slider in a)a[slider].onResize()},q=function(){f(window,"load",l)},r=function(a){return{type:a.type,pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,clientX:a.touches[0].clientX,clientY:a.touches[0].clientY,target:a.touches[0].target||a.target||a.srcElement}};return{create:function(a){l(a)},createSlider:function(a){k(a)},destroyAll:function(){n()},destroySlider:function(a){return m(a)},redrawAll:function(){p()},increment:function(b,c){if(b in a)a[b].increment(c);else return!1},addEvent:e,removeEvent:f,stopEvent:g,updateSlider:function(b){if(b in a)a[b].reset();else return!1},disableMouseWheel:function(){d()},addOnLoadEvent:t,removeOnLoadEvent:q,disableSlider:function(b){if(b in a)a[b].disable();else return!1},enableSlider:function(b){if(b in a)a[b].enable();else return!1}}}),define("src/color-x11",[],function(){var a=function(a){return{snow:new a(255,250,250,255),"ghost white":new a(248,248,255,255),GhostWhite:new a(248,248,255,255),"white smoke":new a(245,245,245,255),WhiteSmoke:new a(245,245,245,255),gainsboro:new a(220,220,220,255),"floral white":new a(255,250,240,255),FloralWhite:new a(255,250,240,255),"old lace":new a(253,245,230,255),OldLace:new a(253,245,230,255),linen:new a(250,240,230,255),"antique white":new a(250,235,215,255),AntiqueWhite:new a(250,235,215,255),"papaya whip":new a(255,239,213,255),PapayaWhip:new a(255,239,213,255),"blanched almond":new a(255,235,205,255),BlanchedAlmond:new a(255,235,205,255),bisque:new a(255,228,196,255),"peach puff":new a(255,218,185,255),PeachPuff:new a(255,218,185,255),"navajo white":new a(255,222,173,255),NavajoWhite:new a(255,222,173,255),moccasin:new a(255,228,181,255),cornsilk:new a(255,248,220,255),ivory:new a(255,255,240,255),"lemon chiffon":new a(255,250,205,255),LemonChiffon:new a(255,250,205,255),seashell:new a(255,245,238,255),honeydew:new a(240,255,240,255),"mint cream":new a(245,255,250,255),MintCream:new a(245,255,250,255),azure:new a(240,255,255,255),"alice blue":new a(240,248,255,255),AliceBlue:new a(240,248,255,255),lavender:new a(230,230,250,255),"lavender blush":new a(255,240,245,255),LavenderBlush:new a(255,240,245,255),"misty rose":new a(255,228,225,255),MistyRose:new a(255,228,225,255),white:new a(255,255,255,255),black:new a(0,0,0,255),"dark slate gray":new a(47,79,79,255),DarkSlateGray:new a(47,79,79,255),"dark slate grey":new a(47,79,79,255),DarkSlateGrey:new a(47,79,79,255),"dim gray":new a(105,105,105,255),DimGray:new a(105,105,105,255),"dim grey":new a(105,105,105,255),DimGrey:new a(105,105,105,255),"slate gray":new a(112,128,144,255),SlateGray:new a(112,128,144,255),"slate grey":new a(112,128,144,255),SlateGrey:new a(112,128,144,255),"light slate gray":new a(119,136,153,255),LightSlateGray:new a(119,136,153,255),"light slate grey":new a(119,136,153,255),LightSlateGrey:new a(119,136,153,255),gray:new a(190,190,190,255),grey:new a(190,190,190,255),"light grey":new a(211,211,211,255),LightGrey:new a(211,211,211,255),"light gray":new a(211,211,211,255),LightGray:new a(211,211,211,255),"midnight blue":new a(25,25,112,255),MidnightBlue:new a(25,25,112,255),navy:new a(0,0,128,255),"navy blue":new a(0,0,128,255),NavyBlue:new a(0,0,128,255),"cornflower blue":new a(100,149,237,255),CornflowerBlue:new a(100,149,237,255),"dark slate blue":new a(72,61,139,255),DarkSlateBlue:new a(72,61,139,255),"slate blue":new a(106,90,205,255),SlateBlue:new a(106,90,205,255),"medium slate blue":new a(123,104,238,255),MediumSlateBlue:new a(123,104,238,255),"light slate blue":new a(132,112,255,255),LightSlateBlue:new a(132,112,255,255),"medium blue":new a(0,0,205,255),MediumBlue:new a(0,0,205,255),"royal blue":new a(65,105,225,255),RoyalBlue:new a(65,105,225,255),blue:new a(0,0,255,255),"dodger blue":new a(30,144,255,255),DodgerBlue:new a(30,144,255,255),"deep sky blue":new a(0,191,255,255),DeepSkyBlue:new a(0,191,255,255),"sky blue":new a(135,206,235,255),SkyBlue:new a(135,206,235,255),"light sky blue":new a(135,206,250,255),LightSkyBlue:new a(135,206,250,255),"steel blue":new a(70,130,180,255),SteelBlue:new a(70,130,180,255),"light steel blue":new a(176,196,222,255),LightSteelBlue:new a(176,196,222,255),"light blue":new a(173,216,230,255),LightBlue:new a(173,216,230,255),"powder blue":new a(176,224,230,255),PowderBlue:new a(176,224,230,255),"pale turquoise":new a(175,238,238,255),PaleTurquoise:new a(175,238,238,255),"dark turquoise":new a(0,206,209,255),DarkTurquoise:new a(0,206,209,255),"medium turquoise":new a(72,209,204,255),MediumTurquoise:new a(72,209,204,255),turquoise:new a(64,224,208,255),cyan:new a(0,255,255,255),"light cyan":new a(224,255,255,255),LightCyan:new a(224,255,255,255),"cadet blue":new a(95,158,160,255),CadetBlue:new a(95,158,160,255),"medium aquamarine":new a(102,205,170,255),MediumAquamarine:new a(102,205,170,255),aquamarine:new a(127,255,212,255),"dark green":new a(0,100,0,255),DarkGreen:new a(0,100,0,255),"dark olive green":new a(85,107,47,255),DarkOliveGreen:new a(85,107,47,255),"dark sea green":new a(143,188,143,255),DarkSeaGreen:new a(143,188,143,255),"sea green":new a(46,139,87,255),SeaGreen:new a(46,139,87,255),"medium sea green":new a(60,179,113,255),MediumSeaGreen:new a(60,179,113,255),"light sea green":new a(32,178,170,255),LightSeaGreen:new a(32,178,170,255),"pale green":new a(152,251,152,255),PaleGreen:new a(152,251,152,255),"spring green":new a(0,255,127,255),SpringGreen:new a(0,255,127,255),"lawn green":new a(124,252,0,255),LawnGreen:new a(124,252,0,255),green:new a(0,255,0,255),chartreuse:new a(127,255,0,255),"medium spring green":new a(0,250,154,255),MediumSpringGreen:new a(0,250,154,255),"green yellow":new a(173,255,47,255),GreenYellow:new a(173,255,47,255),"lime green":new a(50,205,50,255),LimeGreen:new a(50,205,50,255),"yellow green":new a(154,205,50,255),YellowGreen:new a(154,205,50,255),"forest green":new a(34,139,34,255),ForestGreen:new a(34,139,34,255),"olive drab":new a(107,142,35,255),OliveDrab:new a(107,142,35,255),"dark khaki":new a(189,183,107,255),DarkKhaki:new a(189,183,107,255),khaki:new a(240,230,140,255),"pale goldenrod":new a(238,232,170,255),PaleGoldenrod:new a(238,232,170,255),"light goldenrod yellow":new a(250,250,210,255),LightGoldenrodYellow:new a(250,250,210,255),"light yellow":new a(255,255,224,255),LightYellow:new a(255,255,224,255),yellow:new a(255,255,0,255),gold:new a(255,215,0,255),"light goldenrod":new a(238,221,130,255),LightGoldenrod:new a(238,221,130,255),goldenrod:new a(218,165,32,255),"dark goldenrod":new a(184,134,11,255),DarkGoldenrod:new a(184,134,11,255),"rosy brown":new a(188,143,143,255),RosyBrown:new a(188,143,143,255),"indian red":new a(205,92,92,255),IndianRed:new a(205,92,92,255),"saddle brown":new a(139,69,19,255),SaddleBrown:new a(139,69,19,255),sienna:new a(160,82,45,255),peru:new a(205,133,63,255),burlywood:new a(222,184,135,255),beige:new a(245,245,220,255),wheat:new a(245,222,179,255),"sandy brown":new a(244,164,96,255),SandyBrown:new a(244,164,96,255),tan:new a(210,180,140,255),chocolate:new a(210,105,30,255),firebrick:new a(178,34,34,255),brown:new a(165,42,42,255),"dark salmon":new a(233,150,122,255),DarkSalmon:new a(233,150,122,255),salmon:new a(250,128,114,255),"light salmon":new a(255,160,122,255),LightSalmon:new a(255,160,122,255),orange:new a(255,165,0,255),"dark orange":new a(255,140,0,255),DarkOrange:new a(255,140,0,255),coral:new a(255,127,80,255),"light coral":new a(240,128,128,255),LightCoral:new a(240,128,128,255),tomato:new a(255,99,71,255),"orange red":new a(255,69,0,255),OrangeRed:new a(255,69,0,255),red:new a(255,0,0,255),"hot pink":new a(255,105,180,255),HotPink:new a(255,105,180,255),"deep pink":new a(255,20,147,255),DeepPink:new a(255,20,147,255),pink:new a(255,192,203,255),"light pink":new a(255,182,193,255),LightPink:new a(255,182,193,255),"pale violet red":new a(219,112,147,255),PaleVioletRed:new a(219,112,147,255),maroon:new a(176,48,96,255),"medium violet red":new a(199,21,133,255),MediumVioletRed:new a(199,21,133,255),"violet red":new a(208,32,144,255),VioletRed:new a(208,32,144,255),magenta:new a(255,0,255,255),violet:new a(238,130,238,255),plum:new a(221,160,221,255),orchid:new a(218,112,214,255),"medium orchid":new a(186,85,211,255),MediumOrchid:new a(186,85,211,255),"dark orchid":new a(153,50,204,255),DarkOrchid:new a(153,50,204,255),"dark violet":new a(148,0,211,255),DarkViolet:new a(148,0,211,255),"blue violet":new a(138,43,226,255),BlueViolet:new a(138,43,226,255),purple:new a(160,32,240,255),"medium purple":new a(147,112,219,255),MediumPurple:new a(147,112,219,255),thistle:new a(216,191,216,255),snow1:new a(255,250,250,255),snow2:new a(238,233,233,255),snow3:new a(205,201,201,255),snow4:new a(139,137,137,255),seashell1:new a(255,245,238,255),seashell2:new a(238,229,222,255),seashell3:new a(205,197,191,255),seashell4:new a(139,134,130,255),AntiqueWhite1:new a(255,239,219,255),AntiqueWhite2:new a(238,223,204,255),AntiqueWhite3:new a(205,192,176,255),AntiqueWhite4:new a(139,131,120,255),bisque1:new a(255,228,196,255),bisque2:new a(238,213,183,255),bisque3:new a(205,183,158,255),bisque4:new a(139,125,107,255),PeachPuff1:new a(255,218,185,255),PeachPuff2:new a(238,203,173,255),PeachPuff3:new a(205,175,149,255),PeachPuff4:new a(139,119,101,255),NavajoWhite1:new a(255,222,173,255),NavajoWhite2:new a(238,207,161,255),NavajoWhite3:new a(205,179,139,255),NavajoWhite4:new a(139,121,94,255),LemonChiffon1:new a(255,250,205,255),LemonChiffon2:new a(238,233,191,255),LemonChiffon3:new a(205,201,165,255),LemonChiffon4:new a(139,137,112,255),cornsilk1:new a(255,248,220,255),cornsilk2:new a(238,232,205,255),cornsilk3:new a(205,200,177,255),cornsilk4:new a(139,136,120,255),ivory1:new a(255,255,240,255),ivory2:new a(238,238,224,255),ivory3:new a(205,205,193,255),ivory4:new a(139,139,131,255),honeydew1:new a(240,255,240,255),honeydew2:new a(224,238,224,255),honeydew3:new a(193,205,193,255),honeydew4:new a(131,139,131,255),LavenderBlush1:new a(255,240,245,255),LavenderBlush2:new a(238,224,229,255),LavenderBlush3:new a(205,193,197,255),LavenderBlush4:new a(139,131,134,255),MistyRose1:new a(255,228,225,255),MistyRose2:new a(238,213,210,255),MistyRose3:new a(205,183,181,255),MistyRose4:new a(139,125,123,255),azure1:new a(240,255,255,255),azure2:new a(224,238,238,255),azure3:new a(193,205,205,255),azure4:new a(131,139,139,255),SlateBlue1:new a(131,111,255,255),SlateBlue2:new a(122,103,238,255),SlateBlue3:new a(105,89,205,255),SlateBlue4:new a(71,60,139,255),RoyalBlue1:new a(72,118,255,255),RoyalBlue2:new a(67,110,238,255),RoyalBlue3:new a(58,95,205,255),RoyalBlue4:new a(39,64,139,255),blue1:new a(0,0,255,255),blue2:new a(0,0,238,255),blue3:new a(0,0,205,255),blue4:new a(0,0,139,255),DodgerBlue1:new a(30,144,255,255),DodgerBlue2:new a(28,134,238,255),DodgerBlue3:new a(24,116,205,255),DodgerBlue4:new a(16,78,139,255),SteelBlue1:new a(99,184,255,255),SteelBlue2:new a(92,172,238,255),SteelBlue3:new a(79,148,205,255),SteelBlue4:new a(54,100,139,255),DeepSkyBlue1:new a(0,191,255,255),DeepSkyBlue2:new a(0,178,238,255),DeepSkyBlue3:new a(0,154,205,255),DeepSkyBlue4:new a(0,104,139,255),SkyBlue1:new a(135,206,255,255),SkyBlue2:new a(126,192,238,255),SkyBlue3:new a(108,166,205,255),SkyBlue4:new a(74,112,139,255),LightSkyBlue1:new a(176,226,255,255),LightSkyBlue2:new a(164,211,238,255),LightSkyBlue3:new a(141,182,205,255),LightSkyBlue4:new a(96,123,139,255),SlateGray1:new a(198,226,255,255),SlateGray2:new a(185,211,238,255),SlateGray3:new a(159,182,205,255),SlateGray4:new a(108,123,139,255),LightSteelBlue1:new a(202,225,255,255),LightSteelBlue2:new a(188,210,238,255),LightSteelBlue3:new a(162,181,205,255),LightSteelBlue4:new a(110,123,139,255),LightBlue1:new a(191,239,255,255),LightBlue2:new a(178,223,238,255),LightBlue3:new a(154,192,205,255),LightBlue4:new a(104,131,139,255),LightCyan1:new a(224,255,255,255),LightCyan2:new a(209,238,238,255),LightCyan3:new a(180,205,205,255),LightCyan4:new a(122,139,139,255),PaleTurquoise1:new a(187,255,255,255),PaleTurquoise2:new a(174,238,238,255),PaleTurquoise3:new a(150,205,205,255),PaleTurquoise4:new a(102,139,139,255),CadetBlue1:new a(152,245,255,255),CadetBlue2:new a(142,229,238,255),CadetBlue3:new a(122,197,205,255),CadetBlue4:new a(83,134,139,255),turquoise1:new a(0,245,255,255),turquoise2:new a(0,229,238,255),turquoise3:new a(0,197,205,255),turquoise4:new a(0,134,139,255),cyan1:new a(0,255,255,255),cyan2:new a(0,238,238,255),cyan3:new a(0,205,205,255),cyan4:new a(0,139,139,255),DarkSlateGray1:new a(151,255,255,255),DarkSlateGray2:new a(141,238,238,255),DarkSlateGray3:new a(121,205,205,255),DarkSlateGray4:new a(82,139,139,255),aquamarine1:new a(127,255,212,255),aquamarine2:new a(118,238,198,255),aquamarine3:new a(102,205,170,255),aquamarine4:new a(69,139,116,255),DarkSeaGreen1:new a(193,255,193,255),DarkSeaGreen2:new a(180,238,180,255),DarkSeaGreen3:new a(155,205,155,255),DarkSeaGreen4:new a(105,139,105,255),SeaGreen1:new a(84,255,159,255),SeaGreen2:new a(78,238,148,255),SeaGreen3:new a(67,205,128,255),SeaGreen4:new a(46,139,87,255),PaleGreen1:new a(154,255,154,255),PaleGreen2:new a(144,238,144,255),PaleGreen3:new a(124,205,124,255),PaleGreen4:new a(84,139,84,255),SpringGreen1:new a(0,255,127,255),SpringGreen2:new a(0,238,118,255),SpringGreen3:new a(0,205,102,255),SpringGreen4:new a(0,139,69,255),green1:new a(0,255,0,255),green2:new a(0,238,0,255),green3:new a(0,205,0,255),green4:new a(0,139,0,255),chartreuse1:new a(127,255,0,255),chartreuse2:new a(118,238,0,255),chartreuse3:new a(102,205,0,255),chartreuse4:new a(69,139,0,255),OliveDrab1:new a(192,255,62,255),OliveDrab2:new a(179,238,58,255),OliveDrab3:new a(154,205,50,255),OliveDrab4:new a(105,139,34,255),DarkOliveGreen1:new a(202,255,112,255),DarkOliveGreen2:new a(188,238,104,255),DarkOliveGreen3:new a(162,205,90,255),DarkOliveGreen4:new a(110,139,61,255),khaki1:new a(255,246,143,255),khaki2:new a(238,230,133,255),khaki3:new a(205,198,115,255),khaki4:new a(139,134,78,255),LightGoldenrod1:new a(255,236,139,255),LightGoldenrod2:new a(238,220,130,255),LightGoldenrod3:new a(205,190,112,255),LightGoldenrod4:new a(139,129,76,255),LightYellow1:new a(255,255,224,255),LightYellow2:new a(238,238,209,255),LightYellow3:new a(205,205,180,255),LightYellow4:new a(139,139,122,255),yellow1:new a(255,255,0,255),yellow2:new a(238,238,0,255),yellow3:new a(205,205,0,255),yellow4:new a(139,139,0,255),gold1:new a(255,215,0,255),gold2:new a(238,201,0,255),gold3:new a(205,173,0,255),gold4:new a(139,117,0,255),goldenrod1:new a(255,193,37,255),goldenrod2:new a(238,180,34,255),goldenrod3:new a(205,155,29,255),goldenrod4:new a(139,105,20,255),DarkGoldenrod1:new a(255,185,15,255),DarkGoldenrod2:new a(238,173,14,255),DarkGoldenrod3:new a(205,149,12,255),DarkGoldenrod4:new a(139,101,8,255),RosyBrown1:new a(255,193,193,255),RosyBrown2:new a(238,180,180,255),RosyBrown3:new a(205,155,155,255),RosyBrown4:new a(139,105,105,255),IndianRed1:new a(255,106,106,255),IndianRed2:new a(238,99,99,255),IndianRed3:new a(205,85,85,255),IndianRed4:new a(139,58,58,255),sienna1:new a(255,130,71,255),sienna2:new a(238,121,66,255),sienna3:new a(205,104,57,255),sienna4:new a(139,71,38,255),burlywood1:new a(255,211,155,255),burlywood2:new a(238,197,145,255),burlywood3:new a(205,170,125,255),burlywood4:new a(139,115,85,255),wheat1:new a(255,231,186,255),wheat2:new a(238,216,174,255),wheat3:new a(205,186,150,255),wheat4:new a(139,126,102,255),tan1:new a(255,165,79,255),tan2:new a(238,154,73,255),tan3:new a(205,133,63,255),tan4:new a(139,90,43,255),chocolate1:new a(255,127,36,255),chocolate2:new a(238,118,33,255),chocolate3:new a(205,102,29,255),chocolate4:new a(139,69,19,255),firebrick1:new a(255,48,48,255),firebrick2:new a(238,44,44,255),firebrick3:new a(205,38,38,255),firebrick4:new a(139,26,26,255),brown1:new a(255,64,64,255),brown2:new a(238,59,59,255),brown3:new a(205,51,51,255),brown4:new a(139,35,35,255),salmon1:new a(255,140,105,255),salmon2:new a(238,130,98,255),salmon3:new a(205,112,84,255),salmon4:new a(139,76,57,255),LightSalmon1:new a(255,160,122,255),LightSalmon2:new a(238,149,114,255),LightSalmon3:new a(205,129,98,255),LightSalmon4:new a(139,87,66,255),orange1:new a(255,165,0,255),orange2:new a(238,154,0,255),orange3:new a(205,133,0,255),orange4:new a(139,90,0,255),DarkOrange1:new a(255,127,0,255),DarkOrange2:new a(238,118,0,255),DarkOrange3:new a(205,102,0,255),DarkOrange4:new a(139,69,0,255),coral1:new a(255,114,86,255),coral2:new a(238,106,80,255),coral3:new a(205,91,69,255),coral4:new a(139,62,47,255),tomato1:new a(255,99,71,255),tomato2:new a(238,92,66,255),tomato3:new a(205,79,57,255),tomato4:new a(139,54,38,255),OrangeRed1:new a(255,69,0,255),OrangeRed2:new a(238,64,0,255),OrangeRed3:new a(205,55,0,255),OrangeRed4:new a(139,37,0,255),red1:new a(255,0,0,255),red2:new a(238,0,0,255),red3:new a(205,0,0,255),red4:new a(139,0,0,255),DebianRed:new a(215,7,81,255),DeepPink1:new a(255,20,147,255),DeepPink2:new a(238,18,137,255),DeepPink3:new a(205,16,118,255),DeepPink4:new a(139,10,80,255),HotPink1:new a(255,110,180,255),HotPink2:new a(238,106,167,255),HotPink3:new a(205,96,144,255),HotPink4:new a(139,58,98,255),pink1:new a(255,181,197,255),pink2:new a(238,169,184,255),pink3:new a(205,145,158,255),pink4:new a(139,99,108,255),LightPink1:new a(255,174,185,255),LightPink2:new a(238,162,173,255),LightPink3:new a(205,140,149,255),LightPink4:new a(139,95,101,255),PaleVioletRed1:new a(255,130,171,255),PaleVioletRed2:new a(238,121,159,255),PaleVioletRed3:new a(205,104,137,255),PaleVioletRed4:new a(139,71,93,255),maroon1:new a(255,52,179,255),maroon2:new a(238,48,167,255),maroon3:new a(205,41,144,255),maroon4:new a(139,28,98,255),VioletRed1:new a(255,62,150,255),VioletRed2:new a(238,58,140,255),VioletRed3:new a(205,50,120,255),VioletRed4:new a(139,34,82,255),magenta1:new a(255,0,255,255),magenta2:new a(238,0,238,255),magenta3:new a(205,0,205,255),magenta4:new a(139,0,139,255),orchid1:new a(255,131,250,255),orchid2:new a(238,122,233,255),orchid3:new a(205,105,201,255),orchid4:new a(139,71,137,255),plum1:new a(255,187,255,255),plum2:new a(238,174,238,255),plum3:new a(205,150,205,255),plum4:new a(139,102,139,255),MediumOrchid1:new a(224,102,255,255),MediumOrchid2:new a(209,95,238,255),MediumOrchid3:new a(180,82,205,255),MediumOrchid4:new a(122,55,139,255),DarkOrchid1:new a(191,62,255,255),DarkOrchid2:new a(178,58,238,255),DarkOrchid3:new a(154,50,205,255),DarkOrchid4:new a(104,34,139,255),purple1:new a(155,48,255,255),purple2:new a(145,44,238,255),purple3:new a(125,38,205,255),purple4:new a(85,26,139,255),MediumPurple1:new a(171,130,255,255),MediumPurple2:new a(159,121,238,255),MediumPurple3:new a(137,104,205,255),MediumPurple4:new a(93,71,139,255),thistle1:new a(255,225,255,255),thistle2:new a(238,210,238,255),thistle3:new a(205,181,205,255),thistle4:new a(139,123,139,255),gray0:new a(0,0,0,255),grey0:new a(0,0,0,255),gray1:new a(3,3,3,255),grey1:new a(3,3,3,255),gray2:new a(5,5,5,255),grey2:new a(5,5,5,255),gray3:new a(8,8,8,255),grey3:new a(8,8,8,255),gray4:new a(10,10,10,255),grey4:new a(10,10,10,255),gray5:new a(13,13,13,255),grey5:new a(13,13,13,255),gray6:new a(15,15,15,255),grey6:new a(15,15,15,255),gray7:new a(18,18,18,255),grey7:new a(18,18,18,255),gray8:new a(20,20,20,255),grey8:new a(20,20,20,255),gray9:new a(23,23,23,255),grey9:new a(23,23,23,255),gray10:new a(26,26,26,255),grey10:new a(26,26,26,255),gray11:new a(28,28,28,255),grey11:new a(28,28,28,255),gray12:new a(31,31,31,255),grey12:new a(31,31,31,255),gray13:new a(33,33,33,255),grey13:new a(33,33,33,255),gray14:new a(36,36,36,255),grey14:new a(36,36,36,255),gray15:new a(38,38,38,255),grey15:new a(38,38,38,255),gray16:new a(41,41,41,255),grey16:new a(41,41,41,255),gray17:new a(43,43,43,255),grey17:new a(43,43,43,255),gray18:new a(46,46,46,255),grey18:new a(46,46,46,255),gray19:new a(48,48,48,255),grey19:new a(48,48,48,255),gray20:new a(51,51,51,255),grey20:new a(51,51,51,255),gray21:new a(54,54,54,255),grey21:new a(54,54,54,255),gray22:new a(56,56,56,255),grey22:new a(56,56,56,255),gray23:new a(59,59,59,255),grey23:new a(59,59,59,255),gray24:new a(61,61,61,255),grey24:new a(61,61,61,255),gray25:new a(64,64,64,255),grey25:new a(64,64,64,255),gray26:new a(66,66,66,255),grey26:new a(66,66,66,255),gray27:new a(69,69,69,255),grey27:new a(69,69,69,255),gray28:new a(71,71,71,255),grey28:new a(71,71,71,255),gray29:new a(74,74,74,255),grey29:new a(74,74,74,255),gray30:new a(77,77,77,255),grey30:new a(77,77,77,255),gray31:new a(79,79,79,255),grey31:new a(79,79,79,255),gray32:new a(82,82,82,255),grey32:new a(82,82,82,255),gray33:new a(84,84,84,255),grey33:new a(84,84,84,255),gray34:new a(87,87,87,255),grey34:new a(87,87,87,255),gray35:new a(89,89,89,255),grey35:new a(89,89,89,255),gray36:new a(92,92,92,255),grey36:new a(92,92,92,255),gray37:new a(94,94,94,255),grey37:new a(94,94,94,255),gray38:new a(97,97,97,255),grey38:new a(97,97,97,255),gray39:new a(99,99,99,255),grey39:new a(99,99,99,255),gray40:new a(102,102,102,255),grey40:new a(102,102,102,255),gray41:new a(105,105,105,255),grey41:new a(105,105,105,255),gray42:new a(107,107,107,255),grey42:new a(107,107,107,255),gray43:new a(110,110,110,255),grey43:new a(110,110,110,255),gray44:new a(112,112,112,255),grey44:new a(112,112,112,255),gray45:new a(115,115,115,255),grey45:new a(115,115,115,255),gray46:new a(117,117,117,255),grey46:new a(117,117,117,255),gray47:new a(120,120,120,255),grey47:new a(120,120,120,255),gray48:new a(122,122,122,255),grey48:new a(122,122,122,255),gray49:new a(125,125,125,255),grey49:new a(125,125,125,255),gray50:new a(127,127,127,255),grey50:new a(127,127,127,255),gray51:new a(130,130,130,255),grey51:new a(130,130,130,255),gray52:new a(133,133,133,255),grey52:new a(133,133,133,255),gray53:new a(135,135,135,255),grey53:new a(135,135,135,255),gray54:new a(138,138,138,255),grey54:new a(138,138,138,255),gray55:new a(140,140,140,255),grey55:new a(140,140,140,255),gray56:new a(143,143,143,255),grey56:new a(143,143,143,255),gray57:new a(145,145,145,255),grey57:new a(145,145,145,255),gray58:new a(148,148,148,255),grey58:new a(148,148,148,255),gray59:new a(150,150,150,255),grey59:new a(150,150,150,255),gray60:new a(153,153,153,255),grey60:new a(153,153,153,255),gray61:new a(156,156,156,255),grey61:new a(156,156,156,255),gray62:new a(158,158,158,255),grey62:new a(158,158,158,255),gray63:new a(161,161,161,255),grey63:new a(161,161,161,255),gray64:new a(163,163,163,255),grey64:new a(163,163,163,255),gray65:new a(166,166,166,255),grey65:new a(166,166,166,255),gray66:new a(168,168,168,255),grey66:new a(168,168,168,255),gray67:new a(171,171,171,255),grey67:new a(171,171,171,255),gray68:new a(173,173,173,255),grey68:new a(173,173,173,255),gray69:new a(176,176,176,255),grey69:new a(176,176,176,255),gray70:new a(179,179,179,255),grey70:new a(179,179,179,255),gray71:new a(181,181,181,255),grey71:new a(181,181,181,255),gray72:new a(184,184,184,255),grey72:new a(184,184,184,255),gray73:new a(186,186,186,255),grey73:new a(186,186,186,255),gray74:new a(189,189,189,255),grey74:new a(189,189,189,255),gray75:new a(191,191,191,255),grey75:new a(191,191,191,255),gray76:new a(194,194,194,255),grey76:new a(194,194,194,255),gray77:new a(196,196,196,255),grey77:new a(196,196,196,255),gray78:new a(199,199,199,255),grey78:new a(199,199,199,255),gray79:new a(201,201,201,255),grey79:new a(201,201,201,255),gray80:new a(204,204,204,255),grey80:new a(204,204,204,255),gray81:new a(207,207,207,255),grey81:new a(207,207,207,255),gray82:new a(209,209,209,255),grey82:new a(209,209,209,255),gray83:new a(212,212,212,255),grey83:new a(212,212,212,255),gray84:new a(214,214,214,255),grey84:new a(214,214,214,255),gray85:new a(217,217,217,255),grey85:new a(217,217,217,255),gray86:new a(219,219,219,255),grey86:new a(219,219,219,255),gray87:new a(222,222,222,255),grey87:new a(222,222,222,255),gray88:new a(224,224,224,255),grey88:new a(224,224,224,255),gray89:new a(227,227,227,255),grey89:new a(227,227,227,255),gray90:new a(229,229,229,255),grey90:new a(229,229,229,255),gray91:new a(232,232,232,255),grey91:new a(232,232,232,255),gray92:new a(235,235,235,255),grey92:new a(235,235,235,255),gray93:new a(237,237,237,255),grey93:new a(237,237,237,255),gray94:new a(240,240,240,255),grey94:new a(240,240,240,255),gray95:new a(242,242,242,255),grey95:new a(242,242,242,255),gray96:new a(245,245,245,255),grey96:new a(245,245,245,255),gray97:new a(247,247,247,255),grey97:new a(247,247,247,255),gray98:new a(250,250,250,255),grey98:new a(250,250,250,255),gray99:new a(252,252,252,255),grey99:new a(252,252,252,255),gray100:new a(255,255,255,255),grey100:new a(255,255,255,255),"dark grey":new a(169,169,169,255),DarkGrey:new a(169,169,169,255),"dark gray":new a(169,169,169,255),DarkGray:new a(169,169,169,255),"dark blue":new a(0,0,139,255),DarkBlue:new a(0,0,139,255),"dark cyan":new a(0,139,139,255),DarkCyan:new a(0,139,139,255),"dark magenta":new a(139,0,139,255),DarkMagenta:new a(139,0,139,255),"dark red":new a(139,0,0,255),DarkRed:new a(139,0,0,255),"light green":new a(144,238,144,255),LightGreen:new a(144,238,144,255),indigo:new a(75,0,130,255)}};return{make_color_table:a}}),define("src/color",["./color-x11"],function(a){var b=function(a){return a<0?0:a>255?255:a},c=Math.max,d=Math.min,e=function(a,b,c,d){this.red=a,this.green=b,this.blue=c,this.alpha=d};e.prototype={copy:function(){return new e(this.red,this.green,this.blue,this.alpha)},set:function(a,b,c,d){this.red=a,this.green=b,this.blue=c,this.alpha=d},set_from_color:function(a){this.set(a.red,a.green,a.blue,a.alpha)},to_string:function(){function a(a){var b=a.toString(16);while(b.length<2)b="0"+b;return b}return"#"+a(this.red)+a(this.green)+a(this.blue)+a(this.alpha)},to_hls:function(){var a=this.red/255,b=this.green/255,e=this.blue/255,f=c(c(a,b),e),g=d(d(a,b),e),h=(f+g)/2,i=0,j=0;if(f!==g){h<=.5?i=(f-g)/(f+g):i=(f-g)/(2-f-g);var k=f-g;a===f?j=(b-e)/k:b===f?j=2+(e-a)/k:e===f&&(j=4+(a-b)/k),j*=60,j<0&&(j+=360)}return[j,h,i]},to_pixel:function(){return this.alpha|this.blue<<8|this.green<<16|this.red<<24},add:function(a){return e.add(this,a)},subtract:function(a){return e.subtract(this,a)},lighten:function(){return this.shade(1.3)},darken:function(){return this.shade(.7)},shade:function(a){var b,c=this.to_hls();c[1]*=a,c[2]*=a;for(b=1;b<3;b++)c[b]=c[b]>1?1:c[b]<0?0:c[b];return e.from_hls(c[0],c[1],c[2],this.alpha)}};var f=a.make_color_table(e),g=/\(\s*([\-+]?\d*\.?\d+)\s*(%\s*)?,\s*([\-+]?\d*\.?\d+)\s*(%\s*)?,\s*([\-+]?\d*\.?\d+)\s*(%\s*)?(,\s*([\-+]?\d*\.?\d+)\s*(%\s*)?)?\)/,h=function(a,c){var d=a.trim().match(g);if(!d)return null;var f=parseFloat(d[1]);d[2]&&(f=f/100*255);var h=parseFloat(d[3]);d[4]&&(h=h/100*255);var i=parseFloat(d[5]);d[6]&&(i=i/100*255);var j=255;if(c){if(!d[7])return null;j=parseFloat(d[8]),d[9]&&(j/=100),j*=255}return new e(b(Math.round(f)),b(Math.round(h)),b(Math.round(i)),b(Math.round(j)))},i=function(a,c){var d=a.trim().match(g);if(!d)return null;var f=parseFloat(d[1]);d[2]&&(f=f/100*360),f=f<0?0:f>360?360:f;var h=parseFloat(d[3]);d[4]&&(h/=100),h=h<0?0:h>1?1:h;var i=parseFloat(d[5]);d[6]&&(i/=100),i=i<0?0:i>1?1:i;var j=255;if(c){if(!d[7])return null;j=parseFloat(d[8]),d[9]&&(j/=100),j*=255}return j=b(Math.round(j)),e.from_hls(f,h,i,j)},j=function(a){var b,c,d,f,g=parseInt(a,16);return g!==g?null:a.length===8?e.from_pixel(g):a.length===6?e.from_pixel(g<<8|255):a.length===4?(b=g>>12&15,c=g>>8&15,d=g>>4&15,f=g&15,new e(b*17,c*17,d*17,f*17)):a.length===3?(b=g>>8&15,c=g>>4&15,d=g&15,new e(b*17,c*17,d*17,255)):null};return e.from_string=function(a){return a.substr(0,3)==="rgb"?a.substr(0,4)==="rgba"?h(a.substr(4),!0):h(a.substr(3),!1):a.substr(0,3)==="hsl"?a.substr(0,4)==="hsla"?i(a.substr(4),!0):i(a.substr(3),!1):a.substr(0,1)==="#"?j(a.substr(1)):a in f?f[a]:null},e.from_pixel=function(a){return new e(a>>24&255,a>>16&255,a>>8&255,a&255)},e.from_hls=function(a,b,c,d){d===undefined&&(d=255),a/=360;if(c===0){var f=b*255;return new e(f,f,f,d)}var g;b<=.5?g=b*(1+c):g=b+c-b*c;var h=2*b-g,i=[a+1/3,a,a-1/3],j=[0,0,0],k;for(k=0;k<3;k++)i[k]<0&&(i[k]+=1),i[k]>1&&(i[k]-=1),6*i[k]<1?j[k]=h+(g-h)*i[k]*6:2*i[k]<1?j[k]=g:3*i[k]<2?j[k]=h+(g-h)*(2/3-i[k])*6:j[k]=h;return new e(Math.round(j[0]*255),Math.round(j[1]*255),Math.round(j[2]*255),d)},e.equal=function(a,b){return a===b?!0:a.red===b.red&&a.green===b.green&&a.blue===b.blue&&a.alpha===b.alpha},e.add=function(a,d){return new e(b(a.red+d.red),b(a.green+d.green),b(a.blue+d.blue),c(a.alpha,d.alpha))},e.subtract=function(a,c){return new e(b(a.red-c.red),b(a.green-c.green),b(a.blue-c.blue),d(a.alpha,c.alpha))},e.interpolate=function(a,b,c){return new e(a.red+(b.red-a.red)*c,a.green+(b.green-a.green)*c,a.blue+(b.blue-a.blue)*c,a.alpha+(b.alpha-a.alpha)*c)},e.WHITE=e.from_string("#ffffffff"),e.BLACK=e.from_string("#000000ff"),e.RED=e.from_string("#ff0000ff"),e.DARK_RED=e.from_string("#800000ff"),e.GREEN=e.from_string("#00ff00ff"),e.DARK_GREEN=e.from_string("#008000ff"),e.BLUE=e.from_string("#0000ffff"),e.DARK_BLUE=e.from_string("#000080ff"),e.CYAN=e.from_string("#00ffffff"),e.DARK_CYAN=e.from_string("#008080ff"),e.MAGENTA=e.from_string("#ff00ffff"),e.DARK_MAGENTA=e.from_string("#800080ff"),e.YELLOW=e.from_string("#ffff00ff"),e.DARK_YELLOW=e.from_string("#808000ff"),e.GRAY=e.from_string("#a0a0a4ff"),e.DARK_GRAY=e.from_string("#808080ff"),e.LIGHT_GRAY=e.from_string("#c0c0c0ff"),e.BUTTER=e.from_string("#edd400ff"),e.BUTTER_LIGHT=e.from_string("#fce94fff"),e.BUTTER_DARK=e.from_string("#c4a000ff"),e.ORANGE=e.from_string("#f57900ff"),e.ORANGE_LIGHT=e.from_string("#fcaf3fff"),e.ORANGE_DARK=e.from_string("#ce5c00ff"),e.CHOCOLATE=e.from_string("#c17d11ff"),e.CHOCOLATE_LIGHT=e.from_string("#e9b96eff"),e.CHOCOLATE_DARK=e.from_string("#8f5902ff"),e.CHAMELEON=e.from_string("#73d216ff"),e.CHAMELEON_LIGHT=e.from_string("#8ae234ff"),e.CHAMELEON_DARK=e.from_string("#4e9a06ff"),e.SKY_BLUE=e.from_string("#3465a4ff"),e.SKY_BLUE_LIGHT=e.from_string("#729fcfff"),e.SKY_BLUE_DARK=e.from_string("#204a87ff"),e.PLUM=e.from_string("#75507bff"),e.PLUM_LIGHT=e.from_string("#ad7fa8ff"),e.PLUM_DARK=e.from_string("#5c3566ff"),e.SCARLET_RED=e.from_string("#cc0000ff"),e.SCARLET_RED_LIGHT=e.from_string("#ef2929ff"),e.SCARLET_RED_DARK=e.from_string("#a40000ff"),e.ALUMINIUM_1=e.from_string("#eeeeecff"),e.ALUMINIUM_2=e.from_string("#d3d7cfff"),e.ALUMINIUM_3=e.from_string("#babdb6ff"),e.ALUMINIUM_4=e.from_string("#888a85ff"),e.ALUMINIUM_5=e.from_string("#555753ff"),e.ALUMINIUM_6=e.from_string("#2e3436ff"),e.TRANSPARENT=e.from_string("#00000000"),e}),define("src/brush",["img!../brushes/brush-tile-129.png","./color"],function(a,b){var c=["hard","medium","rough fine","rough coarse","soft","dots small","dots large","rect","hlines","sticks","splotch","splotches coarse"];c.forEach(function(a,b){c[a]=b});var d={hard:.22,medium:.06,"rough fine":.09,"rough coarse":.2,soft:.11,"dots small":.67,"dots large":1,rect:.12,hlines:.1,sticks:.19,splotch:.25,"splotches coarse":.23},e={"rough fine":.5,"rough coarse":.5,sticks:.66,splotch:.6,"splotches coarse":1.2},f={rect:!0,hlines:!0},g=0;a&&(g=a.width/a.height);var h=function(a,b,c,d,e){this.set(a,b,c,d,e)};return h.prototype={},h.Types=c,h.fromJSON=function(a){var c=typeof a=="string"?JSON.parse(a):a,d=new b;d.set_from_color(c.color);var e=c.type===0?"hard":c.type===1?"soft":c.type;return new h(d,c.type,c.size,c.opacity,c.spacing)},h.prototype.equals=function(a){return this===a?!0:b.equal(this.color,a.color)&&this.type===a.type&&this.size===a.size&&this.opacity===a.opacity&&this.spacing===a.spacing},h.prototype.set=function(a,c,d,e,f){return this.color=a||b.BLACK,this.type=c||"hard",this.size=d||32,this.opacity=typeof e=="number"?e:1,this.spacing=f||.225,this},h.prototype.set_from_brush=function(a){return this.set(a.color,a.type,a.size,a.opacity,a.spacing)},h.prototype.setToDefaultSpacing=function(){return this.spacing=d[this.type]||.05,this},h.prototype.rotationIncrement=function(){return e[this.type]||0},h.prototype.followsTangent=function(){return!!f[this.type]},h.prototype.clone=function(){return new h(this.color,this.type,this.size,this.opacity,this.spacing)},h.prototype.toCanvas=function(){var b=Math.floor(a.height/2),c=Math.min(Math.max(1,Math.ceil(this.size/2)),b),d=c*2+1,e=document.createElement("canvas");e.width=e.height=d;var f=e.getContext("2d");f.fillStyle=this.color.to_string().replace(/..$/,""),f.fillRect(0,0,e.width,e.height),f.translate(c+.5,c+.5);var g=Math.max(2,this.size+1)/a.height;f.scale(g,g);var i=0;return h.Types.hasOwnProperty(this.type)?i=h.Types[this.type]:console.warn("Unknown brush type",this.type),i*=a.height,f.globalCompositeOperation="destination-in",f.drawImage(a,-b-.5-i,-b-.5),e},h}),define("src/colorwheel",["./color","./coords"],function(a,b){var c=function(a,b){this.domElement=a,this.container=b||a,this.hue=this.saturation=this.lightness=null,this.setHSL(0,0,0);var c=function(a,b,c){(c||this.container).addEventListener(a,b,!0)}.bind(this),d=function(a,b,c){(c||this.container).removeEventListener(a,b,!0)}.bind(this),e,f,g,h;e=function(a){this._updateThumbFromEvent(a),this.domElement.querySelector(".color").focus(),a.type==="mousedown"?(c("mousemove",f),c("mouseup",g),c("mouseout",h)):(c("touchmove",f),c("touchend",g),c("touchcancel",g),c("touchleave",g),a.preventDefault())}.bind(this),f=function(a){this._updateThumbFromEvent(a)}.bind(this),h=function(a){var b=a.relatedTarget,c=this;(!b||b!==c&&!c.contains(b))&&g(a)},g=function(a){this._updateThumbFromEvent(a),a.type==="mouseup"||a.type==="mouseout"?(d("mousemove",f),d("mouseup",g),d("mouseout",h)):(d("touchmove",f),d("touchend",g),d("touchcancel",g),d("touchleave",g))}.bind(this),c("mousedown",e,this.domElement),c("touchstart",e,this.domElement);var i=function(a){var b=2;a=a||document.parentWindow.event;var c=a.keyCode!=null?a.keyCode:a.charCode,d=this.hue,e=this.saturation;switch(c){case 37:d-=b;break;case 39:d+=b;break;case 38:case 33:e+=b;break;case 40:case 34:e-=b;break;default:return!0}return a.stopPropagation(),a.preventDefault(),d<0&&(d=255),d>255&&(d=0),e=Math.max(0,Math.min(e,255)),this.hue=d,this.saturation=e,this._updateThumbPosition(),this._updateThumbColor(),this.hsCallback(d,e),!1};c("keypress",i,this.domElement)};return c.prototype={},c.prototype._pol2xy=function(a,b,c){c||(c=this.domElement.querySelector(".color").clientWidth);var d=2*Math.PI*a/256,e=b*(c/2)/255,f=Math.cos(d)*e,g=-Math.sin(d)*e;return{x:f,y:g}},c.prototype._updateThumbFromEvent=function(a){if(a.touches){if(a.touches.length===0)return;a={type:a.type,pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,clientX:a.touches[0].clientX,clientY:a.touches[0].clientY,target:a.touches[0].target||a.target||a.srcElement}}var c=this.domElement.querySelector(".color"),d=b.getRelativeEventPosition(a,c),e=d.x-c.offsetWidth/2,f=d.y-c.offsetHeight/2,g=e/(c.clientHeight/2),h=f/(c.clientHeight/2),i=Math.atan2(-h,g)/(2*Math.PI),j=Math.sqrt(g*g+h*h);i<0&&(i+=1),j>1&&(e=f=null),this.hue=Math.round(Math.min(i*256,255)),this.saturation=Math.round(Math.min(j*255,255)),this._updateThumbPosition(e,f),this._updateThumbColor(),this.hsCallback(this.hue,this.saturation)},c.prototype._updateThumbPosition=function(a,b){var c={x:a,y:b};typeof c.x!="number"&&(c=this._pol2xy(this.hue,this.saturation));var d=this.domElement.querySelector(".thumb"),e=Math.round(c.x)+"px,"+Math.round(c.y)+"px";d.style.WebkitTransform="translate3d("+e+",0)",d.style.MozTransform=d.style.transform="translate("+e+")"},c.prototype._updateThumbColor=function(){var b=this.domElement.querySelector(".thumb"),c=a.from_hls(this.hue*360/256,this.lightness/255,this.saturation/255,255);b.style.color=c.to_string().substring(0,7)},c.prototype.setHSL=function(a,b,c){var d=this.hue!==a||this.saturation!==b,e=this.lightness!==c;d&&(this.hue=a,this.saturation=b,this._updateThumbPosition()),e?this.setLightness(c):d&&this._updateThumbColor()},c.prototype.setLightness=function(a){if(a===this.lightness)return;this.lightness=a;var b=this.domElement.querySelector(".white"),c=this.domElement.querySelector(".black");a/=255,a<.5?(b.style.opacity=0,c.style.opacity=1-a*2):(b.style.opacity=a*2-1,c.style.opacity=0),this._updateThumbColor()},c.prototype.onResize=function(){this._updateThumbPosition()},c.prototype.hsCallback=function(a,b){},c}),define("src/hslcolor",["./color"],function(a){var b=function(a){return a<0?0:a>255?255:a},c=Math.max,d=Math.min,e=function(a,c,d,e){this.hue=b(a),this.saturation=b(c),this.lightness=b(d),this.opacity=b(e)};return e.prototype.copy=function(){return new e(this.hue,this.saturation,this.lightness,this.opacity)},e.prototype.shade=function(a){var c=b(this.saturation*a),d=b(this.lightness*a);return new e(this.hue,c,d,this.opacity)},e.prototype.lighten=function(){return this.shade(1.3)},e.prototype.darken=function(){return this.shade(.7)},e.prototype.rgbaColor=function(){return a.from_hls(this.hue*360/256,this.lightness/255,this.saturation/255,this.opacity)},e.prototype.rgbString=function(){var a=this.rgbaColor();return"rgb("+Math.round(a.red)+","+Math.round(a.green)+","+Math.round(a.blue)+")"},e.prototype.rgbaString=function(){var a=this.rgbaColor();return"rgba("+Math.round(a.red)+","+Math.round(a.green)+","+Math.round(a.blue)+","+a.alpha/255+")"},e.from_color=function(a){var b=a.to_hls();return new e(b[0]*256/360,b[2]*255,b[1]*255,a.alpha)},e.from_rgba=function(b,c,d,f){return e.from_color(new a(b,c,d,f))},e.equal=function(a,b){return a===b?!0:a.hue===b.hue&&a.saturation===b.saturation&&a.lightness===b.lightness&&a.opacity===b.opacity},e}),define("src/compat",[],function(){Function.prototype.bind||(Function.prototype.bind=function(a){var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a||window,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),Object.freeze||(Object.freeze=function(a){return a});var a=function(){console.warn("Faking Web Worker creation.")};a.prototype={postMessage:function(a){},addEventListener:function(a,b){}};var b={Worker:typeof Worker=="undefined"?a:Worker,Uint8Array:typeof Uint8Array=="undefined"?Array:Uint8Array,Float64Array:typeof Float64Array=="undefined"?Array:Float64Array};return typeof window!="undefined"&&function(){var a=0,c=["ms","moz","webkit","o"],d;for(d=0;d<c.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[c[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[d]+"CancelAnimationFrame"]||window[c[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(console.log("Using requestAnimationFrame fallback."),window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),b.requestAnimationFrame=window.requestAnimationFrame.bind(window),b.cancelAnimationFrame=window.cancelAnimationFrame.bind(window)}(),typeof document!="undefined"&&!("classList"in document.createElement("a"))&&function(a){if(!("HTMLElement"in a||"Element"in a))return;var b="classList",c="prototype",d=(a.HTMLElement||a.Element)[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){var b=0,c=this.length;for(;b<c;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(b==="")throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return g.call(a,b)},j=function(a){var b=f.call(a.className),c=b?b.split(/\s+/):[],d=0,e=c.length;for(;d<e;d++)this.push(c[d]);this._updateClassName=function(){a.className=this.toString()}},k=j[c]=[],l=function(){return new j(this)};h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return a+="",i(this,a)!==-1},k.add=function(a){a+="",i(this,a)===-1&&(this.push(a),this._updateClassName())},k.remove=function(a){a+="";var b=i(this,a);b!==-1&&(this.splice(b,1),this._updateClassName())},k.toggle=function(a){a+="",i(this,a)===-1?this.add(a):this.remove(a)},k.toString=function(){return this.join(" ")};if(e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(n){n.number===-2146823252&&(m.enumerable=!1,e.defineProperty(d,b,m))}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}(self),b}),define("src/dom",[],function(){var a=function(a){var b=[[["charset","UTF-8"]],[["name","viewport"],["content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"]],[["name","apple-mobile-web-app-capable"],["content","yes"]],[["name","apple-mobile-web-app-status-bar-style"],["content","black"]]],c=a.getElementsByTagName("meta"),d,e,f;for(d=0;d<b.length;d++){var g=b[d],h=!1;for(e=0;e<c.length&&!h;e++){var i=c[e],j=!0;for(f=0;f<g.length&&j;f++){var k=g[f][0],l=g[f][1];i.getAttribute(k)!==l&&(j=!1)}j&&(h=!0)}if(h)continue;var m=a.createElement("meta");for(f=0;f<g.length;f++)m.setAttribute(g[f][0],g[f][1]);a.head.appendChild(m)}},b=function(a,b){a.document.title=b},c=function(a){var b=a.document,c=document.createElement("canvas");c.id="ncolors",c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.right="0px",c.style.bottom="0px",document.body.appendChild(c);var d=function(b){var d=a.innerWidth,e=a.innerHeight,f=a.devicePixelRatio||1;c.width=d*f,c.height=e*f,console.log("Resizing canvas",d,e,f),c.resizeHandler&&c.resizeHandler()};return a.addEventListener("resize",d,!1),d(),c},d=function(d){return a(d.document),b(d,"Colors for Nell"),c(d)},e=function(d){var e=d.open("","_blank");return a(e),b(e,"Colors for Nell"),c(e)};return{insertMeta:a,new_canvas:function(){return e(window)},set_title:function(a,b){a.ownerDocument.title=b},get_title:function(a){return a.ownerDocument.title}}}),define("src/drawcommand",["./color","./compat","./brush"],function(a,b,c){var d={DRAW:0,DRAW_END:1,COLOR_CHANGE:2,BRUSH_CHANGE:3,DRAW_START:4,NUM_COMMAND_TYPES:5};Object.freeze(d);var e=function(a){console.assert(a>=0&&a<d.NUM_COMMAND_TYPES),this.type=a};return e.prototype={},e.Type=d,e.fromJSON=function(b){var c=typeof b=="string"?JSON.parse(b):b,d=new e(c.type),f;for(f in c)if(c.hasOwnProperty(f))if(f==="color")d[f]=new a,d[f].set_from_color(c[f]);else if(f==="brush_type"){var g=c[f];d[f]=g===0?"hard":g===1?"soft":g}else d[f]=c[f];return d},e.create_draw_start=function(a){a||(a=0);var b=new e(d.DRAW_START);return b.layer=a,b},e.create_draw=function(a,b){b||(b=Date.now());var c=new e(d.DRAW);return c.pos={x:a.x,y:a.y},c.time=b,c},e.create_draw_end=function(){var a=new e(d.DRAW_END);return a},e.create_color_change=function(a){var b=new e(d.COLOR_CHANGE);return b.color=a.copy(),b},e.create_brush_change=function(a){a=a||{};var b=new e(d.BRUSH_CHANGE);return["brush_type","size","opacity","spacing"].forEach(function(c){c in a&&(b[c]=a[c])}),b},e}),define("src/point",[],function(){var a=function(a,b,c){this.set(a,b,c)};return a.prototype={clone:function(){return new a(this.x,this.y,this.isUp)},equals:function(b){return a.equals(this,b)},dist:function(b){return a.dist(this,b)},interp:function(b,c){return a.interp(this,b,c)},set:function(a,b,c){this.x=a,this.y=b,this.isUp=c||!1},set_from_point:function(a){this.set(a.x,a.y,a.isUp)}},a.equals=function(a,b){return a===b?!0:a.x===b.x&&a.y===b.y&&a.isUp===b.isUp},a.dist2=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},a.dist=function(b,c){return Math.sqrt(a.dist2(b,c))},a.interp=function(b,c,d,e){var f=b.x+d*(c.x-b.x),g=b.y+d*(c.y-b.y),h=e||new a;return h.set(f,g,c.isUp),h},a}),define("src/layer",["./drawcommand","./brush","./point"],function(a,b,c){var d=0,e=function(){this.domElement=document.createElement("div"),this.completedCanvas=document.createElement("canvas"),this.progressCanvas=document.createElement("canvas"),this.domElement.appendChild(this.completedCanvas),this.domElement.appendChild(this.progressCanvas),this.domElement.id="layer"+d++,[this.domElement,this.completedCanvas,this.progressCanvas].forEach(function(a){a.style.position="absolute",a.style.left=a.style.top=a.style.right=a.style.bottom="0px",a.style.width="100%",a.style.height="100%"}),this.progressContext=this.progressCanvas.getContext("2d"),this.completedContext=this.completedCanvas.getContext("2d"),this.brush_stamp=null,this.isDrawingPath=!1,this.lastPoint=new c,this.firstPoint=new c,this.spentDist=0,this._draw_from=new c,this._draw_to=new c,this._draw_tmp=new c};return e.prototype={_getBrushStamp:function(a){if(this.brush_stamp===null){var b=a.clone();b.size*=this.pixel_ratio,b.size=Math.max(0,Math.min(128,Math.round(b.size))),this.brush_stamp=b.toCanvas(),this.progressCanvas.style.opacity=a.opacity}return this.brush_stamp},_drawStamp:function(a,b){this.spentDist=0;var c=this._getBrushStamp(b),d=c.width/2,e=b.rotationIncrement(),f=b.followsTangent();if(f&&this.brushPoints===0&&this.tangent===null)this.firstPoint.set_from_point(a);else if(e===0&&!f)this.progressContext.drawImage(c,a.x-d,a.y-d);else{e*=this.brushPoints;if(f){var g=.8,h=Math.atan2(a.y-this.lastPoint.y,a.x-this.lastPoint.x);if(this.brushPoints===0)h=this.tangent;else if(this.brushPoints>1){var i=this.tangent;i>=h&&(i-=2*Math.PI),h-i>2*Math.PI+i-h&&(i+=2*Math.PI),h=g*h+(1-g)*i,h>Math.PI&&(h-=2*Math.PI),h<-Math.PI&&(h+=2*Math.PI)}this.tangent=h,e+=h,this.brushPoints===1&&(this.brushPoints--,this._drawStamp(this.firstPoint,b),this.brushPoints++)}this.progressContext.save(),this.progressContext.translate(a.x,a.y),this.progressContext.rotate(e),this.progressContext.drawImage(c,-d,-d),this.progressContext.restore()}this.lastPoint.set_from_point(a)},execDraw:function(a,b,d){var e=this._draw_from,f=this._draw_to,g=this._draw_tmp;e.set_from_point(this.lastPoint),f.set(a,b);var h=!1;if(!this.isDrawingPath)this.brushPoints=0,this.tangent=null,this.isDrawingPath=!0,this._drawStamp(f,d),h=!0;else{var i=c.dist(e,f),j,k=Math.max(1,d.size*d.spacing);for(j=k-this.spentDist;j<i;j+=k)this.brushPoints++,this._drawStamp(c.interp(e,f,j/i,g),d),h=!0;this.spentDist=i-(j-k),this.lastPoint.set_from_point(f),!!h}return h},execDrawEnd:function(){return console.assert(this.isDrawingPath),this.completedContext.globalAlpha=this.progressCanvas.style.opacity,this.completedContext.drawImage(this.progressCanvas,0,0),this.progressContext.clearRect(0,0,this.width,this.height),this.isDrawingPath=!1,!1},execCommand:function(b,c){switch(b.type){case a.Type.DRAW_START:return console.assert(!this.isDrawingPath),!1;case a.Type.DRAW:return this.execDraw(b.pos.x*this.pixel_ratio,b.pos.y*this.pixel_ratio,c);case a.Type.DRAW_END:return this.execDrawEnd();case a.Type.COLOR_CHANGE:case a.Type.BRUSH_CHANGE:return console.assert(!this.isDrawingPath),this.brush_stamp=null,!1;default:console.assert(!1,b)}},cancelCurrentStroke:function(){this.progressContext.clearRect(0,0,this.width,this.height),this.isDrawingPath=!1},clear:function(){[this.progressContext,this.completedContext].forEach(function(a){a.clearRect(0,0,this.width,this.height)}.bind(this)),this.isDrawingPath=!1,this.brush_stamp=null},resize:function(a,b,c){var d=a*c,e=b*c;[this,this.completedCanvas,this.progressCanvas].forEach(function(a){a.width=d,a.height=e}),this.isDrawingPath=!1,this.brush_stamp=null,this.pixel_ratio=c},saveCheckpoint:function(){console.assert(!this.isDrawingPath);var a=document.createElement("canvas");return a.width=this.completedCanvas.width,a.height=this.completedCanvas.height,a.getContext("2d").drawImage(this.completedCanvas,0,0),new e.Checkpoint(a)},restoreCheckpoint:function(a){console.assert(typeof a!="string","need to decode checkpoint before restoring"),this.clear(),console.assert(!this.isDrawingPath),this.completedContext.globalAlpha=1,this.completedContext.drawImage(a.canvas,0,0)}},e.Checkpoint=function(a){this.canvas=a},e.Checkpoint.prototype={},e.Checkpoint.prototype.toJSON=function(){return{canvas:this.canvas.toDataURL("image/png")}},e.Checkpoint.fromJSON=function(a,b){var c=typeof a=="string"?JSON.parse(a):a,d=document.createElement("img");d.onload=function(){var a=document.createElement("canvas");a.width=d.width,a.height=d.height,a.getContext("2d").drawImage(d,0,0),b(new e.Checkpoint(a))},d.src=c.canvas},e}),define("src/brushdialog",["domReady!","text!./brushdialog.html","./brush","./color","./colorwheel","./coords","./compat","./drawcommand","./hslcolor","./iscroll","./layer","./slider"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=function(a){return function(b){b.preventDefault(),a(b)}},n=function(a){this.domElement=a,this.width=this.domElement.clientWidth,this.height=this.domElement.clientHeight,this.layer=new k,this.layer.resize(this.width,this.height,window.devicePixelRatio||1),this.domElement.appendChild(this.layer.domElement),this.lastBrush=new c(d.BLACK),this.setFromBrush(this.lastBrush)};n.prototype.setFromBrush=function(a){this.type=a.type,this.size=Math.round(a.size),this.spacing=Math.round(a.spacing*100),this.opacity=a.opacity*255},n.prototype.toBrush=function(a){return new c(a,this.type,this.size,this.opacity/255,this.spacing/100)},n.prototype.update=function(){var a=new c(d.WHITE,this.type,this.size,Math.max(20,this.opacity)/255,this.spacing/100);if(a.equals(this.lastBrush))return;this.lastBrush=a,this.layer.clear();var b=30,e=a.size/2,f=this.width-e,g=a.size/2,i=this.height-g,j,k,l={x:0,y:0};this.layer.execCommand(h.create_draw_start(),a);for(j=0;j<b;j++)k=j/(b-1)*.8+.1,l.x=e+j*(f-e)/(b-1),l.y=g+(.5+Math.sin(2*Math.PI*k)/2)*(i-g),this.layer.execCommand(h.create_draw(l),a);this.layer.execCommand(h.create_draw_end(),a)};var o=0,p=function(d,f){this.id=o++,this.brushpane=d,this._initializing=!0,this.brushpane.innerHTML=b,f&&(d.querySelector(".page_select").style.display="none");var h=this.preview=new n(d.querySelector(".stroke")),k=function(a){var b=d.querySelector("input."+a);return b.name=b.id=a+"_"+this.id,b}.bind(this);["hue","saturation","lightness","opacity"].forEach(function(a){["color_","old_color_"].forEach(function(b){k(b+a)}.bind(this))}.bind(this));var p=["brush","color"];p.forEach(function(a){var b=d.querySelector("."+a+"_select");b.addEventListener("click",m(this.switchPane.bind(this,a)),!1)}.bind(this)),this.switchPane(p[0]),d.querySelector(".closer").addEventListener("click",m(function(a){this.close(!0)}.bind(this)),!1),["size","spacing"].forEach(function(a){["minus","plus"].forEach(function(b){var c=d.querySelector("."+a+" ."+b);c.addEventListener("click",m(function(c){l.increment("brush_"+a+"_"+this.id,b==="minus"?-1:1)}.bind(this)))}.bind(this))}.bind(this));var q=function(){var a={},b={},c=!1,d=function(){c=!1,Object.getOwnPropertyNames(a).forEach(function(c){b[c]&&(a[c].apply(null,b[c]),b[c]=null)})};return function(e,f){return a[e]=f,function(){b[e]=Array.prototype.slice.call(arguments);if(c)return;g.requestAnimationFrame(d),c=!0}}}(),r=this._colorFromInputs.bind(this),s=q("updateColor",this._updateColor.bind(this)),t=this._updateOldColor.bind(this);this.wheel=new e(d.querySelector(".wheel"),d),this.wheel.hsCallback=function(a,b){var c=r();d.querySelector("input.color_hue").value=a,d.querySelector("input.color_saturation").value=b,s(new i(a,b,c.lightness,c.opacity))}.bind(this);var u=q("wheel_setHSL",function(a,b,c){this.wheel.setHSL(a,b,c)}.bind(this)),v=q("preview_update",function(){h.update()}),w=function(){var a=r();s(a),u(a.hue,a.saturation,a.lightness),h.opacity!==a.opacity&&(h.opacity=a.opacity,v())},x=function(){var a=r("old_color_");t(a)},y=function(a){d.querySelector("input.color_lightness").value=Math.round(a),l.updateSlider("color_lightness_"+this.id),w()}.bind(this),z=function(a){this._setInputs(a),w()}.bind(this);["white","black","old"].forEach(function(a){var b=d.querySelector(".swatches > ."+a);b.addEventListener("click",m(function(b){a==="white"?y(255):a==="black"?y(0):z(r("old_color_")),b.target.focus()}))});var A=function(){var a=d.querySelector("input.brush_spacing");h.spacing=parseInt(a.value,10)||5,d.querySelector(".spacing .caption").setAttribute("data-amount",h.spacing);if(this._initializing)return;v()}.bind(this);l.createSlider({inp:k("brush_spacing"),range:[5,200],inc:"1",clickJump:!0,hideInput:!0,callbacks:{update:[A]}});var B=function(){var a=d.querySelector("input.brush_size");h.size=parseInt(a.value,10)||1,d.querySelector(".size .caption").setAttribute("data-amount",h.size);if(this._initializing)return;v()}.bind(this);l.createSlider({inp:k("brush_size"),range:[1,129],inc:"1",clickJump:!0,hideInput:!0,callbacks:{update:[B]}});var C=function(){if(this._initializing)return;w()}.bind(this);["lightness","opacity"].forEach(function(a){var b=d.querySelector("input.color_"+a);l.createSlider({inp:b,range:[0,255],inc:"1",clickJump:!0,hideInput:!0,callbacks:{update:[C]}})});var D=function(){var a=this,b=h.toBrush();b.type=c.Types[a.currPageX];if(b.type===h.type)return;b.setToDefaultSpacing(),h.setFromBrush(b),v()},E=d.querySelector(".shape > .scrollwrapper"),F=E.querySelector(".allbrushes").offsetHeight,G=this.brushscroll=new j(E,{vScroll:!1,snap:F,onAnimationEnd:D}),H=d.querySelector(".shape");H.addEventListener("keypress",function(b){b=b||a.parentWindow.event;var c=b.keyCode!=null?b.keyCode:b.charCode;if(c===37||c===40||c===46||c===34)G.scrollToPage("prev");else if(c===39||c===38||c===45||c===33)G.scrollToPage("next");else return!0;return b.stopPropagation(),b.preventDefault(),!1},!0),h.setFromBrush=function(a){var b=this.id;return function(e){a.call(this,e),G.scrollToPage(c.Types[this.type]),[["size",this.size],["spacing",this.spacing]].forEach(function(a){var c=d.querySelector("input.brush_"+a[0]);c.value=a[1],l.updateSlider("brush_"+a[0]+"_"+b);var e=d.querySelector("."+a[0]+" .caption");e.setAttribute("data-amount",a[1])})}}.bind(this)(h.setFromBrush)};return p.prototype={},p.prototype._colorFromInputs=function(a){var b=a||"color_",c=["hue","saturation","lightness","opacity"];return c=c.map(function(a){var c=this.brushpane.querySelector("input."+b+a);return parseInt(c.value,10)||0}.bind(this)),new i(c[0],c[1],c[2],c[3])},p.prototype._setInputs=function(a,b){var c=b||"color_";["hue","saturation","lightness","opacity"].forEach(function(b){var d=this.brushpane.querySelector("input."+c+b);d.value=a[b],l.updateSlider(c+b+"_"+this.id)}.bind(this))},p.prototype._updateOldColor=function(a){var b=a.rgbaString();[".swatches > .old > span"].forEach(function(a){var c=this.brushpane.querySelector(a);c.style.color=b}.bind(this))},p.prototype._updateColor=function(a){var b=a.rgbString(),c=a.rgbaString();[".color_select > span",".opacity_options .fd-slider-bar"].forEach(function(a){var c=this.brushpane.querySelector(a);c.style.color=b}.bind(this)),[".swatches > .new > span"].forEach(function(a){var b=this.brushpane.querySelector(a);b.style.color=c}.bind(this));var d=(new i(a.hue,255,128,255)).rgbString();[".lightness .fd-slider-inner"].forEach(function(a){var b=this.brushpane.querySelector(a);b.style.color=d}.bind(this)),this.colorCallback&&this.colorCallback(a)},p.prototype.open=function(a,b,c){this.callback=c,this._resize=this.onResize.bind(this),window.addEventListener("resize",this._resize,!1),this.updateBrush(a);var d=this.brushpane.querySelector(".panes"),e=function(){this.brushpane.classList.add("visible"),["transitionend","oTransitionEnd","webkitTransitionEnd"].forEach(function(a){d.removeEventListener(a,e,!0)})}.bind(this);this.switchPane(b)?["transitionend","oTransitionEnd","webkitTransitionEnd"].forEach(function(a){d.addEventListener(a,e,!0)}):e()},p.prototype.updateBrush=function(a,b){this._initializing=!0,this.preview.setFromBrush(a),this.preview.update();var c=i.from_color(a.color);c.opacity=this.preview.opacity,this._setInputs(c),this._updateColor(c),b?this._updateOldColor(this._colorFromInputs("old_color_")):(this._setInputs(c,"old_color_"),this._updateOldColor(c)),this.wheel.setHSL(c.hue,c.saturation,c.lightness),this.onResize(),this._initializing=!1},p.prototype.currentPane=function(){return this.brushpane.classList.contains("color")?"color":"brush"},p.prototype.switchPane=function(a){a=a==="color"?a:"brush";if(this.brushpane.classList.contains(a))return!1;var b=this.brushpane.classList;return["color","brush"].forEach(function(c){c===a?b.add(c):b.remove(c)}),!0},p.prototype.onResize=function(){var a=this.brushpane.querySelector(".allbrushes").offsetHeight;this.brushscroll.options.snap=a,this.brushscroll.refresh(),this.brushscroll.scrollToPage(c.Types[this.preview.type],this.brushscroll.currPageY,0),this.wheel.onResize()},p.prototype.isOpen=function(){return this.brushpane.classList.contains("visible")},p.prototype.close=function(a){window.removeEventListener("resize",this._resize,!1),this.brushpane.classList.remove("visible"),a&&this._invokeCallback()},p.prototype._invokeCallback=function(){var a=this._colorFromInputs(),b=a.rgbaColor().add(d.BLACK),c=this.preview.toBrush(b);this.callback&&this.callback.call(null,c)},p}),define("lib/hammer",[],function(){return function(b,c,d){function x(a){return a.touches?a.touches.length:1}function y(a){a=a||window.event;if(!a.touches){var b=document,c=b.body;return[{x:a.pageX||a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b&&b.clientLeft||c&&b.clientLeft||0),y:a.pageY||a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&b.clientTop||0)}]}var d=[],e;for(var f=0,g=a.touches.length;f<g;f++)e=a.touches[f],d.push({x:e.pageX,y:e.pageY});return d}function z(a,b){return Math.atan2(b.y-a.y,b.x-a.x)*180/Math.PI}function A(a,b){b.touches=y(b.originalEvent),b.type=a,H(e["on"+a])&&e["on"+a].call(e,b)}function B(a){a=a||window.event,a.preventDefault?a.preventDefault():(a.returnValue=!1,a.cancelBubble=!0)}function C(){j={},l=!1,k=0,g=0,h=0,m=null}function E(a){switch(a.type){case"mousedown":case"touchstart":j.start=y(a),o=(new Date).getTime(),k=x(a),l=!0,u=a;var d=b.getBoundingClientRect(),e=b.clientTop||document.body.clientTop||0,f=b.clientLeft||document.body.clientLeft||0,p=window.pageYOffset||b.scrollTop||document.body.scrollTop,q=window.pageXOffset||b.scrollLeft||document.body.scrollLeft;s={top:d.top+p-e,left:d.left+q-f},t=!0,D.hold(a),c.prevent_default&&B(a);break;case"mousemove":case"touchmove":if(!t)return!1;v=a,j.move=y(a),D.transform(a)||D.drag(a);break;case"mouseup":case"mouseout":case"touchcancel":case"touchend":if(!t||m!="transform"&&a.touches&&a.touches.length>0)return!1;t=!1,w=a,m=="drag"?A("dragend",{originalEvent:a,direction:i,distance:g,angle:h}):m=="transform"?A("transformend",{originalEvent:a,position:j.center,scale:a.scale,rotation:a.rotation}):D.tap(u),n=m,C()}}function F(a,b){!b&&window.event&&window.event.toElement&&(b=window.event.toElement);if(a===b)return!0;if(b){var c=b.parentNode;while(c!==null){if(c===a)return!0;c=c.parentNode}}return!1}function G(a,b){var c={};if(!b)return a;for(var d in a)d in b?c[d]=b[d]:c[d]=a[d];return c}function H(a){return Object.prototype.toString.call(a)=="[object Function]"}var e=this,f={prevent_default:!1,css_hacks:!0,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_double_distance:20,hold:!0,hold_timeout:500};c=G(f,c),function(){if(!c.css_hacks)return!1;var a=["webkit","moz","ms","o",""],d={userSelect:"none",touchCallout:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},e="";for(var f=0;f<a.length;f++)for(var g in d)e=g,a[f]&&(e=a[f]+e.substring(0,1).toUpperCase()+e.substring(1)),b.style[e]=d[g]}();var g=0,h=0,i=0,j={},k=0,l=!1,m=null,n=null,o=null,p={x:0,y:0},q=null,r=null,s={},t=!1,u,v,w;this.getDirectionFromAngle=function(a){var b={down:a>=45&&a<135,left:a>=135||a<=-135,up:a<-45&&a>-135,right:a>=-45&&a<=45},c,d;for(d in b)if(b[d]){c=d;break}return c};var D={hold:function(a){c.hold&&(m="hold",clearTimeout(r),r=setTimeout(function(){m=="hold"&&A("hold",{originalEvent:a,position:j.start})},c.hold_timeout))},drag:function(a){var b=j.move[0].x-j.start[0].x,d=j.move[0].y-j.start[0].y;g=Math.sqrt(b*b+d*d);if(c.drag&&g>c.drag_min_distance||m=="drag"){h=z(j.start[0],j.move[0]),i=e.getDirectionFromAngle(h);var f=i=="up"||i=="down";if((f&&!c.drag_vertical||!f&&!c.drag_horizontal)&&g>c.drag_min_distance)return;m="drag";var k={x:j.move[0].x-s.left,y:j.move[0].y-s.top},n={originalEvent:a,position:k,direction:i,distance:g,distanceX:b,distanceY:d,angle:h};l&&(A("dragstart",n),l=!1),A("drag",n),B(a)}},transform:function(a){if(c.transform){var b=a.scale||1,d=a.rotation||0;if(x(a)!=2)return!1;if(m!="drag"&&(m=="transform"||Math.abs(1-b)>c.scale_treshold||Math.abs(d)>c.rotation_treshold)){m="transform",j.center={x:(j.move[0].x+j.move[1].x)/2-s.left,y:(j.move[0].y+j.move[1].y)/2-s.top};var e={originalEvent:a,position:j.center,scale:b,rotation:d};return l&&(A("transformstart",e),l=!1),A("transform",e),B(a),!0}}return!1},tap:function(a){var b=(new Date).getTime(),d=b-o;if(c.hold&&!(c.hold&&c.hold_timeout>d))return;var e=function(){if(p&&c.tap_double&&n=="tap"&&o-q<c.tap_max_interval){var a=Math.abs(p[0].x-j.start[0].x),b=Math.abs(p[0].y-j.start[0].y);return p&&j.start&&Math.max(a,b)<c.tap_double_distance}return!1}();e?(m="double_tap",q=null,A("doubletap",{originalEvent:a,position:j.start}),B(a)):(m="tap",q=b,p=j.start,c.tap&&(A("tap",{originalEvent:a,position:j.start}),B(a)))}};"ontouchstart"in window?(b.addEventListener("touchstart",E,!1),b.addEventListener("touchmove",E,!1),b.addEventListener("touchend",E,!1),b.addEventListener("touchcancel",E,!1)):b.addEventListener?(b.addEventListener("mouseout",function(a){F(b,a.relatedTarget)||E(a)},!1),b.addEventListener("mouseup",E,!1),b.addEventListener("mousedown",E,!1),b.addEventListener("mousemove",E,!1)):document.attachEvent&&(b.attachEvent("onmouseout",function(a){F(b,a.relatedTarget)||E(a)},!1),b.attachEvent("onmouseup",E),b.attachEvent("onmousedown",E),b.attachEvent("onmousemove",E))}}),define("src/postmessage",[],function(){return function(b,c,d,e){try{b.postMessage(c,d,e)}catch(f){typeof c!="string"&&(c=JSON.stringify(c)),b.postMessage(c,e,d)}}}),define("src/alea",[],function(){function a(){var a=4022871197,b=function(b){b=b.toString();for(var c=0;c<b.length;c++){a+=b.charCodeAt(c);var d=.02519603282416938*a;a=d>>>0,d-=a,d*=a,a=d>>>0,d-=a,a+=d*4294967296}return(a>>>0)*2.3283064365386963e-10};return b.version="Mash 0.9",b}function b(){return function(b){var c=0,d=0,e=0,f=1;b.length==0&&(b=[+(new Date)]);var g=a();c=g(" "),d=g(" "),e=g(" ");for(var h=0;h<b.length;h++)c-=g(b[h]),c<0&&(c+=1),d-=g(b[h]),d<0&&(d+=1),e-=g(b[h]),e<0&&(e+=1);g=null;var i=function(){var a=2091639*c+f*2.3283064365386963e-10;return c=d,d=e,e=a-(f=a|0)};return i.uint32=function(){return i()*4294967296},i.fract53=function(){return i()+(i()*2097152|0)*1.1102230246251565e-16},i.version="Alea 0.9",i.args=b,i}(Array.prototype.slice.call(arguments))}return{Random:b}}),define("src/lawnchair/core",[],function(){var a=function(b,c){if(!(this instanceof a))return new a(b,c);if(!JSON)throw"JSON unavailable! Include http://www.json.org/json2.js to fix.";if(arguments.length<=2&&arguments.length>0)c=typeof arguments[0]=="function"?arguments[0]:arguments[1],b=typeof arguments[0]=="function"?{}:arguments[0];else throw"Incorrect # of ctor args!";if(typeof c!="function")throw"No callback was provided";this.record=b.record||"record",this.name=b.name||"records";var d;if(b.adapter){for(var e=0,f=a.adapters.length;e<f;e++)if(a.adapters[e].adapter===b.adapter){d=a.adapters[e].valid()?a.adapters[e]:undefined;break}}else for(var e=0,f=a.adapters.length;e<f;e++){d=a.adapters[e].valid()?a.adapters[e]:undefined;if(d)break}if(!d)throw"No valid adapter.";for(var g in d)this[g]=d[g];for(var e=0,f=a.plugins.length;e<f;e++)a.plugins[e].call(this);this.init(b,c)};return a.adapters=[],a.adapter=function(b,c){c.adapter=b;var d="adapter valid init keys save batch get exists all remove nuke".split(" "),e=this.prototype.indexOf;for(var f in c)if(e(d,f)===-1)throw"Invalid adapter! Nonstandard method: "+f;a.adapters.splice(0,0,c)},a.plugins=[],a.plugin=function(b){for(var c in b)c==="init"?a.plugins.push(b[c]):this.prototype[c]=b[c]},a.prototype={isArray:Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},indexOf:function(a,b,c,d){if(a.indexOf)return a.indexOf(b);for(c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},lambda:function(a){return this.fn(this.record,a)},fn:function(a,b){return typeof b=="string"?new Function(a,b):b},uuid:function(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},each:function(a){var b=this.lambda(a);if(this.__results)for(var c=0,d=this.__results.length;c<d;c++)b.call(this,this.__results[c],c);else this.all(function(a){for(var c=0,d=a.length;c<d;c++)b.call(this,a[c],c)});return this}},a}),define("src/lawnchair/adapters/indexed-db.js",[],function(){return function(a){a.adapter("indexed-db",function(){function a(a,b){console.error("error in indexed-db adapter!",a,b)}var b="lawnchair",c=2,d=function(){return window.indexedDB||window.webkitIndexedDB||window.oIndexedDB||window.msIndexedDB},e=function(){return window.IDBTransaction||window.webkitIDBTransaction||window.mozIDBTransaction||window.oIDBTransaction||window.msIDBTransaction},f=function(){return window.IDBKeyRange||window.webkitIDBKeyRange||window.mozIDBKeyRange||window.oIDBKeyRange||window.msIDBKeyRange},g=function(){return window.IDBDatabaseException||window.webkitIDBDatabaseException||window.mozIDBDatabaseException||window.oIDBDatabaseException||window.msIDBDatabaseException},h=e()&&"READ_WRITE"in e()?e().READ_WRITE:"readwrite";return{valid:function(){return!!d()},init:function(e,f){this.idb=d(),this.waiting=[];var h=this.idb.open(this.name,c),i=this,j=i.fn(i.name,f),k=function(){return h.onupgradeneeded=h.onsuccess=h.error=null,j.call(i,i)},l=function(a,c){try{i.db.deleteObjectStore("teststore")}catch(d){}try{i.db.deleteObjectStore(b)}catch(e){}i.db.createObjectStore(b),i.store=!0};h.onupgradeneeded=function(a){i.db=h.result,i.transaction=h.transaction,l(a.oldVersion,a.newVersion)},h.onsuccess=function(b){i.db=h.result;if(i.db.version!=""+c){var d=i.db.version,e=i.db.setVersion(""+c);e.onsuccess=function(a){var b=e.result;e.onsuccess=e.onerror=null,l(d,c),b.oncomplete=function(){for(var a=0;a<i.waiting.length;a++)i.waiting[a].call(i);i.waiting=[],k()}},e.onerror=function(b){e.onsuccess=e.onerror=null,console.log("Failed to create objectstore "+b),a(b)}}else{i.store=!0;for(var f=0;f<i.waiting.length;f++)i.waiting[f].call(i);i.waiting=[],k()}},h.onblocked=function(a){console.log("onblocked!")},h.onerror=function(a){if(h.errorCode===g().VERSION_ERR)return i.idb.deleteDatabase(i.name),i.init(e,f);console.error("Failed to open database")}},save:function(c,d){if(!this.store){this.waiting.push(function(){this.save(c,d)});return}var e=this,f,g=function(a){f.onsuccess=f.onerror=null,d&&(c.key=a.target.result,e.lambda(d).call(e,c))},i=this.db.transaction(b,h),j=i.objectStore(b);return f=c.key?j.put(c,c.key):j.put(c),f.onsuccess=g,f.onerror=a,this},batch:function(a,b){var c=[],d=!1,e=this,f=function(b){c.push(b),d=c.length===a.length},g=setInterval(function(){d&&(b&&e.lambda(b).call(e,c),clearInterval(g))},200);for(var h=0,i=a.length;h<i;h++)this.save(a[h],f);return this},get:function(c,d){if(!this.store){this.waiting.push(function(){this.get(c,d)});return}var e=this,f=function(a){d&&e.lambda(d).call(e,a.target.result)};if(!this.isArray(c)){var g=this.db.transaction(b).objectStore(b).get(c);g.onsuccess=function(a){g.onsuccess=g.onerror=null,f(a)},g.onerror=function(b){console.log("Failed to find "+c),g.onsuccess=g.onerror=null,a(b)}}else{var h=[],i=!1,j=c,k=function(a){h.push(a),i=h.length===j.length,i&&e.lambda(d).call(e,h)};for(var l=0,m=j.length;l<m;l++)this.get(j[l],k)}return this},exists:function(c,d){if(!this.store){this.waiting.push(function(){this.exists(c,d)});return}var e=this,g=this.db.transaction(b).objectStore(b).openCursor(f().only(c));return g.onsuccess=function(a){g.onsuccess=g.onerror=null;var b;e.lambda(d).call(e,a.target.result!==null&&a.target.result!==b)},g.onerror=function(b){g.onsuccess=g.onerror=null,console.log("Failed to test for "+c),a(b)},this},all:function(a){if(!this.store){this.waiting.push(function(){this.all(a)});return}var c=this.fn(this.name,a)||undefined,d=this,e=this.db.transaction(b).objectStore(b),f=[];return e.openCursor().onsuccess=function(a){var b=a.target.result;b?(f.push(b.value),b["continue"]()):c&&c.call(d,f)},this},remove:function(c,d){if(!this.store){this.waiting.push(function(){this.remove(c,d)});return}typeof c=="object"&&(c=c.key);var e=this,f,g=function(){f.onsuccess=f.onerror=null,d&&e.lambda(d).call(e)};return f=this.db.transaction(b,h).objectStore(b)["delete"](c),f.onsuccess=g,f.onerror=a,this},nuke:function(c,d){if(!this.store){this.waiting.push(function(){this.nuke(c,d)});return}var e=this,f=c?function(){e.lambda(c).call(e)}:function(){};if(d){this.waiting.length&&a(),this.idb.deleteDatabase(this.name),delete this.store,delete this.waiting,f();return}try{this.db.transaction(b,h).objectStore(b).clear().onsuccess=f}catch(g){a()}return this}}}())}}),define("src/lawnchair/adapters/dom.js",[],function(){return function(a){a.adapter("dom",function(){var a=window.localStorage,b=function(b){return{key:b+"._index_",all:function(){var b=a.getItem(this.key);return b&&(b=JSON.parse(b)),b===null&&a.setItem(this.key,JSON.stringify([])),JSON.parse(a.getItem(this.key))},add:function(b){var c=this.all();c.push(b),a.setItem(this.key,JSON.stringify(c))},del:function(b){var c=this.all(),d=[];for(var e=0,f=c.length;e<f;e++)c[e]!=b&&d.push(c[e]);a.setItem(this.key,JSON.stringify(d))},find:function(a){var b=this.all();for(var c=0,d=b.length;c<d;c++)if(a===b[c])return c;return!1}}};return{valid:function(){return!!a},init:function(a,c){this.indexer=b(this.name),c&&this.fn(this.name,c).call(this,this)},save:function(b,c){var d=b.key?this.name+"."+b.key:this.name+"."+this.uuid();return this.indexer.find(d)===!1&&this.indexer.add(d),delete b.key,a.setItem(d,JSON.stringify(b)),b.key=d.slice(this.name.length+1),c&&this.lambda(c).call(this,b),this},batch:function(a,b){var c=[];for(var d=0,e=a.length;d<e;d++)this.save(a[d],function(a){c.push(a)});return b&&this.lambda(b).call(this,c),this},keys:function(a){if(a){var b=this.name,c=this.indexer.all().map(function(a){return a.replace(b+".","")});this.fn("keys",a).call(this,c)}return this},get:function(b,c){if(this.isArray(b)){var d=[];for(var e=0,f=b.length;e<f;e++){var g=this.name+"."+b[e],h=a.getItem(g);h&&(h=JSON.parse(h),h.key=b[e],d.push(h))}c&&this.lambda(c).call(this,d)}else{var g=this.name+"."+b,h=a.getItem(g);h&&(h=JSON.parse(h),h.key=b),c&&this.lambda(c).call(this,h)}return this},exists:function(a,b){var c=this.indexer.find(this.name+"."+a)===!1?!1:!0;return this.lambda(b).call(this,c),this},all:function(b){var c=this.indexer.all(),d=[],e,f;for(var g=0,h=c.length;g<h;g++)f=c[g],e=JSON.parse(a.getItem(f)),e.key=f.replace(this.name+".",""),d.push(e);return b&&this.fn(this.name,b).call(this,d),this},remove:function(b,c){var d=this.name+"."+(b.key?b.key:b);return this.indexer.del(d),a.removeItem(d),c&&this.lambda(c).call(this),this},nuke:function(a){return this.all(function(b){for(var c=0,d=b.length;c<d;c++)this.remove(b[c]);a&&this.lambda(a).call(this)}),this}}}())}}),define("src/lawnchair/adapters/window-name.js",[],function(){return function(a){a.adapter("window-name",function(a,b){typeof window=="undefined"&&(window={top:{}});var c=window.top.name?JSON.parse(window.top.name):{};return{valid:function(){return typeof window.top.name!="undefined"},init:function(d,e){c[this.name]=c[this.name]||{index:[],store:{}},a=c[this.name].index,b=c[this.name].store,this.fn(this.name,e).call(this,this)},keys:function(b){return this.fn("keys",b).call(this,a),this},save:function(d,e){var f=d.key||this.uuid();return this.exists(f,function(g){g||(d.key&&delete d.key,a.push(f)),b[f]=d,window.top.name=JSON.stringify(c),e&&(d.key=f,this.lambda(e).call(this,d))}),this},batch:function(a,b){var c=[];for(var d=0,e=a.length;d<e;d++)this.save(a[d],function(a){c.push(a)});return b&&this.lambda(b).call(this,c),this},get:function(a,c){var d;if(this.isArray(a)){d=[];for(var e=0,f=a.length;e<f;e++)d.push(b[a[e]])}else d=b[a],d&&(d.key=a);return c&&this.lambda(c).call(this,d),this},exists:function(a,c){return this.lambda(c).call(this,!!b[a]),this},all:function(c){var d=[];for(var e=0,f=a.length;e<f;e++){var g=b[a[e]];g.key=a[e],d.push(g)}return this.fn(this.name,c).call(this,d),this},remove:function(d,e){var f=this.isArray(d)?d:[d];for(var g=0,h=f.length;g<h;g++)delete b[f[g]],a.splice(this.indexOf(a,f[g]),1);return window.top.name=JSON.stringify(c),e&&this.lambda(e).call(this),this},nuke:function(d){return b={},a=[],window.top.name=JSON.stringify(c),d&&this.lambda(d).call(this),this}}}())}}),define("src/lawnchair/lawnchair",["./core","./adapters/indexed-db.js","./adapters/dom.js","./adapters/window-name.js"],function(a){for(var b=arguments.length-1;b>0;b--)arguments[b](a);return a}),define("src/prandom",["./alea","./lawnchair/lawnchair"],function(a,b){var c=function(c){b({name:"uuid"},function(){var d=this,e=function(e){var f=a.Random(Date.now(),Math.random(),JSON.stringify(e));d.save({key:"pool",time:Date.now(),data:[f(),f(),f()]});var g=function(){if(window.btoa){var a=function(){return f.uint32()&255},b=String.fromCharCode(a(),a(),a(),a(),a(),a(),a(),a(),a());return window.btoa(b).replace("+","-").replace("/","_")}var c=function(){return((1+f())*65536|0).toString(16).substring(1)},d=function(){return arguments[Math.floor(f()*arguments.length)]+c().substring(1)};return c()+c()+"-"+c()+"-"+d("4")+"-"+d("8","9","a","b")+"-"+c()+c()+c()};b.prototype.uuid=f.uuid=g,c(f)};d.exists("pool",function(a){a?d.get("pool",e):e({})})})};return{load:function(a,b,d,e){e.isBuild?d(null):c(d)}}}),define("src/drawing",["./brush","./color","./drawcommand","./layer","./prandom!"],function(a,b,c,d,e){var f=300,g=10*f,h=1e3,i=function(){this.domElement=document.createElement("div"),this.commands=[],this.commands.last=0,this.commands.end=0,this.layers=[],this.checkpoints=[],this.checkpointOften=!0,this.resize(100,100,1),this.layers.current=this.addLayer(),this.chunks=[],this.ctime=Date.now(),this.brush=new a(b.BLACK,"soft",20,.7,.2),this.addCmd(c.create_color_change(this.brush.color)),this.addCmd(c.create_brush_change({brush_type:this.brush.type,size:this.brush.size,opacity:this.brush.opacity,spacing:this.brush.spacing})),this.commands.recog=this.commands.end};i.prototype={},i.prototype.attachToContainer=function(a){a.appendChild(this.domElement)},i.prototype.removeFromContainer=function(a){a.removeChild(this.domElement)},i.prototype.addLayer=function(){var a=new d;return a.resize(this.width,this.height,this.pixelRatio),this.layers.push(a),this.domElement.appendChild(a.domElement),this.layers.length-1},i.prototype.addCmd=function(a){this.commands[this.commands.end++]=a,this.commands.length=this.commands.end;while(this.checkpoints.length>0&&this.checkpoints[this.checkpoints.length-1].pos>=this.commands.length)this.checkpoints.pop();while(this.chunks.length>0&&this.chunks[this.chunks.length-1].end>=this.commands.length-1)this.chunks.pop()},i.START=0,i.END=-1,i.prototype.setCmdPos=function(a,b){var d=Date.now();a===i.END&&(a=this.commands.end),console.assert(a<=this.commands.end);var e=this._findNearestCheckpoint(a);e?(a<this.commands.last||a-e.pos<a-this.commands.last)&&this._restoreCheckpoint(e):a<this.commands.last&&(this._clear(),this.commands.last=0),console.assert(this.commands.last<=a);while(this.commands.last<a){this._execCommand(this.commands[this.commands.last++]);if(this.commands[this.commands.last-1].type===c.Type.DRAW_END){this.addCheckpoint();if(b&&Date.now()-d>b)break}}return this.commands.last<this.commands.end},i.prototype.setCmdTime=function(a,b){var d=this.commands.last;if(d===this.commands.end)return!1;var e=this.commands[d++];while(d<this.commands.end&&a>0){var f=this.commands[d++];e.type===c.Type.DRAW&&f.type===c.Type.DRAW&&(a-=f.time-e.time),e=f}return this.setCmdPos(d,b)},i.prototype.undo=function(a){if(this.commands.end===0)return!1;var b=this.commands.end-1;while(b>=0&&this.commands[b].type!==c.Type.DRAW_START)b--;if(b<0)return!1;this.setCmdPos(b,a),this.commands.end=b;var d=this.commands.last<this.commands.end;return d},i.prototype.redo=function(a){if(this.commands.end>=this.commands.length)return!1;var b=this.commands.end;while(b<this.commands.length&&this.commands[b].type!==c.Type.DRAW_END)b++;while(b<this.commands.length&&this.commands[b].type!==c.Type.DRAW_START)b++;this.commands.end=b;var d=this.setCmdPos(i.END,a);return d},i.prototype.resize=function(a,b,c){this.layers.forEach(function(d){d.resize(a,b,c)}),this.commands.last=0,this.width=a,this.height=b,this.pixelRatio=c,this.checkpoints=this.checkpoints.filter(function(d){return d.width>=a&&d.height>=b&&d.pixelRatio===c})},i.prototype._clear=function(){this.layers.forEach(function(a){a.clear()})},i.prototype._execCommand=function(a){switch(a.type){case c.Type.DRAW_START:return this.layers.current=a.layer,this.layers[this.layers.current].execCommand(a);case c.Type.DRAW:case c.Type.DRAW_END:return this.layers[this.layers.current].execCommand(a,this.brush);case c.Type.COLOR_CHANGE:return this.brush.color=a.color,this.layers.forEach(function(b){b.execCommand(a)}),!1;case c.Type.BRUSH_CHANGE:return["brush_type","size","opacity","spacing"].forEach(function(b){b in a&&(this.brush[b==="brush_type"?"type":b]=a[b])}.bind(this)),this.layers.forEach(function(b){b.execCommand(a)}),!1;default:console.assert(!1,"Unknown drawing command",a)}},i.prototype._saveCheckpoint=function(){return new i.Checkpoint({pos:this.commands.last,brush:this.brush.clone(),layers:this.layers.map(function(a){return a.saveCheckpoint()}),width:this.width,height:this.height,pixelRatio:this.pixelRatio})},i.prototype._restoreCheckpoint=function(a){this.commands.last=a.pos,this.brush=a.brush.clone(),a.layers.forEach(function(a,b){this.layers[b].restoreCheckpoint(a)}.bind(this))};var j=function(a,b,c){var d=0,e=a.length-1,f,g;while(d<=e){f=d+Math.floor((e-d)/2),g=c(a[f],b);if(g<0)d=f+1;else if(g>0)e=f-1;else return f}return-(d+1)},k=function(a,b){return a.pos-b.pos};i.prototype._findNearestCheckpoint=function(a){var b=j(this.checkpoints,{pos:a},k);return b>=0?this.checkpoints[b]:(b=-(b+1),b===0?null:this.checkpoints[b-1])},i.prototype.addCheckpoint=function(a){var b={pos:this.commands.last},c=j(this.checkpoints,b,k);if(c>=0)return;c=-(c+1);var d=b.pos-(c===0?0:this.checkpoints[c-1].pos),e=this.checkpointOften?f:g;if(d<e&&!a)return;this.checkpoints.splice(c,0,this._saveCheckpoint()),this._thinCheckpoints()},i.prototype._thinCheckpoints=function(){var a=[],b,c=0;for(b=0;b<this.checkpoints.length-1;b++){if(this.checkpoints[b].pos>this.commands.last)break;var d=this.checkpoints[b+1].pos-c,e=this.commands.last-this.checkpoints[b+1].pos;d>e&&(a.push(this.checkpoints[b]),c=this.checkpoints[b].pos)}for(;b<this.checkpoints.length;b++)a.push(this.checkpoints[b]);this.checkpoints=a},i.Checkpoint=function(a){var b;for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},i.Checkpoint.prototype={},i.Checkpoint.fromJSON=function(b,c){var e=typeof b=="string"?JSON.parse(b):b;e.brush=a.fromJSON(e.brush);if(e.layers.length===0)c(new i.Checkpoint(e));else{var f=0;e.layers.forEach(function(a,b){d.Checkpoint.fromJSON(a,function(a){e.layers[b]=a,f++,f===e.layers.length&&c(new i.Checkpoint(e))})})}},i.Chunk=function(a,b,c,d,f){this.drawing=a,this.uuid=e.uuid(),this.num=b,this.start=c,this.end=d,this.prev=f},i.Chunk.prototype={},i.Chunk.prototype.toJSON=function(){console.assert(this.end<=this.drawing.commands.length);var a={num:this.num,uuid:this.uuid,start:this.start,prev:this.prev};this.drawing.uuid&&(a.drawing=this.drawing.uuid);if(this.checkpoint){var b=this.drawing._findNearestCheckpoint(this.end);b&&(a.checkpoint=b)}return a.commands=this.drawing.commands.slice(this.start,this.end),a},i.prototype._makeChunks=function(){if(this.commands.length===0)return;while(this.chunks.length>0&&this.chunks[this.chunks.length-1].checkpoint&&this.chunks[this.chunks.length-1].end+h<this.commands.length)this.chunks.pop();while(this.chunks.length>0&&!this.chunks[this.chunks.length-1].checkpoint&&this.chunks[this.chunks.length-1].end+h>=this.commands.length)this.chunks.pop();for(;;){var a=this.chunks.length===0?0:this.chunks[this.chunks.length-1].end;if(a>=this.commands.length)break;var b=Math.min(a+h,this.commands.length),c=this.chunks.length===0?null:this.chunks[this.chunks.length-1],d=new i.Chunk(this,c?c.num+1:0,a,b,c?c.uuid:null);d.end<this.commands.length&&d.end+h>=this.commands.length&&(d.checkpoint=!0),this.chunks.push(d)}},i.prototype.toJSON=function(a){var b=[];this.checkpoints.length>0&&!a&&b.push(this.checkpoints[0]),this.checkpoints.length>1&&!a&&b.push(this.checkpoints[this.checkpoints.length-1]);var c={end:this.commands.end,nLayers:this.layers.length,width:this.width,height:this.height,pixelRatio:this.pixelRatio,ctime:this.ctime,checkpoints:b};return this.uuid&&(c.uuid=this.uuid),a&&this._makeChunks(),a&&this.chunks.length>0?(c.firstChunk=this.chunks[0].uuid,c.lastChunk=this.chunks[this.chunks.length-1].uuid,c.nChunks=this.chunks.length):c.commands=this.commands,c};var l=function(a,b,d){var e=typeof a=="string"?JSON.parse(a):a,f=new i;while(f.layers.length<(e.nLayers||e.nlayers))f.addLayer();f.commands.length=f.commands.end=f.commands.last=0;var g=[];b?f.chunks=b.map(function(a){var b=typeof a=="string"?JSON.parse(a):a;b.commands.forEach(function(a){f.addCmd(c.fromJSON(a))});var d=new i.Chunk(f,b.num,b.start,b.start+b.commands.length,b.prev);return d.uuid=b.uuid,b.checkpoint&&(g.push(b.checkpoint),d.checkpoint=!0),d}):(e.commands.forEach(function(a){f.addCmd(c.fromJSON(a))}),g=e.checkpoints),f.commands.end=f.commands.recog=e.end,f.resize(e.width,e.height,e.pixelRatio||1),e.active_layer&&(f.layers.current=e.active_layer||0),e.initial_playback_speed&&(f.initial_playback_speed=e.initial_playback_speed||2),e.uuid&&(f.uuid=e.uuid),e.ctime&&(f.ctime=e.ctime);if(g.length===0)d(f);else{var h=0;g.forEach(function(a,b){i.Checkpoint.fromJSON(a,function(a){f.checkpoints[b]=a,h++,h===g.length&&d(f)})})}};return i.fromJSON=function(a,b){return l(a,null,b)},i.fromChunks=function(a,b,c){return l(a,b,c)},i}),define("src/hand/features",["../point","../compat"],function(a,b){var c=b.Float64Array,d=3,e=.25,f=1/7,g=2,h=2,i=function(a,b){this.tl=a,this.br=b};i.prototype={unionPt:function(a){a.x<this.tl.x&&(this.tl.x=a.x),a.y<this.tl.y&&(this.tl.y=a.y),a.x>this.br.x&&(this.br.x=a.x),a.y>this.br.y&&(this.br.y=a.y)},union:function(a){this.unionPt(a.tl),this.unionPt(a.br)},size:function(){return{width:this.br.x-this.tl.x,height:this.br.y-this.tl.y}}},i.fromPts=function(a){var b=new i(a[0].clone(),a[0].clone());return a.forEach(function(a){b.unionPt(a)}),b};var j=function(b){var c=b.ppmm,d=function(b){return new a(b[0],b[1])};b.strokes=b.strokes.map(function(a){a=a.map(d);var b=[a[0]],c;for(c=1;c<a.length;c++){if(a[c].equals(a[c-1]))continue;b.push(a[c])}return b}),b.strokes=b.strokes.filter(function(a){return a.length>1});if(b.strokes.length===0)return;var e=b.strokes.map(function(a){return i.fromPts(a)}),f=e[0];e.forEach(function(a){f.union(a)});var g=f.size();g=Math.max(g.width/c.x,g.height/c.y);var h=function(b){var d=(b.x-f.tl.x)/(c.x*g),e=(b.y-f.tl.y)/(c.y*g);return new a(d,e)};b.strokes=b.strokes.map(function(a){return a.map(h)})},k=function(b){b.strokes=b.strokes.map(function(b){var c=[],f,g;for(f=0;f<b.length;f++){var h=new a(b[f].x*e,b[f].y*e),i=d;while(i>0&&(f<i||f>=b.length-i))i--;for(g=1;g<=i;g++)h.x+=b[f-g].x+b[f+g].x,h.y+=b[f-g].y+b[f+g].y;h.x/=2*i+e,h.y/=2*i+e,c.push(h)}return c})},l=function(b){var c=[];b.strokes.forEach(function(b){var d=b[0],e;c.push(new a(d.x,d.y,!0));for(e=1;e<b.length;e++)c.push(b[e])}),b.strokes=[c]},m=function(b,c){console.assert(b.strokes.length===1),c||(c=f);var d=b.strokes[0];if(d.length===0)return;var e=[],g=d[0],h=0,i=!0,j=!0;d.forEach(function(b){var d=a.dist(g,b);while(h<=d){var f=j?0:h/d,k=a.interp(g,b,f),l=b.isUp;i&&(k.isUp=!0),i=j?!1:l,e.push(k),h+=c,j=!1}h-=d,g=b}),e[e.length-1].isUp&&(console.assert(!g.isUp,arguments[2]),e.push(g)),b.strokes=[e]},n=function(a){var b,c=a.strokes[0],d=c.map(function(){return[]});for(b=0;b<c.length;b++){var e=c[b<2?0:b-2],f=c[b<1?0:b-1],g=c[b],h=c[b+1<c.length?b+1:c.length-1],j=c[b+2<c.length?b+2:c.length-1],k=h.x-f.x,l=h.y-f.y,m=Math.sqrt(k*k+l*l),n=j.x-e.x,o=j.y-e.y,p=Math.sqrt(n*n+o*o),q=i.fromPts([e,f,g,h,j]).size(),r=e.dist(f)+f.dist(g)+g.dist(h)+h.dist(j),s=function(a){return Math.abs(n*(e.y-a.y)-o*(e.x-a.x))/p},t=s(f),u=s(g),v=s(h),w=3;f.equals(e)&&w--,h.equals(j)&&w--,d[b]=[0,0,k/m,l/m,g.y,(q.height-q.width)/(q.height+q.width),r/Math.max(q.height,q.width)-2,(t*t+u*u+v*v)/w,n/p,g.isUp?1:-1]}for(b=0;b<d.length;b++){var x=d[b<1?0:b-1],y=d[b],z=d[b+1<d.length?b+1:d.length-1],A=x[2],B=x[3],C=z[2],D=z[3];y[0]=A*C+B*D,y[1]=A*D-B*C}for(b=0;b<d.length;b++)d[b][4]=2*d[b][4]-1,d[b][6]=(d[b][6]+1)/3.2*2-1,d[b][7]=d[b][7]*50-1;a.features=d},o=function(){return 0},p=function(a,b){var c=a.length-1,d,e,f,g,h,i,j,k=[];for(e=0;e<=c;e++){i=a[e].map(o),j=0;for(d=1;d<=b;d++){f=Math.min(e+d,c),g=Math.max(e-d,0);for(h=0;h<a[e].length;h++)i[h]+=d*(a[f][h]-a[g][h]);j+=d*d}j*=2,k[e]=[];for(h=0;h<a[e].length;h++)k[e][h]=i[h]/j}return k},q=function(a){a.deltas=p(a.features,g),a.accels=p(a.deltas,h)},r=function(a){a.features=a.features.map(function(b,c){return b.concat(a.deltas[c],a.accels[c])}),delete a.deltas,delete a.accels},s=function(a){console.assert(a.Type==="linear"),console.assert(a.CovKind==="euclidean");var b=function(b,d){var e=[];a.Nodes.forEach(function(a){var b=d*(a.VQ-1);a.Mean.forEach(function(a,c){e[b+c]=a})});var f=new c(e.length);return e.forEach(function(a,b){f[b]=a}),f},d=function(a,b,c){var d=c.length*b,e=0,f,g;for(g=0;g<c.length;g++)f=c[g]-a[d+g],e+=f*f;return e},e=function(a,b){var c=0,e=d(a,0,b),f;for(f=1;f*b.length<a.length;f++){var g=d(a,f,b);g<e&&(e=g,c=f)}return c},f=a.Streams.map(function(a,c){return b(c+1,a)}),g=function(a,b){return e(f[b],a)},h=function(){return Array.prototype.map.call(arguments,g)};return h},t=function(a){console.assert(a.Type==="tree"),console.assert(a.CovKind==="euclidean");var b=function(b,d){var e={},f=[],g=[];a.Nodes.forEach(function(a){a.Stream===b&&(e[a.Id]=a)});var h=function(a,b){g[b]=a.VQ;var c=b*d;a.Mean.forEach(function(a,b){f[c+b]=a}),a.LeftId&&h(e[a.LeftId],1+2*b),a.RightId&&h(e[a.RightId],2+2*b)};h(e[1],0);var i=new c(f.length);f.forEach(function(a,b){i[b]=a});var j=new Uint16Array(g.length);return g.forEach(function(a,b){j[b]=a}),[j,i]},d=function(a,b,c){var d=c.length*b,e=0,f,g;for(g=0;g<c.length;g++)f=c[g]-a[d+g],e+=f*f;return e},e=function(a,b,c){var e=0;for(;;){if(a[e]!==0)return a[e]-1;var f=d(b,1+2*e,c),g=d(b,2+2*e,c);e=1+2*e,f>g&&e++}},f=a.Streams.map(function(a,c){return b(c+1,a)}),g=function(a,b){return e(f[b][0],f[b][1],a)},h=function(){return Array.prototype.map.call(arguments,g)};return h},u=function(a){var b;return a.Type==="tree"?b=t(a):a.Type==="linear"?b=s(a):console.assert(!1,a.Type),function(a){a.vq=[];var c;for(c=0;c<a.features.length;c++)a.vq[c]=b(a.features[c],a.deltas[c],a.accels[c])}};return{SMOOTH_N:d,SMOOTH_ALPHA:e,RESAMPLE_INTERVAL:f,Box:i,Point:a,normalize:j,smooth:k,singleStroke:l,equidist:m,features:n,delta_and_accel:q,merge_delta_and_accel:r,make_vq:u}}),define("src/recog",["./compat","./drawcommand","./hand/features"],function(a,b,c,d,e){var f=function(a,d,e){var f,g,h=[],i=[],j=null,k;for(f=d;f<e;f++){g=a[f];switch(g.type){case b.Type.DRAW:i.push([g.pos.x,-g.pos.y]),j?j.unionPt(g.pos):(k=new c.Point(g.pos.x,g.pos.y),j=new c.Box(k.clone(),k.clone()));break;case b.Type.DRAW_END:i.length>0&&(h.push(i),i=[]);break;default:}}if(h.length===0)return null;var l={strokes:h,ppmm:{x:1,y:1},bbox:j};return c.normalize(l),c.smooth(l),c.singleStroke(l),c.equidist(l),l.strokes[0].length===0?null:(c.features(l),l.features.length===0?null:(c.delta_and_accel(l),l))},g=null,h=function(a){console.assert(g===null),g=a},i=new a.Worker("src/worker.js"),j=null,k=!0,l=function(){if(k||j===null)return;var a={type:"recog",data_set:j};i.postMessage(JSON.stringify(a)),j=null,k=!0};i.addEventListener("message",function(a){var b=JSON.parse(a.data);switch(b.type){case"debug":console.log.apply(console,b.args);break;case"ready":k=!1,l();break;case"recog":k=!1,l(),g&&g(b.model,b.prob,b.bbox);break;default:console.error("Unexpected message from worker",a)}}),i.postMessage(JSON.stringify({type:"start"}));var m=function(a,b,c){typeof b!="number"&&(b=0),typeof c!="number"&&(c=a.length);var d=f(a,b,c);if(!d)return;j=d,l();return};return{attemptRecognition:m,registerCallback:h}}),define("src/sound",[],function(){function d(){}function f(a,b){var c=new a({url:b.url,instances:b.instances,callback:b.callback,errback:b.errback})}function g(b){var c=b.url;if(!c)throw"you must pass a URL to Effect.";var f=new e(c,b.formats||[],b.instances||a,b.callback?function(a,b){return function(){b(a)}}(this,b.callback):d,b.errback||d);this.__defineGetter__("audio",function(){return f.getInstance()}),this.__defineGetter__("url",function(){return c}),this.play=function(){var a=this.audio;return a?(a.play(),a):null},this.loop=function(){f.loop()},this.unloop=function(){f.unloop()}}function h(a){a.instances=1,g.call(this,a)}var a=4,b={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",webm:"audio/webm",m4a:"audio/x-m4a"},c=function(){return"Audio"in window?window.Audio:function(){return document.createElement("audio")}}(),e=function(a,d,e,f,g){var h=new c,i=!1,j=[];h.autobuffer=!0,h.preload="auto",h.addEventListener("error",function(){g(h.error)},!1),h.addEventListener("canplaythrough",function(){if(i)return;while(e--)j.push(h.cloneNode(!0));i=!0,f()},!1);var k=function(a){return a.split(".").pop()},l=function(a){var c=document.createElement("source");c.src=a,b[k(a)]&&(c.type=b[k(a)]),h.appendChild(c)};d&&d.length>0?d.forEach(function(b){l(a+"."+b)}):l(a),this.getInstance=function(){var a,b,c;for(c=0,b=j.length;c<b;c++){a=j[c];if(a.paused||a.ended)return a.ended&&(a.currentTime=0),a}return j.length===0?null:(a=j[0],a.pause(),a.currentTime=0,a)};var m=function(){h.currentTime=0,h.play()};this.loop=function(){h.loop=!0,h.addEventListener("ended",m,!1),h.play()},this.unloop=function(){if(!h.loop)return;h.pause(),h.removeAttribute("loop"),h.removeEventListener("ended",m,!1);try{h.currentTime=0}catch(a){console.log("AUDIO PROBLEM: "+a)}}};return window.cordovaDetect&&(e=function(a,b,c,d,e){var f=[],g=[];a="/android_asset/www/"+a,b&&b.length>0&&(a+="."+b[0]),this.getInstance=function(){var b,d,e;for(e=0,d=f.length;e<d;e++){b=f[e];if(g[e])return b.seekTo(0),g[e]=!1,b}return d<c?(f[d]=b=new Media(a,function(){g[d]=!0}),g[d]=!1,b):f.length===0?null:(b=f[0],b.seekTo(0),b)};var h=null;this.loop=function(){var b;h&&this.unloop();var c=function(){if(h===null||h.id!==b.id)return;b.seekTo(0),b.play()};h=b=new Media(a,c),h.play()},this.unloop=function(){var a=h;h=null,a&&(a.stop(),a.release())},d()}),g.load=function(a){f(g,a)},h.load=function(a){f(h,a)},{Effect:g,Track:h}}),define("src/lzw",[],function(){function d(a){return unescape(encodeURIComponent(a))}function e(a){return decodeURIComponent(escape(a))}function f(e,f){var g={},h=e+"",i=[],j,k=h.charAt(0),l=a+1,m;for(m=1;m<h.length;m++)j=h.charAt(m),g.hasOwnProperty(k+j)?k+=j:(i.push(k.length>1?g[k]:k),l<b&&(g[k+j]=String.fromCharCode(l),l++,l===55296&&(l=57344)),l===b&&c&&(i.push(String.fromCharCode(a)),g={},l=a+1),k=j);i.push(k.length>1?g[k]:k);var n=i.join("");return f&&(n=d(n)),n}function g(c,d){var f=c+"";d&&(f=e(f));var g={},h=f.charAt(0),i=h,j=[h],k=a+1,l,m;for(m=1;m<f.length;m++){var n=f.charCodeAt(m);if(n<a)l=f.charAt(m);else{if(n===a){g={},k=a+1,h=i=f.charAt(++m),j.push(h);continue}l=g[n]?g[n]:i+h}j.push(l),h=l.charAt(0),k<b&&(g[k]=i+h,k++,k===55296&&(k=57344)),i=l}return j.join("")}var a=128,b=65536,c=!0;return{encode:f,decode:g}}),define("src/sync",["./drawing","./lzw","./lawnchair/lawnchair"],function(a,b,c){var d=!1,e="top",f={},g=function(a,b,c,d){a.exists(b,function(e){e?a.get(b,d):d(c)})},h=function(a,b){c({name:"drawing_index"},function(){var c=this;c.save({key:a.uuid,ctime:a.ctime,mtime:Date.now()},function(){b.call(a)})})},i=function(a,b){c({name:"drawing_index"},function(){var c=this;c.remove(a,b)})};return f.list=function(a){c({name:"drawing_index"},function(){var b=this;b.all(function(b){b.sort(function(a,b){return a.ctime-b.ctime}),a(b.map(function(a){return a.key}))})})},f["delete"]=function(a,b){i(a,function(){c({name:"drawing."+a},function(){this.nuke(b,!0)})})},f.load=function(d,f){var g=function(c){c.get(e,function(d){var e,g=0,h=[],i=function(e){c.get(""+e,function(c){h[e]=JSON.parse(b.decode(c.data)),g++,g===d.data.nChunks&&a.fromChunks(d.data,h,f)})};for(e=0;e<d.data.nChunks;e++)i(e)})};c({name:"drawing."+d},function(){g(this)})},f.exists=function(a,b){var d=function(a){a.exists(e,b)};c({name:"drawing."+a},function(){d(this)})},f.save=function(a,f,i){console.assert(a.uuid);var j=function(c){var i=a.toJSON("use chunks"),j=function(){d&&console.log("writing",a.uuid),c.save({key:e,data:i},function(){h(a,f)})},k=i.nChunks,l=function(){k--,k<0?j():g(c,""+k,null,function(e){e&&e.uuid===a.chunks[k].uuid?j():(d&&console.log("writing",k),c.save({key:""+k,uuid:a.chunks[k].uuid,data:b.encode(JSON.stringify(a.chunks[k]))},l))})};l()};c({name:"drawing."+a.uuid},function(){var a=function(){j(this)}.bind(this);i?this.nuke(a):a()})},f}),define("src/gallery",["domReady!","./compat","./sync"],function(a,b,c){var d=function(){this.domElement=a.createElement("div"),this.domElement.classList.add("gallery"),c.list(this._populate.bind(this))};return d.prototype={},d.prototype._populate=function(b){var c=function(b){var c=a.createElement("a");c.href="#",c.textContent=b,c.addEventListener("click",function(a){a.preventDefault(),this._callback(b)}.bind(this)),this.domElement.appendChild(c)}.bind(this);b.forEach(c),c("new")},d.prototype.wait=function(a){this._callback=a},d.abort=function(){var b=a.querySelectorAll("div.gallery"),c;for(c=0;c<b.length;c++)b[c].parentElement.removeChild(b[c])},d}),define("lib/BlobBuilder",[],function(){var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder||function(a){var b=function(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]},c=function(){this.data=[]},d=function(a,b,c){this.data=a,this.size=a.length,this.type=b,this.encoding=c},e=c.prototype,f=d.prototype,g=a.FileReaderSync,h=function(a){this.code=this[this.name=a]},i="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),j=i.length,k=a.URL||a.webkitURL||a,l=k.createObjectURL,m=k.revokeObjectURL,n=k,o=a.btoa,p=a.atob,q=!1,r=function(a){q=!a},s=a.ArrayBuffer,t=a.Uint8Array;c.fake=f.fake=!0;while(j--)h.prototype[i[j]]=j+1;try{t&&r.apply(0,new t(1))}catch(u){}return k.createObjectURL||(n=a.URL={}),n.createObjectURL=function(a){var b=a.type,c;b===null&&(b="application/octet-stream");if(a instanceof d)return c="data:"+b,a.encoding==="base64"?c+";base64,"+a.data:a.encoding==="URI"?c+","+decodeURIComponent(a.data):o?c+";base64,"+o(a.data):c+","+encodeURIComponent(a.data);if(real_create_object_url)return real_create_object_url.call(k,a)},n.revokeObjectURL=function(a){a.substring(0,5)!=="data:"&&real_revoke_object_url&&real_revoke_object_url.call(k,a)},e.append=function(a){var c=this.data;if(t&&a instanceof s)if(q)c.push(String.fromCharCode.apply(String,new t(a)));else{var e="",f=new t(a),i=0,j=f.length;for(;i<j;i++)e+=String.fromCharCode(f[i])}else if(b(a)==="Blob"||b(a)==="File"){if(!g)throw new h("NOT_READABLE_ERR");var k=new g;c.push(k.readAsBinaryString(a))}else a instanceof d?a.encoding==="base64"&&p?c.push(p(a.data)):a.encoding==="URI"?c.push(decodeURIComponent(a.data)):a.encoding==="raw"&&c.push(a.data):(typeof a!="string"&&(a+=""),c.push(unescape(encodeURIComponent(a))))},e.getBlob=function(a){return arguments.length||(a=null),new d(this.data.join(""),a,"raw")},e.toString=function(){return"[object BlobBuilder]"},f.slice=function(a,b,c){var e=arguments.length;return e<3&&(c=null),new d(this.data.slice(a,e>1?b:this.data.length),c,this.encoding)},f.toString=function(){return"[object Blob]"},c}(self);return a}),define("lib/FileSaver",[],function(){var a=window,b=a.document,c=function(){return a.URL||a.webkitURL||a},d=a.URL||a.webkitURL||a,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),f="download"in e,g=function(c){var d=b.createEvent("MouseEvents");return d.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(d)},h=a.webkitRequestFileSystem,i=a.requestFileSystem||h||a.mozRequestFileSystem,j=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},k="application/octet-stream",l=0,m=[],n=function(){var a=m.length;while(a--){var b=m[a];typeof b=="string"?d.revokeObjectURL(b):b.remove()}m.length=0},o=function(a,b,c){b=[].concat(b);var d=b.length;while(d--){var e=a["on"+b[d]];if(typeof e=="function")try{e.call(a,c||a)}catch(f){j(f)}}},p=function(b,d){var j=this,n=b.type,p=!1,q,r,s=function(){var a=c().createObjectURL(b);return m.push(a),a},t=function(){o(j,"writestart progress write writeend".split(" "))},u=function(){if(p||!q)q=s(b);r.location.href=q,j.readyState=j.DONE,t()},v=function(a){return function(){if(j.readyState!==j.DONE)return a.apply(this,arguments)}},w={create:!0,exclusive:!1},x;j.readyState=j.INIT,d||(d="download");if(f){q=s(b),e.href=q,e.download=d;if(g(e)){j.readyState=j.DONE,t();return}}a.chrome&&n&&n!==k&&(x=b.slice||b.webkitSlice,b=x.call(b,0,b.size,k),p=!0),h&&d!=="download"&&(d+=".download"),n===k||h?r=a:(r=a.open(),r||(r=a.parent));if(!i){u();return}l+=b.size,i(a.TEMPORARY,l,v(function(a){a.root.getDirectory("saved",w,v(function(a){var c=function(){a.getFile(d,w,v(function(a){a.createWriter(v(function(c){c.onwriteend=function(b){r.location.href=a.toURL(),m.push(a),j.readyState=j.DONE,o(j,"writeend",b)},c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&u()},"writestart progress write abort".split(" ").forEach(function(a){c["on"+a]=j["on"+a]}),c.write(b),j.abort=function(){c.abort(),j.readyState=j.DONE},j.readyState=j.WRITING}),u)}),u)};a.getFile(d,{create:!1},v(function(a){a.remove(),c()}),v(function(a){a.code===a.NOT_FOUND_ERR?c():u()}))}),u)}),u)},q=p.prototype,r=function(a,b){return new p(a,b)};return q.abort=function(){var a=this;a.readyState=a.DONE,o(a,"abort")},q.readyState=q.INIT=0,q.WRITING=1,q.DONE=2,q.error=q.onwritestart=q.onprogress=q.onwrite=q.onabort=q.onerror=q.onwriteend=null,a.addEventListener("unload",n,!1),r}),define("propertyParser",[],function(){function c(b){var c,e={};while(c=a.exec(b))e[c[1]]=d(c[2]||c[3]);return e}function d(a){return b.test(a)?a=a.replace(b,"$1").split(","):a==="null"?a=null:a==="false"?a=!1:a==="true"?a=!0:a===""||a==="''"||a==='""'?a="":isNaN(a)||(a=+a),a}var a=/([\w-]+)\s*:\s*(?:(\[[^\]]+\])|([^,]+)),?/g,b=/^\[([^\]]+)\]$/;return{parseProperties:c,typecastVal:d}}),define("webfont",[],function(){return function(a,b,c,d){function i(a){return function(){return this[a]}}function k(a,b,c){var d=2<arguments.length?Array.prototype.slice.call(arguments,2):[];return function(){return d.push.apply(d,arguments),b.apply(a,d)}}function l(a){this.F=a,this.U=e}function m(a,c,d){a=a.F.getElementsByTagName(c)[0],a||(a=b.documentElement),a&&a.lastChild&&a.insertBefore(d,a.lastChild)}function n(a){function c(){b.body?a():setTimeout(c,0)}c()}function o(a){a.parentNode&&a.parentNode.removeChild(a)}function p(a,b){return a.createElement("link",{rel:"stylesheet",href:b})}function q(a,b){return a.createElement("script",{src:b})}function r(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return;c.push(b),a.className=c.join(" ").replace(/^\s+/,"")}function s(a,b){for(var c=a.className.split(/\s+/),d=[],e=0,f=c.length;e<f;e++)c[e]!=b&&d.push(c[e]);a.className=d.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}function t(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return f;return h}function u(a,b,c){if(a.U===e){var d=a.F.createElement("p");d.innerHTML='<a style="top:1px;">w</a>',a.U=/top/.test(d.getElementsByTagName("a")[0].getAttribute("style"))}a.U?b.setAttribute("style",c):b.style.cssText=c}function v(a,b,c,d,e,f,g,h){this.za=a,this.Fa=b,this.na=c,this.ma=d,this.Ca=e,this.Ba=f,this.la=g,this.Ga=h}function w(a,b){this.a=a,this.k=b}function y(a){var b=B(a.a,/(iPod|iPad|iPhone|Android)/,1);return""!=b?b:(a=B(a.a,/(Linux|Mac_PowerPC|Macintosh|Windows)/,1),""!=a?("Mac_PowerPC"==a&&(a="Macintosh"),a):"Unknown")}function z(a){var b=B(a.a,/(OS X|Windows NT|Android) ([^;)]+)/,2);return b||(b=B(a.a,/(iPhone )?OS ([\d_]+)/,2))?b:(a=B(a.a,/Linux ([i\d]+)/,1))?a:"Unknown"}function A(a){return a=B(a,/(\d+)/,1),""!=a?parseInt(a,10):-1}function B(a,b,c){return(a=a.match(b))&&a[c]?a[c]:""}function C(a){if(a.documentMode)return a.documentMode}function D(a,b,c){this.c=a,this.g=b,this.V=c,this.j="wf",this.h=new T("-")}function E(a){r(a.g,a.h.e(a.j,"loading")),G(a,"loading")}function F(a){s(a.g,a.h.e(a.j,"loading")),t(a.g,a.h.e(a.j,"active"))||r(a.g,a.h.e(a.j,"inactive")),G(a,"inactive")}function G(a,b,c,d){a.V[b]&&a.V[b](c,d)}function H(){this.ea={}}function I(a,b){var c=[],d;for(d in b)if(b.hasOwnProperty(d)){var e=a.ea[d];e&&c.push(e(b[d]))}return c}function J(a,b,c,d,e){this.c=a,this.A=b,this.n=c,this.u=d,this.D=e,this.L=0,this.ia=this.da=h}function K(a){0==--a.L&&a.da&&(a.ia?(a=a.A,s(a.g,a.h.e(a.j,"loading")),s(a.g,a.h.e(a.j,"inactive")),r(a.g,a.h.e(a.j,"active")),G(a,"active")):F(a.A))}function L(a,b,c,d,e,f,g,h,i){this.I=a,this.Z=b,this.c=c,this.n=d,this.u=e,this.D=f,this.ya=new U,this.v=new V,this.M=g,this.B=h,this.qa=i||"BESbswy",this.P=O(this,"arial,'URW Gothic L',sans-serif"),this.Q=O(this,"Georgia,'Century Schoolbook L',serif"),this.ba=this.P,this.ca=this.Q,this.R=P(this,"arial,'URW Gothic L',sans-serif"),this.S=P(this,"Georgia,'Century Schoolbook L',serif")}function M(a){a.u(function(a,b){return function(){b.call(a)}}(a,a.K),25)}function N(a,b){o(a.R),o(a.S),b(a.M,a.B)}function O(a,b){var c=P(a,b,f),d=a.n.p(c);return o(c),d}function P(a,b,c){return b=a.c.createElement("span",{style:Q(a,b,a.B,c)},a.qa),m(a.c,"body",b),b}function Q(a,b,c,d){return c=a.v.expand(c),"position:absolute;top:-999px;left:-999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;font-family:"+(d?"":a.ya.quote(a.M)+",")+b+";"+c}function R(a,b,c,d,e){this.c=a,this.W=b,this.g=c,this.u=d,this.a=e,this.N=this.O=0}function S(a,b,c){c=I(a.W,c),a.N=a.O=c.length;for(var d=new J(a.c,b,{p:function(a){return a.offsetWidth}},a.u,function(){return(new Date).getTime()}),e=0,f=c.length;e<f;e++){var g=c[e];g.z(a.a,k(a,a.wa,g,b,d))}}function T(a){this.xa=a||"-"}function U(){this.ga="'"}function V(){this.H=W,this.o=X}function Y(a,b,c){this.$=a,this.Da=b,this.o=c}function Z(a,b){this.c=a,this.d=b}function $(a,b,c,d,e,g,i,j,k){$.Ea.call(this,a,b,c,d,e,g,i,j,k),a="Times New Roman,Lucida Sans Unicode,Courier New,Tahoma,Arial,Microsoft Sans Serif,Times,Lucida Console,Sans,Serif,Monospace".split(","),b=a.length,c={},d=P(this,a[0],f),c[this.n.p(d)]=f;for(e=1;e<b;e++)g=a[e],u(this.c,d,Q(this,g,this.B,f)),c[this.n.p(d)]=f,"4"!=this.B[1]&&(u(this.c,d,Q(this,g,this.B[0]+"4",f)),c[this.n.p(d)]=f);o(d),this.t=c,this.ka=h}function ba(b){this.J=b?b:("https:"==a.location.protocol?"https:":"http:")+bb,this.f=[],this.T=[]}function bc(a){this.f=a,this.fa=[],this.ja={},this.G={},this.v=new V}function bf(a,b,c){this.a=a,this.c=b,this.d=c}function bg(a,b){this.c=a,this.d=b}function bi(a,b,c){this.m=a,this.c=b,this.d=c,this.f=[],this.s={},this.v=new V}function bj(a,b,c,d,e){this.m=a,this.a=b,this.c=c,this.k=d,this.d=e,this.f=[],this.s={}}function bk(a,b,c){this.m=a,this.c=b,this.d=c,this.f=[],this.s={}}if(!b)return;var e=void 0,f=!0,g=null,h=!1,j;l.prototype.createElement=function(a,b,c){a=this.F.createElement(a);if(b)for(var d in b)b.hasOwnProperty(d)&&("style"==d?u(this,a,b[d]):a.setAttribute(d,b[d]));return c&&a.appendChild(this.F.createTextNode(c)),a},j=v.prototype,j.getName=i("za"),j.va=i("Fa"),j.X=i("na"),j.sa=i("ma"),j.ta=i("Ca"),j.ua=i("Ba"),j.ra=i("la"),j.w=i("Ga");var x=new v("Unknown","Unknown","Unknown","Unknown","Unknown","Unknown",e,h);w.prototype.parse=function(){var a;if(-1!=this.a.indexOf("MSIE"))if(a=B(this.a,/(MSIE [\d\w\.]+)/,1),""!=a){var b=a.split(" ");a=b[0],b=b[1],a=new v(a,b,a,b,y(this),z(this),C(this.k),6<=A(b))}else a=new v("MSIE","Unknown","MSIE","Unknown",y(this),z(this),C(this.k),h);else if(-1!=this.a.indexOf("Opera"))a:{var b=a="Unknown",c=B(this.a,/(Presto\/[\d\w\.]+)/,1);""!=c?(b=c.split("/"),a=b[0],b=b[1]):(-1!=this.a.indexOf("Gecko")&&(a="Gecko"),c=B(this.a,/rv:([^\)]+)/,1),""!=c&&(b=c));if(-1!=this.a.indexOf("Version/")&&(c=B(this.a,/Version\/([\d\.]+)/,1),""!=c)){a=new v("Opera",c,a,b,y(this),z(this),C(this.k),10<=A(c));break a}c=B(this.a,/Opera[\/ ]([\d\.]+)/,1),a=""!=c?new v("Opera",c,a,b,y(this),z(this),C(this.k),10<=A(c)):new v("Opera","Unknown",a,b,y(this),z(this),C(this.k),h)}else if(-1!=this.a.indexOf("AppleWebKit")){a=y(this),b=z(this),c=B(this.a,/AppleWebKit\/([\d\.\+]+)/,1),""==c&&(c="Unknown");var d="Unknown";-1!=this.a.indexOf("Chrome")||-1!=this.a.indexOf("CrMo")?d="Chrome":-1!=this.a.indexOf("Safari")?d="Safari":-1!=this.a.indexOf("AdobeAIR")&&(d="AdobeAIR");var e="Unknown";-1!=this.a.indexOf("Version/")?e=B(this.a,/Version\/([\d\.\w]+)/,1):"Chrome"==d?e=B(this.a,/(Chrome|CrMo)\/([\d\.]+)/,2):"AdobeAIR"==d&&(e=B(this.a,/AdobeAIR\/([\d\.]+)/,1));var f=h;"AdobeAIR"==d?(f=B(e,/\d+\.(\d+)/,1),f=2<A(e)||2==A(e)&&5<=parseInt(f,10)):(f=B(c,/\d+\.(\d+)/,1),f=526<=A(c)||525<=A(c)&&13<=parseInt(f,10)),a=new v(d,e,"AppleWebKit",c,a,b,C(this.k),f)}else-1!=this.a.indexOf("Gecko")?(b=a="Unknown",d=h,-1!=this.a.indexOf("Firefox")?(a="Firefox",c=B(this.a,/Firefox\/([\d\w\.]+)/,1),""!=c&&(d=B(c,/\d+\.(\d+)/,1),b=c,d=""!=c&&3<=A(c)&&5<=parseInt(d,10))):-1!=this.a.indexOf("Mozilla")&&(a="Mozilla"),c=B(this.a,/rv:([^\)]+)/,1),""==c?c="Unknown":d||(d=A(c),e=parseInt(B(c,/\d+\.(\d+)/,1),10),f=parseInt(B(c,/\d+\.\d+\.(\d+)/,1),10),d=1<d||1==d&&9<e||1==d&&9==e&&2<=f||c.match(/1\.9\.1b[123]/)!=g||c.match(/1\.9\.1\.[\d\.]+/)!=g),a=new v(a,b,"Gecko",c,y(this),z(this),C(this.k),d)):a=x;return a},J.prototype.watch=function(a,b,c,d,e){for(var f=a.length,g=0;g<f;g++){var h=a[g];b[h]||(b[h]=["n4"]),this.L+=b[h].length}e&&(this.da=e);for(g=0;g<f;g++)for(var h=a[g],e=b[h],i=c[h],j=0,l=e.length;j<l;j++){var m=e[j],n=this.A,o=h,p=m;r(n.g,n.h.e(n.j,o,p,"loading")),G(n,"fontloading",o,p),n=k(this,this.oa),o=k(this,this.pa),(new d(n,o,this.c,this.n,this.u,this.D,h,m,i)).start()}},J.prototype.oa=function(a,b){var c=this.A;s(c.g,c.h.e(c.j,a,b,"loading")),s(c.g,c.h.e(c.j,a,b,"inactive")),r(c.g,c.h.e(c.j,a,b,"active")),G(c,"fontactive",a,b),this.ia=f,K(this)},J.prototype.pa=function(a,b){var c=this.A;s(c.g,c.h.e(c.j,a,b,"loading")),t(c.g,c.h.e(c.j,a,b,"active"))||r(c.g,c.h.e(c.j,a,b,"inactive")),G(c,"fontinactive",a,b),K(this)},L.prototype.start=function(){this.ha=this.D(),this.K()},L.prototype.K=function(){var a=this.n.p(this.R),b=this.n.p(this.S);this.P==a&&this.Q==b||this.ba!=a||this.ca!=b?5e3<=this.D()-this.ha?N(this,this.Z):(this.ba=a,this.ca=b,M(this)):N(this,this.I)},R.prototype.q=function(a,b){this.W.ea[a]=b},R.prototype.load=function(a){var b=new D(this.c,this.g,a);this.a.w()?S(this,b,a):F(b)},R.prototype.wa=function(a,b,c,d){var e=a.Y?a.Y():L;d?a.load(k(this,this.Aa,b,c,e)):(a=0==--this.O,this.N--,a&&(0==this.N?F(b):E(b)),c.watch([],{},{},e,a))},R.prototype.Aa=function(a,b,c,d,e,f){var g=0==--this.O;g&&E(a),this.u(k(this,function(a,b,c,d,e,f){a.watch(b,c||{},d||{},e,f)},b,d,e,f,c,g))},T.prototype.e=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.xa)},U.prototype.quote=function(a){for(var b=[],a=a.split(/,\s*/),c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");-1==d.indexOf(" ")?b.push(d):b.push(this.ga+d+this.ga)}return b.join(",")};var W=["font-style","font-weight"],X={"font-style":[["n","normal"],["i","italic"],["o","oblique"]],"font-weight":[["1","100"],["2","200"],["3","300"],["4","400"],["5","500"],["6","600"],["7","700"],["8","800"],["9","900"],["4","normal"],["7","bold"]]};Y.prototype.compact=function(a,b){for(var c=0;c<this.o.length;c++)if(b==this.o[c][1]){a[this.$]=this.o[c][0];break}},Y.prototype.expand=function(a,b){for(var c=0;c<this.o.length;c++)if(b==this.o[c][0]){a[this.$]=this.Da+":"+this.o[c][1];break}},V.prototype.compact=function(a){for(var b=["n","4"],a=a.split(";"),c=0,d=a.length;c<d;c++){var e=a[c].replace(/\s+/g,"").split(":");if(2==e.length){var f=e[1];a:{for(var e=e[0],h=0;h<this.H.length;h++)if(e==this.H[h]){e=new Y(h,e,this.o[e]);break a}e=g}e&&e.compact(b,f)}}return b.join("")},V.prototype.expand=function(a){if(2!=a.length)return g;for(var b=[g,g],c=0,d=this.H.length;c<d;c++){var e=this.H[c];(new Y(c,e,this.o[e])).expand(b,a.substr(c,1))}return b[0]&&b[1]?b.join(";")+";":g},a.WebFont=function(){var a=(new w(c.userAgent,b)).parse();return new R(new l(b),new H,b.documentElement,function(a,b){setTimeout(a,b)},a)}(),a.WebFont.load=a.WebFont.load,a.WebFont.addModule=a.WebFont.q,v.prototype.getName=v.prototype.getName,v.prototype.getVersion=v.prototype.va,v.prototype.getEngine=v.prototype.X,v.prototype.getEngineVersion=v.prototype.sa,v.prototype.getPlatform=v.prototype.ta,v.prototype.getPlatformVersion=v.prototype.ua,v.prototype.getDocumentMode=v.prototype.ra,v.prototype.isSupportingWebFont=v.prototype.w,Z.prototype.load=function(a){for(var b=this.d.urls||[],c=this.d.families||[],d=0,e=b.length;d<e;d++)m(this.c,"head",p(this.c,b[d]));a(c)},Z.prototype.z=function(a,b){return b(a.w())},a.WebFont.q("custom",function(a){return new Z(new l(b),a)}),function(a,b){function c(){}c.prototype=a.prototype,b.prototype=new c,b.Ea=a,b.Ha=a.prototype}(L,$);var _={Arimo:f,Cousine:f,Tinos:f};$.prototype.K=function(){var a=this.n.p(this.R),b=this.n.p(this.S);!this.ka&&a==b&&this.t[a]&&(this.t={},this.ka=this.t[a]=f),(this.P!=a||this.Q!=b)&&!this.t[a]&&!this.t[b]?N(this,this.I):5e3<=this.D()-this.ha?this.t[a]&&this.t[b]&&_[this.M]?N(this,this.I):N(this,this.Z):M(this)};var bb="//fonts.googleapis.com/css";ba.prototype.e=function(){if(0==this.f.length)throw Error("No fonts to load !");if(-1!=this.J.indexOf("kit="))return this.J;for(var a=this.f.length,b=[],c=0;c<a;c++)b.push(this.f[c].replace(/ /g,"+"));return a=this.J+"?family="+b.join("%7C"),0<this.T.length&&(a+="&subset="+this.T.join(",")),a};var bd={ultralight:"n2",light:"n3",regular:"n4",bold:"n7",italic:"i4",bolditalic:"i7",ul:"n2",l:"n3",r:"n4",b:"n7",i:"i4",bi:"i7"},be={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"};bc.prototype.parse=function(){for(var a=this.f.length,b=0;b<a;b++){var c=this.f[b].split(":"),d=c[0].replace(/\+/g," "),e=["n4"];if(2<=c.length){var f,h=c[1];f=[];if(h)for(var h=h.split(","),i=h.length,j=0;j<i;j++){var k;k=h[j];if(k.match(/^[\w ]+$/)){var l=bd[k];l?k=l:(l=k.match(/^(\d*)(\w*)$/),k=l[1],l=l[2],k=(k=this.v.expand([l?l:"n",k?k.substr(0,1):"4"].join("")))?this.v.compact(k):g)}else k="";k&&f.push(k)}0<f.length&&(e=f),3==c.length&&(c=c[2],f=[],c=c?c.split(","):f,0<c.length&&(c=be[c[0]])&&(this.G[d]=c))}this.G[d]||(c=be[d])&&(this.G[d]=c),this.fa.push(d),this.ja[d]=e}},bf.prototype.z=function(a,b){b(a.w())},bf.prototype.Y=function(){return"AppleWebKit"==this.a.X()?$:L},bf.prototype.load=function(a){"MSIE"==this.a.getName()&&this.d.blocking!=f?n(k(this,this.aa,a)):this.aa(a)},bf.prototype.aa=function(a){for(var b=this.c,c=new ba(this.d.api),d=this.d.families,e=d.length,f=0;f<e;f++){var g=d[f].split(":");3==g.length&&c.T.push(g.pop()),c.f.push(g.join(":"))}d=new bc(d),d.parse(),m(b,"head",p(b,c.e())),a(d.fa,d.ja,d.G)},a.WebFont.q("google",function(a){var d=(new w(c.userAgent,b)).parse();return new bf(d,new l(b),a)});var bh={regular:"n4",bold:"n7",italic:"i4",bolditalic:"i7",r:"n4",b:"n7",i:"i4",bi:"i7"};return bg.prototype.z=function(a,b){return b(a.w())},bg.prototype.load=function(a){var c,d;m(this.c,"head",p(this.c,("https:"==b.location.protocol?"https:":"http:")+"//webfonts.fontslive.com/css/"+this.d.key+".css"));var f=this.d.families,g,h;g=[],h={};for(var i=0,j=f.length;i<j;i++){d=d=c=e,d=f[i].split(":"),c=d[0];if(d[1]){d=d[1].split(",");for(var k=[],l=0,n=d.length;l<n;l++){var o=d[l];if(o){var q=bh[o];k.push(q?q:o)}}d=k}else d=["n4"];g.push(c),h[c]=d}a(g,h)},a.WebFont.q("ascender",function(a){return new bg(new l(b),a)}),bi.prototype.C=function(a){return("https:"==this.m.location.protocol?"https:":"http:")+(this.d.api||"//f.fontdeck.com/s/css/js/")+this.m.document.location.hostname+"/"+a+".js"},bi.prototype.z=function(a,b){var c=this.d.id,d=this;c?(this.m.__webfontfontdeckmodule__||(this.m.__webfontfontdeckmodule__={}),this.m.__webfontfontdeckmodule__[c]=function(a,c){for(var e=0,f=c.fonts.length;e<f;++e){var g=c.fonts[e];d.f.push(g.name),d.s[g.name]=[d.v.compact("font-weight:"+g.weight+";font-style:"+g.style)]}b(a)},m(this.c,"head",q(this.c,this.C(c)))):b(f)},bi.prototype.load=function(a){a(this.f,this.s)},a.WebFont.q("fontdeck",function(c){return new bi(a,new l(b),c)}),bj.prototype.z=function(a,b){var c=this,d=c.d.projectId;if(d){var e=q(c.c,c.C(d));e.id="__MonotypeAPIScript__"+d,e.onreadystatechange=function(a){if("loaded"===e.readyState||"complete"===e.readyState)e.onreadystatechange=g,e.onload(a)},e.onload=function(){if(c.m["__mti_fntLst"+d]){var e=c.m["__mti_fntLst"+d]();if(e&&e.length){var f;for(f=0;f<e.length;f++)c.f.push(e[f].fontfamily)}}b(a.w())},m(this.c,"head",e)}else b(f)},bj.prototype.C=function(a){var b=this.protocol(),c=(this.d.api||"fast.fonts.com/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return b+"//"+c+"/"+a+".js"},bj.prototype.load=function(a){a(this.f,this.s)},bj.prototype.protocol=function(){var a=["http:","https:"],b=a[0];if(this.k&&this.k.location&&this.k.location.protocol)for(var c=0,c=0;c<a.length;c++)if(this.k.location.protocol===a[c])return this.k.location.protocol;return b},a.WebFont.q("monotype",function(d){var e=(new w(c.userAgent,b)).parse();return new bj(a,e,new l(b),b,d)}),bk.prototype.C=function(b){var c="https:"==a.location.protocol?"https:":"http:";return(this.d.api||c+"//use.typekit.com")+"/"+b+".js"},bk.prototype.z=function(a,b){var c=this.d.id,d=this.d,e=this;c?(this.m.__webfonttypekitmodule__||(this.m.__webfonttypekitmodule__={}),this.m.__webfonttypekitmodule__[c]=function(c){c(a,d,function(a,c,d){e.f=c,e.s=d,b(a)})},m(this.c,"head",q(this.c,this.C(c)))):b(f)},bk.prototype.load=function(a){a(this.f,this.s)},a.WebFont.q("typekit",function(c){return new bk(a,new l(b),c)}),a.WebFontConfig&&a.WebFont.load(a.WebFontConfig),a.WebFont}(typeof window=="undefined"?null:window,typeof document=="undefined"?null:document,typeof navigator=="undefined"?{}:navigator)}),define("font",["propertyParser","webfont"],function(a,b){function d(b){var d={},e=b.split("|"),f=e.length,g;while(f--)g=c.exec(e[f]),d[g[1]]=a.parseProperties(g[2]);return d}var c=/^([^,]+),([^\|]+)\|?/;return{load:function(a,c,e,f){if(f.isBuild)e(null);else{var g=d(a);g.active=function(){e(!0)},g.inactive=function(){e(!1)},b.load(g)}}}}),require.config({paths:{domReady:"../plugins/domReady",font:"../plugins/font",drw:"../plugins/drw",img:"../plugins/img",webfont:"../plugins/webfont",propertyParser:"../plugins/propertyParser",json:"../plugins/json",text:"../plugins/text"}}),define("ncolors",["require","domReady!","./src/brush","./src/brushdialog","./src/color","./src/compat","./src/dom","./src/drawcommand","./src/drawing","./src/layer","./src/gallery","./lib/hammer","./src/postmessage","./src/prandom!","./src/recog","./src/sound","./src/sync","./lib/BlobBuilder","./lib/FileSaver","font!custom,families:[Delius,DejaVu LGC Sans Book],urls:[fonts/style.css]"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=typeof MessageChannel!="undefined",u=null,v=750,w=1e3/30,x=!0,y=25;/(iPhone|iPad).*Safari/.test(navigator.userAgent)&&(y=0),window.parent.document.body.classList.contains("dev")?b.body.classList.add("dev"):x=!1,g.insertMeta(b);var z=b.getElementById("drawing"),A=new i;A.placeholder=!0,A.attachToContainer(z);var B=new l(z,{prevent_default:!0,drag_min_distance:2}),C=new d(b.getElementById("brushdialog"),!0),D,E,F,G,H,I=null,J=function(){I&&(clearTimeout(I),I=null)},K=function(){A.commands.recog=A.commands.end,J()},L=function(){I=null,K()},M=function(){I&&clearTimeout(I),I=setTimeout(L,v)},N=function(){};x&&(N=function(){var a=b.getElementById("framerate"),c=a.children[0],d=[Date.now()];return a.style.display="block",function(){d.push(Date.now());while(d.length>20)d.shift();var a=(d[d.length-1]-d[0])/(d.length-1),b=1e3/a;c.textContent=Math.round(b)}}());var O=!1,P=0,Q={isPlaying:!1,lastFrameTime:0,speed:P},R=function(){if(!Q.isPlaying)return;Q.speed=P,K()},S=function(){Q.isPlaying||(Q.lastFrameTime=Date.now(),Q.speed=4),A.setCmdPos(i.START),E(),D()},T=function(){console.assert(A.commands.last!==A.commands.end),console.assert(O);var a=Date.now(),b;N();if(Q.speed===P)b=A.setCmdPos(i.END,w);else{var c=a-Q.lastFrameTime;c=Math.min(100,c),b=A.setCmdTime(c*Q.speed,w)}Q.lastFrameTime=a,b?(Q.isPlaying||(Q.isPlaying=!0,u.postMessage(JSON.stringify({type:"playing"})),A.checkpointOften=!1),f.requestAnimationFrame(T)):(Q.isPlaying&&(Q.isPlaying=!1,Q.speed=P,u.postMessage(JSON.stringify({type:"stopped"})),A.checkpointOften=!0,A.addCheckpoint(!0)),O=!1,F())};D=function(){O||(console.assert(A.commands.last!==A.commands.end),O=!0,f.requestAnimationFrame(T))};var U=!1,V={x:null,y:null,time:0};B.ondrag=function(a){R(),U||(A.addCmd(h.create_draw_start(A.layers.current)),V.x=V.y=null,V.time=0),U=!0;if(a.position.x===V.x&&a.position.y===V.y)return;var b=Date.now();if(b-V.time<y)return;V.x=a.position.x,V.y=a.position.y,V.time=b,A.addCmd(h.create_draw(a.position)),D(),J()},B.ondragend=function(a){U=!1,A.addCmd(h.create_draw_end()),D(),a&&o.attemptRecognition(A.commands,A.commands.recog,A.commands.end),M(),H()};var W={};["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"].forEach(function(a,b){var c=null;/(iPhone|iPad).*Safari/.test(navigator.userAgent)||(c=new p.Effect({url:"audio/"+a,instances:1,formats:["webm"]})),W[a]=c});var X=null;E=function(){X&&(z.removeChild(X),X=null)};var Y=function(a,c,d){if(c<400){E();return}var e=a.charAt(0),f=window.devicePixelRatio||1,g=d.br.x-d.tl.x,h=d.br.y-d.tl.y;g+=A.brush.size,h+=A.brush.size;var i=b.createElement("canvas");i.style.border="1px dashed #ccc",i.style.position="absolute",i.style.top=d.tl.y-A.brush.size/2+"px",i.style.left=d.tl.x-A.brush.size/2+"px",i.style.width=g+"px",i.style.height=h+"px",i.style.opacity=.3,i.width=g*f,i.height=h*f;var j=i.getContext("2d");j.font=i.height*1.2+"px Delius, sans-serif",j.textAlign="center",j.textBaseline="middle",j.fillStyle=A.brush.color.to_string().replace(/..$/,""),j.translate(i.width/2,i.height/2);var k=j.measureText(e);k.width<i.width&&j.scale(i.width/k.width,1),j.fillText(a.charAt(0),0,0,i.width),E(),X=i,z.appendChild(X);var l=W[e.toUpperCase()];if(l)try{l.play()}catch(m){/(iPhone|iPad).*Safari/.test(navigator.userAgent)||console.log("Unexpected problem playing audio.",m)}};o.registerCallback(Y);var Z=function(a,b){var c={type:"color",red:a.red,green:a.green,blue:a.blue,opacity:b};u.postMessage(JSON.stringify(c))};F=function(){var a=new c,b=!0;return function(){if(a.equals(A.brush)&&!b)return;a.set_from_brush(A.brush),b=!1,Z(A.brush.color,A.brush.opacity);var c={type:"brush",brush_type:A.brush.type,size:A.brush.size,opacity:A.brush.opacity,spacing:A.brush.spacing};u.postMessage(JSON.stringify(c)),C.isOpen()&&C.updateBrush(A.brush,!0)}}(),C.colorCallback=function(a){Z(a.rgbaColor(),a.opacity/255)};var $=null;b.querySelector("#mask").addEventListener("click",function(a){a.preventDefault(),$&&$()});var _=function(a){var c=A.commands.last===A.commands.end;b.body.classList.remove("mask"),$=null,u.postMessage(JSON.stringify({type:"toolbar-mode-switch",mode:"drawing"}));if(c&&a.equals(A.brush))return;var d={},f=!1;["type","size","opacity","spacing"].forEach(function(b){if(a[b]===A.brush[b])return;d[b==="type"?"brush_type":b]=a[b],f=!0}),f&&A.addCmd(h.create_brush_change(d)),e.equal(A.brush.color,a.color)||A.addCmd(h.create_color_change(a.color)),c&&(A.setCmdPos(i.END),F())},ba=function(a){C.isOpen()?C.currentPane()!==a?C.switchPane(a):C.close(!0):(C.open(A.brush,a,_),b.body.classList.add("mask"),$=function(){C.close(!0)},u.postMessage(JSON.stringify({type:"toolbar-mode-switch",mode:"brushdialog"})))},bb=function(){console.assert(!U);var a=A.undo(w);a?D():F(),K(),H()},bc=function(){console.assert(!U);var a=A.redo(w);a?D():F(),K(),H()},bd=function(){var a=JSON.stringify(A,null,1),b,c;try{b=new window.Blob([a],{type:"text/plain;charset=ascii"})}catch(d){var e=new r;e.append(a),b=e.getBlob("text/plain;charset=ascii")}s(b,"drawing.json")},be=function(){console.log("saving",A.uuid),q.save(A,function(){console.log("saved!",A.uuid),q.load(A.uuid,function(a){console.log("loaded",a.uuid),G(a)})})};H=function(){var a=!1,b=!1;return function(){if(a){b=!0;return}a=!0,b=!0;var c=A,d=function(){b?(b=!1,q.save(c,d)):a=!1};d()}}();var bf=function(a){var b=window.innerWidth,c=window.innerHeight,d=window.devicePixelRatio||1,e=A.commands.last;A.resize(b,c,d);var f=A.setCmdPos(e,w);f&&D()};window.addEventListener("resize",bf,!1);var bg=function(a){U&&B.ondragend();var b=JSON.parse(a.data);b.type!=="playButton"&&R();var c=A.commands.last===A.commands.end;switch(b.type){case"undoButton":E(),bb();break;case"redoButton":E(),bc();break;case"swatchButton":var d=e.from_string(b.color);if(c&&e.equal(A.brush.color,d)&&A.brush.opacity===1)break;A.addCmd(h.create_color_change(d)),A.addCmd(h.create_brush_change({opacity:1})),c&&(A.setCmdPos(i.END),F());break;case"colorButton":ba("color");break;case"brushButton":ba("brush");break;case"playButton":Q.isPlaying&&Q.speed!==P?Q.speed*=4:S();break;case"saveButton":bd();break;default:console.warn("Unexpected child toolbar message",a)}},bh=function(a){var b=a.data;typeof b=="string"&&(b=JSON.parse(b));switch(b.type){case"toolbar":return u.dispatchEvent({data:b.msg});default:console.warn("Unexpected child message",a)}};window.addEventListener("message",bh,!1);var bi={type:"childReady"};if(t){var bj=new MessageChannel;u=bj.port1,u.addEventListener("message",bg,!1),u.start(),m(window.parent,JSON.stringify(bi),"*",[bj.port2])}else u={dispatchEvent:function(a){bg(a)},postMessage:function(a){var b={type:"toolbar",msg:a};m(window.parent,JSON.stringify(b),"*")}},m(window.parent,JSON.stringify(bi),"*");var bk=function(a,b,c){var d={type:"hashchange",hash:a};b&&(d.replace=!0,d.title=c),m(window.parent,JSON.stringify(d),"*")};G=function(a,c){console.assert(a.uuid),A.removeFromContainer(z),E(),J(),A=a,A.attachToContainer(z),b.location.hash!=="#"+A.uuid&&(b.location.hash="#"+A.uuid,bk(b.location.hash)),A.initial_playback_speed&&(Q.speed=A.initial_playback_speed),F(),bf(),b.getElementById("loading").style.display="none",u.postMessage(JSON.stringify({type:"toolbar-mode-switch",mode:"drawing"})),c&&H()};var bl=function(c,d){var e,f;b.getElementById("loading").style.display="block",u.postMessage(JSON.stringify({type:"toolbar-mode-switch",mode:"loading"}));switch(c){case"castle":case"intro":case"lounge":case"r":case"roger":a(["drw!samples/"+c+".json"],function(a){a.uuid=n.uuid(),window.history.replaceState&&(window.history.replaceState(null,c,"#"+a.uuid),bk("#"+a.uuid,!0,c)),d(a,!0)});break;case"":case"gallery":f=new k,f.wait(function(a){b.body.removeChild(f.domElement),bl(a,d)}),b.body.appendChild(f.domElement),u.postMessage(JSON.stringify({type:"toolbar-mode-switch",mode:"gallery"})),A.removeFromContainer(z),E(),J(),A=new i,A.placeholder=!0,A.attachToContainer(z);break;case"new":e=new i,e.uuid=n.uuid(),d(e);break;default:q.exists(c,function(a){a?q.load(c,d):(e=new i,e.uuid=c,d(e))})}},bm=function(){var a=b.location.hash.replace(/^#/,"");if(a===A.uuid)return;bk(b.location.hash,!0,a),k.abort(),bl(a,G)};window.addEventListener("hashchange",bm,!1),bl(b.location.hash.replace(/^#/,""),G)}),define("drw",["src/drawing"],function(a){return{load:function(b,c,d,e){c(["json!"+b],function(b){e.isBuild?d(null):a.fromJSON(b,function(a){d(a)})})}}}),define("json",["text"],function(text){function cacheBust(a){return a=a.replace(CACHE_BUST_FLAG,""),a+=a.indexOf("?")<0?"?":"&",a+CACHE_BUST_QUERY_PARAM+"="+Math.round(2147483647*Math.random())}var CACHE_BUST_QUERY_PARAM="bust",CACHE_BUST_FLAG="!bust",jsonParse=typeof JSON!="undefined"&&typeof JSON.parse=="function"?JSON.parse:function(val){return eval("("+val+")")},buildMap={};return{load:function(a,b,c,d){!d.isBuild||d.inlineJSON!==!1&&a.indexOf(CACHE_BUST_QUERY_PARAM+"=")===-1?text.get(b.toUrl(a),function(b){d.isBuild?(buildMap[a]=b,c(b)):c(jsonParse(b))}):c(null)},normalize:function(a,b){return a.indexOf(CACHE_BUST_FLAG)===-1?a:cacheBust(a)},write:function(a,b,c){if(b in buildMap){var d=buildMap[b];c('define("'+a+"!"+b+'", function(){ return '+d+";});\n")}}}}),define("json!samples/r.json",function(){return{initial_playback_speed:2,commands:[{type:2,color:{red:0,green:0,blue:0,alpha:255}},{type:3,brush_type:0,size:20,opacity:.2,spacing:.2},{type:4,layer:0},{type:0,pos:{x:59,y:37},time:1335453187813},{type:0,pos:{x:59,y:38},time:1335453187842},{type:0,pos:{x:59,y:40},time:1335453187874},{type:0,pos:{x:59,y:41},time:1335453187922},{type:0,pos:{x:59,y:43},time:1335453187962},{type:0,pos:{x:59,y:45},time:1335453188020},{type:0,pos:{x:59,y:46},time:1335453188070},{type:0,pos:{x:58,y:47},time:1335453188119},{type:0,pos:{x:58,y:49},time:1335453188149},{type:0,pos:{x:58,y:50},time:1335453188198},{type:0,pos:{x:58,y:51},time:1335453188248},{type:0,pos:{x:58,y:52},time:1335453188297},{type:0,pos:{x:58,y:53},time:1335453188367},{type:1},{type:4,layer:0},{type:0,pos:{x:59,y:75},time:1335453189441},{type:0,pos:{x:59,y:77},time:1335453189471},{type:0,pos:{x:59,y:79},time:1335453189500},{type:0,pos:{x:59,y:81},time:1335453189559},{type:0,pos:{x:59,y:82},time:1335453189619},{type:0,pos:{x:59,y:83},time:1335453189648},{type:0,pos:{x:58,y:86},time:1335453189698},{type:0,pos:{x:58,y:89},time:1335453189750},{type:0,pos:{x:58,y:90},time:1335453189787},{type:0,pos:{x:58,y:92},time:1335453189846},{type:0,pos:{x:58,y:95},time:1335453189888},{type:1},{type:4,layer:0},{type:0,pos:{x:58,y:121},time:1335453190717},{type:0,pos:{x:58,y:125},time:1335453190770},{type:0,pos:{x:58,y:127},time:1335453190837},{type:0,pos:{x:58,y:128},time:1335453190886},{type:0,pos:{x:58,y:129},time:1335453190936},{type:0,pos:{x:58,y:130},time:1335453190985},{type:0,pos:{x:58,y:131},time:1335453191035},{type:0,pos:{x:58,y:133},time:1335453191064},{type:0,pos:{x:58,y:134},time:1335453191104},{type:0,pos:{x:58,y:135},time:1335453191144},{type:0,pos:{x:58,y:139},time:1335453191177},{type:0,pos:{x:58,y:142},time:1335453191252},{type:0,pos:{x:58,y:144},time:1335453191302},{type:0,pos:{x:58,y:145},time:1335453191342},{type:1},{type:4,layer:0},{type:0,pos:{x:58,y:170},time:1335453192113},{type:0,pos:{x:59,y:174},time:1335453192161},{type:0,pos:{x:59,y:176},time:1335453192191},{type:0,pos:{x:59,y:180},time:1335453192225},{type:0,pos:{x:59,y:183},time:1335453192254},{type:0,pos:{x:59,y:185},time:1335453192300},{type:0,pos:{x:59,y:186},time:1335453192359},{type:0,pos:{x:60,y:186},time:1335453192389},{type:0,pos:{x:60,y:188},time:1335453192468},{type:0,pos:{x:60,y:189},time:1335453192537},{type:1},{type:4,layer:0},{type:0,pos:{x:60,y:213},time:1335453193790},{type:0,pos:{x:60,y:214},time:1335453193817},{type:0,pos:{x:60,y:216},time:1335453193857},{type:0,pos:{x:61,y:219},time:1335453193888},{type:0,pos:{x:61,y:220},time:1335453193942},{type:0,pos:{x:61,y:221},time:1335453194001},{type:0,pos:{x:61,y:222},time:1335453194051},{type:0,pos:{x:61,y:223},time:1335453194100},{type:0,pos:{x:61,y:226},time:1335453194140},{type:0,pos:{x:61,y:227},time:1335453194199},{type:0,pos:{x:61,y:229},time:1335453194258},{type:0,pos:{x:61,y:240},time:1335453194367},{type:1},{type:4,layer:0},{type:0,pos:{x:41,y:35},time:1335453196405},{type:0,pos:{x:43,y:35},time:1335453196436},{type:0,pos:{x:45,y:35},time:1335453196465},{type:0,pos:{x:46,y:35},time:1335453196504},{type:0,pos:{x:48,y:35},time:1335453196537},{type:0,pos:{x:49,y:35},time:1335453196594},{type:0,pos:{x:50,y:35},time:1335453196634},{type:0,pos:{x:51,y:35},time:1335453196667},{type:0,pos:{x:53,y:35},time:1335453196703},{type:0,pos:{x:56,y:35},time:1335453196752},{type:0,pos:{x:57,y:35},time:1335453196802},{type:0,pos:{x:60,y:35},time:1335453196851},{type:0,pos:{x:62,y:35},time:1335453196881},{type:0,pos:{x:63,y:35},time:1335453196911},{type:0,pos:{x:64,y:35},time:1335453196960},{type:0,pos:{x:65,y:35},time:1335453197e3},{type:0,pos:{x:66,y:35},time:1335453197059},{type:0,pos:{x:67,y:35},time:1335453197119},{type:0,pos:{x:68,y:35},time:1335453197168},{type:0,pos:{x:69,y:35},time:1335453197218},{type:1},{type:4,layer:0},{type:0,pos:{x:95,y:35},time:1335453197841},{type:0,pos:{x:97,y:35},time:1335453197900},{type:0,pos:{x:98,y:35},time:1335453197949},{type:0,pos:{x:99,y:35},time:1335453197999},{type:0,pos:{x:101,y:35},time:1335453198029},{type:0,pos:{x:102,y:35},time:1335453198062},{type:0,pos:{x:103,y:35},time:1335453198109},{type:0,pos:{x:104,y:35},time:1335453198159},{type:0,pos:{x:108,y:35},time:1335453198198},{type:0,pos:{x:110,y:35},time:1335453198272},{type:0,pos:{x:111,y:35},time:1335453198307},{type:0,pos:{x:112,y:35},time:1335453198356},{type:0,pos:{x:113,y:35},time:1335453198396},{type:0,pos:{x:114,y:35},time:1335453198456},{type:0,pos:{x:114,y:36},time:1335453198485},{type:0,pos:{x:116,y:36},time:1335453198516},{type:1},{type:4,layer:0},{type:0,pos:{x:138,y:45},time:1335453199232},{type:0,pos:{x:139,y:46},time:1335453199281},{type:0,pos:{x:141,y:47},time:1335453199331},{type:0,pos:{x:143,y:47},time:1335453199390},{type:0,pos:{x:144,y:48},time:1335453199440},{type:0,pos:{x:145,y:48},time:1335453199475},{type:0,pos:{x:146,y:49},time:1335453199521},{type:0,pos:{x:147,y:49},time:1335453199558},{type:0,pos:{x:148,y:50},time:1335453199620},{type:0,pos:{x:149,y:51},time:1335453199677},{type:0,pos:{x:150,y:52},time:1335453199726},{type:0,pos:{x:152,y:52},time:1335453199806},{type:1},{type:4,layer:0},{type:0,pos:{x:164,y:67},time:1335453200488},{type:0,pos:{x:164,y:68},time:1335453200513},{type:0,pos:{x:165,y:68},time:1335453200538},{type:0,pos:{x:165,y:69},time:1335453200567},{type:0,pos:{x:166,y:71},time:1335453200635},{type:0,pos:{x:167,y:72},time:1335453200675},{type:0,pos:{x:168,y:73},time:1335453200710},{type:0,pos:{x:168,y:74},time:1335453200769},{type:0,pos:{x:169,y:75},time:1335453200819},{type:0,pos:{x:169,y:76},time:1335453200878},{type:0,pos:{x:170,y:77},time:1335453200927},{type:0,pos:{x:170,y:78},time:1335453200977},{type:0,pos:{x:171,y:79},time:1335453201036},{type:0,pos:{x:171,y:80},time:1335453201096},{type:1},{type:4,layer:0},{type:0,pos:{x:170,y:96},time:1335453201705},{type:0,pos:{x:170,y:97},time:1335453201752},{type:0,pos:{x:170,y:98},time:1335453201801},{type:0,pos:{x:170,y:100},time:1335453201831},{type:0,pos:{x:170,y:102},time:1335453201862},{type:0,pos:{x:170,y:103},time:1335453201910},{type:0,pos:{x:170,y:104},time:1335453201959},{type:0,pos:{x:169,y:107},time:1335453201999},{type:0,pos:{x:169,y:109},time:1335453202024},{type:0,pos:{x:168,y:111},time:1335453202064},{type:0,pos:{x:168,y:112},time:1335453202108},{type:0,pos:{x:167,y:114},time:1335453202179},{type:0,pos:{x:167,y:115},time:1335453202236},{type:0,pos:{x:166,y:115},time:1335453202286},{type:1},{type:4,layer:0},{type:0,pos:{x:155,y:130},time:1335453202880},{type:0,pos:{x:154,y:132},time:1335453202911},{type:0,pos:{x:153,y:132},time:1335453202948},{type:0,pos:{x:152,y:134},time:1335453202979},{type:0,pos:{x:151,y:134},time:1335453203028},{type:0,pos:{x:150,y:136},time:1335453203070},{type:0,pos:{x:149,y:137},time:1335453203128},{type:0,pos:{x:147,y:138},time:1335453203208},{type:0,pos:{x:146,y:139},time:1335453203265},{type:0,pos:{x:144,y:140},time:1335453203295},{type:0,pos:{x:143,y:141},time:1335453203335},{type:0,pos:{x:142,y:141},time:1335453203394},{type:0,pos:{x:139,y:144},time:1335453203426},{type:0,pos:{x:138,y:144},time:1335453203477},{type:1},{type:4,layer:0},{type:0,pos:{x:113,y:150},time:1335453204341},{type:0,pos:{x:112,y:150},time:1335453204388},{type:0,pos:{x:110,y:151},time:1335453204458},{type:0,pos:{x:109,y:151},time:1335453204498},{type:0,pos:{x:107,y:152},time:1335453204557},{type:0,pos:{x:105,y:152},time:1335453204606},{type:0,pos:{x:104,y:153},time:1335453204660},{type:0,pos:{x:101,y:153},time:1335453204725},{type:0,pos:{x:98,y:154},time:1335453204796},{type:0,pos:{x:97,y:154},time:1335453204845},{type:0,pos:{x:96,y:154},time:1335453204895},{type:0,pos:{x:95,y:154},time:1335453204954},{type:0,pos:{x:94,y:154},time:1335453205003},{type:0,pos:{x:93,y:155},time:1335453205053},{type:1},{type:4,layer:0},{type:0,pos:{x:70,y:159},time:1335453205679},{type:0,pos:{x:69,y:159},time:1335453205716},{type:0,pos:{x:67,y:160},time:1335453205765},{type:0,pos:{x:65,y:160},time:1335453205808},{type:0,pos:{x:63,y:160},time:1335453205864},{type:0,pos:{x:62,y:160},time:1335453205913},{type:0,pos:{x:60,y:161},time:1335453205963},{type:0,pos:{x:59,y:161},time:1335453205993},{type:0,pos:{x:56,y:161},time:1335453206061},{type:0,pos:{x:55,y:161},time:1335453206111},{type:0,pos:{x:54,y:161},time:1335453206161},{type:0,pos:{x:53,y:161},time:1335453206210},{type:0,pos:{x:52,y:161},time:1335453206259},{type:1},{type:4,layer:0},{type:0,pos:{x:128,y:160},time:1335453207655},{type:0,pos:{x:128,y:161},time:1335453207705},{type:0,pos:{x:129,y:162},time:1335453207734},{type:0,pos:{x:130,y:162},time:1335453207784},{type:0,pos:{x:130,y:163},time:1335453207811},{type:0,pos:{x:131,y:164},time:1335453207850},{type:0,pos:{x:131,y:165},time:1335453207882},{type:0,pos:{x:132,y:166},time:1335453207908},{type:0,pos:{x:133,y:167},time:1335453207936},{type:0,pos:{x:134,y:168},time:1335453207969},{type:0,pos:{x:134,y:169},time:1335453207995},{type:0,pos:{x:135,y:170},time:1335453208029},{type:0,pos:{x:135,y:171},time:1335453208066},{type:0,pos:{x:136,y:172},time:1335453208114},{type:0,pos:{x:137,y:172},time:1335453208164},{type:0,pos:{x:137,y:174},time:1335453208253},{type:1},{type:4,layer:0},{type:0,pos:{x:154,y:192},time:1335453208970},{type:0,pos:{x:155,y:194},time:1335453208998},{type:0,pos:{x:155,y:195},time:1335453209047},{type:0,pos:{x:156,y:197},time:1335453209097},{type:0,pos:{x:157,y:198},time:1335453209136},{type:0,pos:{x:158,y:199},time:1335453209174},{type:0,pos:{x:158,y:200},time:1335453209206},{type:0,pos:{x:159,y:200},time:1335453209255},{type:0,pos:{x:159,y:202},time:1335453209325},{type:0,pos:{x:160,y:202},time:1335453209357},{type:0,pos:{x:160,y:203},time:1335453209383},{type:0,pos:{x:161,y:204},time:1335453209413},{type:0,pos:{x:161,y:205},time:1335453209446},{type:0,pos:{x:162,y:205},time:1335453209493},{type:0,pos:{x:162,y:206},time:1335453209523},{type:0,pos:{x:163,y:206},time:1335453209572},{type:1},{type:4,layer:0},{type:0,pos:{x:175,y:222},time:1335453210316},{type:0,pos:{x:176,y:223},time:1335453210360},{type:0,pos:{x:177,y:225},time:1335453210389},{type:0,pos:{x:177,y:226},time:1335453210428},{type:0,pos:{x:178,y:228},time:1335453210478},{type:0,pos:{x:179,y:228},time:1335453210524},{type:0,pos:{x:180,y:230},time:1335453210563},{type:0,pos:{x:180,y:232},time:1335453210638},{type:0,pos:{x:181,y:233},time:1335453210690},{type:0,pos:{x:182,y:233},time:1335453210740},{type:0,pos:{x:182,y:235},time:1335453210833},{type:1},{type:2,color:{red:0,green:0,blue:255,alpha:255}},{type:3,brush_type:0,size:20,opacity:.8,spacing:.2}],end:256,nlayers:1,width:1114,height:411,pixelRatio:1,checkpoints:[]}})
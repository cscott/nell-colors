/**
 * @license RequireJS domReady 1.0.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
define("domReady",[],function(){function i(a){for(var b=0,d;d=a[b];b++)d(c)}function j(){var a=d,c=e;b&&(a.length&&(d=[],i(a)),f.resourcesDone&&c.length&&(e=[],i(c)))}function k(){b||(b=!0,h&&clearInterval(h),j())}function l(a){return b?a(c):d.push(a),l}var a=typeof window!="undefined"&&window.document,b=!a,c=a?document:null,d=[],e=[],f=requirejs||require||{},g=f.resourcesReady,h;return"resourcesReady"in f&&(f.resourcesReady=function(a){g&&g(a),a&&j()}),a&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",k,!1),window.addEventListener("load",k,!1)):window.attachEvent&&(window.attachEvent("onload",k),self===self.top&&(h=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),k())}catch(a){}},30))),document.readyState==="complete"&&k()),l.withResources=function(a){return b&&f.resourcesDone?a(c):e.push(a),l},l.version="1.0.0",l.load=function(a,b,c,d){d.isBuild?c(null):l(c)},l}),define("src/color-x11",[],function(){var a=function(a){return{snow:new a(255,250,250,255),"ghost white":new a(248,248,255,255),GhostWhite:new a(248,248,255,255),"white smoke":new a(245,245,245,255),WhiteSmoke:new a(245,245,245,255),gainsboro:new a(220,220,220,255),"floral white":new a(255,250,240,255),FloralWhite:new a(255,250,240,255),"old lace":new a(253,245,230,255),OldLace:new a(253,245,230,255),linen:new a(250,240,230,255),"antique white":new a(250,235,215,255),AntiqueWhite:new a(250,235,215,255),"papaya whip":new a(255,239,213,255),PapayaWhip:new a(255,239,213,255),"blanched almond":new a(255,235,205,255),BlanchedAlmond:new a(255,235,205,255),bisque:new a(255,228,196,255),"peach puff":new a(255,218,185,255),PeachPuff:new a(255,218,185,255),"navajo white":new a(255,222,173,255),NavajoWhite:new a(255,222,173,255),moccasin:new a(255,228,181,255),cornsilk:new a(255,248,220,255),ivory:new a(255,255,240,255),"lemon chiffon":new a(255,250,205,255),LemonChiffon:new a(255,250,205,255),seashell:new a(255,245,238,255),honeydew:new a(240,255,240,255),"mint cream":new a(245,255,250,255),MintCream:new a(245,255,250,255),azure:new a(240,255,255,255),"alice blue":new a(240,248,255,255),AliceBlue:new a(240,248,255,255),lavender:new a(230,230,250,255),"lavender blush":new a(255,240,245,255),LavenderBlush:new a(255,240,245,255),"misty rose":new a(255,228,225,255),MistyRose:new a(255,228,225,255),white:new a(255,255,255,255),black:new a(0,0,0,255),"dark slate gray":new a(47,79,79,255),DarkSlateGray:new a(47,79,79,255),"dark slate grey":new a(47,79,79,255),DarkSlateGrey:new a(47,79,79,255),"dim gray":new a(105,105,105,255),DimGray:new a(105,105,105,255),"dim grey":new a(105,105,105,255),DimGrey:new a(105,105,105,255),"slate gray":new a(112,128,144,255),SlateGray:new a(112,128,144,255),"slate grey":new a(112,128,144,255),SlateGrey:new a(112,128,144,255),"light slate gray":new a(119,136,153,255),LightSlateGray:new a(119,136,153,255),"light slate grey":new a(119,136,153,255),LightSlateGrey:new a(119,136,153,255),gray:new a(190,190,190,255),grey:new a(190,190,190,255),"light grey":new a(211,211,211,255),LightGrey:new a(211,211,211,255),"light gray":new a(211,211,211,255),LightGray:new a(211,211,211,255),"midnight blue":new a(25,25,112,255),MidnightBlue:new a(25,25,112,255),navy:new a(0,0,128,255),"navy blue":new a(0,0,128,255),NavyBlue:new a(0,0,128,255),"cornflower blue":new a(100,149,237,255),CornflowerBlue:new a(100,149,237,255),"dark slate blue":new a(72,61,139,255),DarkSlateBlue:new a(72,61,139,255),"slate blue":new a(106,90,205,255),SlateBlue:new a(106,90,205,255),"medium slate blue":new a(123,104,238,255),MediumSlateBlue:new a(123,104,238,255),"light slate blue":new a(132,112,255,255),LightSlateBlue:new a(132,112,255,255),"medium blue":new a(0,0,205,255),MediumBlue:new a(0,0,205,255),"royal blue":new a(65,105,225,255),RoyalBlue:new a(65,105,225,255),blue:new a(0,0,255,255),"dodger blue":new a(30,144,255,255),DodgerBlue:new a(30,144,255,255),"deep sky blue":new a(0,191,255,255),DeepSkyBlue:new a(0,191,255,255),"sky blue":new a(135,206,235,255),SkyBlue:new a(135,206,235,255),"light sky blue":new a(135,206,250,255),LightSkyBlue:new a(135,206,250,255),"steel blue":new a(70,130,180,255),SteelBlue:new a(70,130,180,255),"light steel blue":new a(176,196,222,255),LightSteelBlue:new a(176,196,222,255),"light blue":new a(173,216,230,255),LightBlue:new a(173,216,230,255),"powder blue":new a(176,224,230,255),PowderBlue:new a(176,224,230,255),"pale turquoise":new a(175,238,238,255),PaleTurquoise:new a(175,238,238,255),"dark turquoise":new a(0,206,209,255),DarkTurquoise:new a(0,206,209,255),"medium turquoise":new a(72,209,204,255),MediumTurquoise:new a(72,209,204,255),turquoise:new a(64,224,208,255),cyan:new a(0,255,255,255),"light cyan":new a(224,255,255,255),LightCyan:new a(224,255,255,255),"cadet blue":new a(95,158,160,255),CadetBlue:new a(95,158,160,255),"medium aquamarine":new a(102,205,170,255),MediumAquamarine:new a(102,205,170,255),aquamarine:new a(127,255,212,255),"dark green":new a(0,100,0,255),DarkGreen:new a(0,100,0,255),"dark olive green":new a(85,107,47,255),DarkOliveGreen:new a(85,107,47,255),"dark sea green":new a(143,188,143,255),DarkSeaGreen:new a(143,188,143,255),"sea green":new a(46,139,87,255),SeaGreen:new a(46,139,87,255),"medium sea green":new a(60,179,113,255),MediumSeaGreen:new a(60,179,113,255),"light sea green":new a(32,178,170,255),LightSeaGreen:new a(32,178,170,255),"pale green":new a(152,251,152,255),PaleGreen:new a(152,251,152,255),"spring green":new a(0,255,127,255),SpringGreen:new a(0,255,127,255),"lawn green":new a(124,252,0,255),LawnGreen:new a(124,252,0,255),green:new a(0,255,0,255),chartreuse:new a(127,255,0,255),"medium spring green":new a(0,250,154,255),MediumSpringGreen:new a(0,250,154,255),"green yellow":new a(173,255,47,255),GreenYellow:new a(173,255,47,255),"lime green":new a(50,205,50,255),LimeGreen:new a(50,205,50,255),"yellow green":new a(154,205,50,255),YellowGreen:new a(154,205,50,255),"forest green":new a(34,139,34,255),ForestGreen:new a(34,139,34,255),"olive drab":new a(107,142,35,255),OliveDrab:new a(107,142,35,255),"dark khaki":new a(189,183,107,255),DarkKhaki:new a(189,183,107,255),khaki:new a(240,230,140,255),"pale goldenrod":new a(238,232,170,255),PaleGoldenrod:new a(238,232,170,255),"light goldenrod yellow":new a(250,250,210,255),LightGoldenrodYellow:new a(250,250,210,255),"light yellow":new a(255,255,224,255),LightYellow:new a(255,255,224,255),yellow:new a(255,255,0,255),gold:new a(255,215,0,255),"light goldenrod":new a(238,221,130,255),LightGoldenrod:new a(238,221,130,255),goldenrod:new a(218,165,32,255),"dark goldenrod":new a(184,134,11,255),DarkGoldenrod:new a(184,134,11,255),"rosy brown":new a(188,143,143,255),RosyBrown:new a(188,143,143,255),"indian red":new a(205,92,92,255),IndianRed:new a(205,92,92,255),"saddle brown":new a(139,69,19,255),SaddleBrown:new a(139,69,19,255),sienna:new a(160,82,45,255),peru:new a(205,133,63,255),burlywood:new a(222,184,135,255),beige:new a(245,245,220,255),wheat:new a(245,222,179,255),"sandy brown":new a(244,164,96,255),SandyBrown:new a(244,164,96,255),tan:new a(210,180,140,255),chocolate:new a(210,105,30,255),firebrick:new a(178,34,34,255),brown:new a(165,42,42,255),"dark salmon":new a(233,150,122,255),DarkSalmon:new a(233,150,122,255),salmon:new a(250,128,114,255),"light salmon":new a(255,160,122,255),LightSalmon:new a(255,160,122,255),orange:new a(255,165,0,255),"dark orange":new a(255,140,0,255),DarkOrange:new a(255,140,0,255),coral:new a(255,127,80,255),"light coral":new a(240,128,128,255),LightCoral:new a(240,128,128,255),tomato:new a(255,99,71,255),"orange red":new a(255,69,0,255),OrangeRed:new a(255,69,0,255),red:new a(255,0,0,255),"hot pink":new a(255,105,180,255),HotPink:new a(255,105,180,255),"deep pink":new a(255,20,147,255),DeepPink:new a(255,20,147,255),pink:new a(255,192,203,255),"light pink":new a(255,182,193,255),LightPink:new a(255,182,193,255),"pale violet red":new a(219,112,147,255),PaleVioletRed:new a(219,112,147,255),maroon:new a(176,48,96,255),"medium violet red":new a(199,21,133,255),MediumVioletRed:new a(199,21,133,255),"violet red":new a(208,32,144,255),VioletRed:new a(208,32,144,255),magenta:new a(255,0,255,255),violet:new a(238,130,238,255),plum:new a(221,160,221,255),orchid:new a(218,112,214,255),"medium orchid":new a(186,85,211,255),MediumOrchid:new a(186,85,211,255),"dark orchid":new a(153,50,204,255),DarkOrchid:new a(153,50,204,255),"dark violet":new a(148,0,211,255),DarkViolet:new a(148,0,211,255),"blue violet":new a(138,43,226,255),BlueViolet:new a(138,43,226,255),purple:new a(160,32,240,255),"medium purple":new a(147,112,219,255),MediumPurple:new a(147,112,219,255),thistle:new a(216,191,216,255),snow1:new a(255,250,250,255),snow2:new a(238,233,233,255),snow3:new a(205,201,201,255),snow4:new a(139,137,137,255),seashell1:new a(255,245,238,255),seashell2:new a(238,229,222,255),seashell3:new a(205,197,191,255),seashell4:new a(139,134,130,255),AntiqueWhite1:new a(255,239,219,255),AntiqueWhite2:new a(238,223,204,255),AntiqueWhite3:new a(205,192,176,255),AntiqueWhite4:new a(139,131,120,255),bisque1:new a(255,228,196,255),bisque2:new a(238,213,183,255),bisque3:new a(205,183,158,255),bisque4:new a(139,125,107,255),PeachPuff1:new a(255,218,185,255),PeachPuff2:new a(238,203,173,255),PeachPuff3:new a(205,175,149,255),PeachPuff4:new a(139,119,101,255),NavajoWhite1:new a(255,222,173,255),NavajoWhite2:new a(238,207,161,255),NavajoWhite3:new a(205,179,139,255),NavajoWhite4:new a(139,121,94,255),LemonChiffon1:new a(255,250,205,255),LemonChiffon2:new a(238,233,191,255),LemonChiffon3:new a(205,201,165,255),LemonChiffon4:new a(139,137,112,255),cornsilk1:new a(255,248,220,255),cornsilk2:new a(238,232,205,255),cornsilk3:new a(205,200,177,255),cornsilk4:new a(139,136,120,255),ivory1:new a(255,255,240,255),ivory2:new a(238,238,224,255),ivory3:new a(205,205,193,255),ivory4:new a(139,139,131,255),honeydew1:new a(240,255,240,255),honeydew2:new a(224,238,224,255),honeydew3:new a(193,205,193,255),honeydew4:new a(131,139,131,255),LavenderBlush1:new a(255,240,245,255),LavenderBlush2:new a(238,224,229,255),LavenderBlush3:new a(205,193,197,255),LavenderBlush4:new a(139,131,134,255),MistyRose1:new a(255,228,225,255),MistyRose2:new a(238,213,210,255),MistyRose3:new a(205,183,181,255),MistyRose4:new a(139,125,123,255),azure1:new a(240,255,255,255),azure2:new a(224,238,238,255),azure3:new a(193,205,205,255),azure4:new a(131,139,139,255),SlateBlue1:new a(131,111,255,255),SlateBlue2:new a(122,103,238,255),SlateBlue3:new a(105,89,205,255),SlateBlue4:new a(71,60,139,255),RoyalBlue1:new a(72,118,255,255),RoyalBlue2:new a(67,110,238,255),RoyalBlue3:new a(58,95,205,255),RoyalBlue4:new a(39,64,139,255),blue1:new a(0,0,255,255),blue2:new a(0,0,238,255),blue3:new a(0,0,205,255),blue4:new a(0,0,139,255),DodgerBlue1:new a(30,144,255,255),DodgerBlue2:new a(28,134,238,255),DodgerBlue3:new a(24,116,205,255),DodgerBlue4:new a(16,78,139,255),SteelBlue1:new a(99,184,255,255),SteelBlue2:new a(92,172,238,255),SteelBlue3:new a(79,148,205,255),SteelBlue4:new a(54,100,139,255),DeepSkyBlue1:new a(0,191,255,255),DeepSkyBlue2:new a(0,178,238,255),DeepSkyBlue3:new a(0,154,205,255),DeepSkyBlue4:new a(0,104,139,255),SkyBlue1:new a(135,206,255,255),SkyBlue2:new a(126,192,238,255),SkyBlue3:new a(108,166,205,255),SkyBlue4:new a(74,112,139,255),LightSkyBlue1:new a(176,226,255,255),LightSkyBlue2:new a(164,211,238,255),LightSkyBlue3:new a(141,182,205,255),LightSkyBlue4:new a(96,123,139,255),SlateGray1:new a(198,226,255,255),SlateGray2:new a(185,211,238,255),SlateGray3:new a(159,182,205,255),SlateGray4:new a(108,123,139,255),LightSteelBlue1:new a(202,225,255,255),LightSteelBlue2:new a(188,210,238,255),LightSteelBlue3:new a(162,181,205,255),LightSteelBlue4:new a(110,123,139,255),LightBlue1:new a(191,239,255,255),LightBlue2:new a(178,223,238,255),LightBlue3:new a(154,192,205,255),LightBlue4:new a(104,131,139,255),LightCyan1:new a(224,255,255,255),LightCyan2:new a(209,238,238,255),LightCyan3:new a(180,205,205,255),LightCyan4:new a(122,139,139,255),PaleTurquoise1:new a(187,255,255,255),PaleTurquoise2:new a(174,238,238,255),PaleTurquoise3:new a(150,205,205,255),PaleTurquoise4:new a(102,139,139,255),CadetBlue1:new a(152,245,255,255),CadetBlue2:new a(142,229,238,255),CadetBlue3:new a(122,197,205,255),CadetBlue4:new a(83,134,139,255),turquoise1:new a(0,245,255,255),turquoise2:new a(0,229,238,255),turquoise3:new a(0,197,205,255),turquoise4:new a(0,134,139,255),cyan1:new a(0,255,255,255),cyan2:new a(0,238,238,255),cyan3:new a(0,205,205,255),cyan4:new a(0,139,139,255),DarkSlateGray1:new a(151,255,255,255),DarkSlateGray2:new a(141,238,238,255),DarkSlateGray3:new a(121,205,205,255),DarkSlateGray4:new a(82,139,139,255),aquamarine1:new a(127,255,212,255),aquamarine2:new a(118,238,198,255),aquamarine3:new a(102,205,170,255),aquamarine4:new a(69,139,116,255),DarkSeaGreen1:new a(193,255,193,255),DarkSeaGreen2:new a(180,238,180,255),DarkSeaGreen3:new a(155,205,155,255),DarkSeaGreen4:new a(105,139,105,255),SeaGreen1:new a(84,255,159,255),SeaGreen2:new a(78,238,148,255),SeaGreen3:new a(67,205,128,255),SeaGreen4:new a(46,139,87,255),PaleGreen1:new a(154,255,154,255),PaleGreen2:new a(144,238,144,255),PaleGreen3:new a(124,205,124,255),PaleGreen4:new a(84,139,84,255),SpringGreen1:new a(0,255,127,255),SpringGreen2:new a(0,238,118,255),SpringGreen3:new a(0,205,102,255),SpringGreen4:new a(0,139,69,255),green1:new a(0,255,0,255),green2:new a(0,238,0,255),green3:new a(0,205,0,255),green4:new a(0,139,0,255),chartreuse1:new a(127,255,0,255),chartreuse2:new a(118,238,0,255),chartreuse3:new a(102,205,0,255),chartreuse4:new a(69,139,0,255),OliveDrab1:new a(192,255,62,255),OliveDrab2:new a(179,238,58,255),OliveDrab3:new a(154,205,50,255),OliveDrab4:new a(105,139,34,255),DarkOliveGreen1:new a(202,255,112,255),DarkOliveGreen2:new a(188,238,104,255),DarkOliveGreen3:new a(162,205,90,255),DarkOliveGreen4:new a(110,139,61,255),khaki1:new a(255,246,143,255),khaki2:new a(238,230,133,255),khaki3:new a(205,198,115,255),khaki4:new a(139,134,78,255),LightGoldenrod1:new a(255,236,139,255),LightGoldenrod2:new a(238,220,130,255),LightGoldenrod3:new a(205,190,112,255),LightGoldenrod4:new a(139,129,76,255),LightYellow1:new a(255,255,224,255),LightYellow2:new a(238,238,209,255),LightYellow3:new a(205,205,180,255),LightYellow4:new a(139,139,122,255),yellow1:new a(255,255,0,255),yellow2:new a(238,238,0,255),yellow3:new a(205,205,0,255),yellow4:new a(139,139,0,255),gold1:new a(255,215,0,255),gold2:new a(238,201,0,255),gold3:new a(205,173,0,255),gold4:new a(139,117,0,255),goldenrod1:new a(255,193,37,255),goldenrod2:new a(238,180,34,255),goldenrod3:new a(205,155,29,255),goldenrod4:new a(139,105,20,255),DarkGoldenrod1:new a(255,185,15,255),DarkGoldenrod2:new a(238,173,14,255),DarkGoldenrod3:new a(205,149,12,255),DarkGoldenrod4:new a(139,101,8,255),RosyBrown1:new a(255,193,193,255),RosyBrown2:new a(238,180,180,255),RosyBrown3:new a(205,155,155,255),RosyBrown4:new a(139,105,105,255),IndianRed1:new a(255,106,106,255),IndianRed2:new a(238,99,99,255),IndianRed3:new a(205,85,85,255),IndianRed4:new a(139,58,58,255),sienna1:new a(255,130,71,255),sienna2:new a(238,121,66,255),sienna3:new a(205,104,57,255),sienna4:new a(139,71,38,255),burlywood1:new a(255,211,155,255),burlywood2:new a(238,197,145,255),burlywood3:new a(205,170,125,255),burlywood4:new a(139,115,85,255),wheat1:new a(255,231,186,255),wheat2:new a(238,216,174,255),wheat3:new a(205,186,150,255),wheat4:new a(139,126,102,255),tan1:new a(255,165,79,255),tan2:new a(238,154,73,255),tan3:new a(205,133,63,255),tan4:new a(139,90,43,255),chocolate1:new a(255,127,36,255),chocolate2:new a(238,118,33,255),chocolate3:new a(205,102,29,255),chocolate4:new a(139,69,19,255),firebrick1:new a(255,48,48,255),firebrick2:new a(238,44,44,255),firebrick3:new a(205,38,38,255),firebrick4:new a(139,26,26,255),brown1:new a(255,64,64,255),brown2:new a(238,59,59,255),brown3:new a(205,51,51,255),brown4:new a(139,35,35,255),salmon1:new a(255,140,105,255),salmon2:new a(238,130,98,255),salmon3:new a(205,112,84,255),salmon4:new a(139,76,57,255),LightSalmon1:new a(255,160,122,255),LightSalmon2:new a(238,149,114,255),LightSalmon3:new a(205,129,98,255),LightSalmon4:new a(139,87,66,255),orange1:new a(255,165,0,255),orange2:new a(238,154,0,255),orange3:new a(205,133,0,255),orange4:new a(139,90,0,255),DarkOrange1:new a(255,127,0,255),DarkOrange2:new a(238,118,0,255),DarkOrange3:new a(205,102,0,255),DarkOrange4:new a(139,69,0,255),coral1:new a(255,114,86,255),coral2:new a(238,106,80,255),coral3:new a(205,91,69,255),coral4:new a(139,62,47,255),tomato1:new a(255,99,71,255),tomato2:new a(238,92,66,255),tomato3:new a(205,79,57,255),tomato4:new a(139,54,38,255),OrangeRed1:new a(255,69,0,255),OrangeRed2:new a(238,64,0,255),OrangeRed3:new a(205,55,0,255),OrangeRed4:new a(139,37,0,255),red1:new a(255,0,0,255),red2:new a(238,0,0,255),red3:new a(205,0,0,255),red4:new a(139,0,0,255),DebianRed:new a(215,7,81,255),DeepPink1:new a(255,20,147,255),DeepPink2:new a(238,18,137,255),DeepPink3:new a(205,16,118,255),DeepPink4:new a(139,10,80,255),HotPink1:new a(255,110,180,255),HotPink2:new a(238,106,167,255),HotPink3:new a(205,96,144,255),HotPink4:new a(139,58,98,255),pink1:new a(255,181,197,255),pink2:new a(238,169,184,255),pink3:new a(205,145,158,255),pink4:new a(139,99,108,255),LightPink1:new a(255,174,185,255),LightPink2:new a(238,162,173,255),LightPink3:new a(205,140,149,255),LightPink4:new a(139,95,101,255),PaleVioletRed1:new a(255,130,171,255),PaleVioletRed2:new a(238,121,159,255),PaleVioletRed3:new a(205,104,137,255),PaleVioletRed4:new a(139,71,93,255),maroon1:new a(255,52,179,255),maroon2:new a(238,48,167,255),maroon3:new a(205,41,144,255),maroon4:new a(139,28,98,255),VioletRed1:new a(255,62,150,255),VioletRed2:new a(238,58,140,255),VioletRed3:new a(205,50,120,255),VioletRed4:new a(139,34,82,255),magenta1:new a(255,0,255,255),magenta2:new a(238,0,238,255),magenta3:new a(205,0,205,255),magenta4:new a(139,0,139,255),orchid1:new a(255,131,250,255),orchid2:new a(238,122,233,255),orchid3:new a(205,105,201,255),orchid4:new a(139,71,137,255),plum1:new a(255,187,255,255),plum2:new a(238,174,238,255),plum3:new a(205,150,205,255),plum4:new a(139,102,139,255),MediumOrchid1:new a(224,102,255,255),MediumOrchid2:new a(209,95,238,255),MediumOrchid3:new a(180,82,205,255),MediumOrchid4:new a(122,55,139,255),DarkOrchid1:new a(191,62,255,255),DarkOrchid2:new a(178,58,238,255),DarkOrchid3:new a(154,50,205,255),DarkOrchid4:new a(104,34,139,255),purple1:new a(155,48,255,255),purple2:new a(145,44,238,255),purple3:new a(125,38,205,255),purple4:new a(85,26,139,255),MediumPurple1:new a(171,130,255,255),MediumPurple2:new a(159,121,238,255),MediumPurple3:new a(137,104,205,255),MediumPurple4:new a(93,71,139,255),thistle1:new a(255,225,255,255),thistle2:new a(238,210,238,255),thistle3:new a(205,181,205,255),thistle4:new a(139,123,139,255),gray0:new a(0,0,0,255),grey0:new a(0,0,0,255),gray1:new a(3,3,3,255),grey1:new a(3,3,3,255),gray2:new a(5,5,5,255),grey2:new a(5,5,5,255),gray3:new a(8,8,8,255),grey3:new a(8,8,8,255),gray4:new a(10,10,10,255),grey4:new a(10,10,10,255),gray5:new a(13,13,13,255),grey5:new a(13,13,13,255),gray6:new a(15,15,15,255),grey6:new a(15,15,15,255),gray7:new a(18,18,18,255),grey7:new a(18,18,18,255),gray8:new a(20,20,20,255),grey8:new a(20,20,20,255),gray9:new a(23,23,23,255),grey9:new a(23,23,23,255),gray10:new a(26,26,26,255),grey10:new a(26,26,26,255),gray11:new a(28,28,28,255),grey11:new a(28,28,28,255),gray12:new a(31,31,31,255),grey12:new a(31,31,31,255),gray13:new a(33,33,33,255),grey13:new a(33,33,33,255),gray14:new a(36,36,36,255),grey14:new a(36,36,36,255),gray15:new a(38,38,38,255),grey15:new a(38,38,38,255),gray16:new a(41,41,41,255),grey16:new a(41,41,41,255),gray17:new a(43,43,43,255),grey17:new a(43,43,43,255),gray18:new a(46,46,46,255),grey18:new a(46,46,46,255),gray19:new a(48,48,48,255),grey19:new a(48,48,48,255),gray20:new a(51,51,51,255),grey20:new a(51,51,51,255),gray21:new a(54,54,54,255),grey21:new a(54,54,54,255),gray22:new a(56,56,56,255),grey22:new a(56,56,56,255),gray23:new a(59,59,59,255),grey23:new a(59,59,59,255),gray24:new a(61,61,61,255),grey24:new a(61,61,61,255),gray25:new a(64,64,64,255),grey25:new a(64,64,64,255),gray26:new a(66,66,66,255),grey26:new a(66,66,66,255),gray27:new a(69,69,69,255),grey27:new a(69,69,69,255),gray28:new a(71,71,71,255),grey28:new a(71,71,71,255),gray29:new a(74,74,74,255),grey29:new a(74,74,74,255),gray30:new a(77,77,77,255),grey30:new a(77,77,77,255),gray31:new a(79,79,79,255),grey31:new a(79,79,79,255),gray32:new a(82,82,82,255),grey32:new a(82,82,82,255),gray33:new a(84,84,84,255),grey33:new a(84,84,84,255),gray34:new a(87,87,87,255),grey34:new a(87,87,87,255),gray35:new a(89,89,89,255),grey35:new a(89,89,89,255),gray36:new a(92,92,92,255),grey36:new a(92,92,92,255),gray37:new a(94,94,94,255),grey37:new a(94,94,94,255),gray38:new a(97,97,97,255),grey38:new a(97,97,97,255),gray39:new a(99,99,99,255),grey39:new a(99,99,99,255),gray40:new a(102,102,102,255),grey40:new a(102,102,102,255),gray41:new a(105,105,105,255),grey41:new a(105,105,105,255),gray42:new a(107,107,107,255),grey42:new a(107,107,107,255),gray43:new a(110,110,110,255),grey43:new a(110,110,110,255),gray44:new a(112,112,112,255),grey44:new a(112,112,112,255),gray45:new a(115,115,115,255),grey45:new a(115,115,115,255),gray46:new a(117,117,117,255),grey46:new a(117,117,117,255),gray47:new a(120,120,120,255),grey47:new a(120,120,120,255),gray48:new a(122,122,122,255),grey48:new a(122,122,122,255),gray49:new a(125,125,125,255),grey49:new a(125,125,125,255),gray50:new a(127,127,127,255),grey50:new a(127,127,127,255),gray51:new a(130,130,130,255),grey51:new a(130,130,130,255),gray52:new a(133,133,133,255),grey52:new a(133,133,133,255),gray53:new a(135,135,135,255),grey53:new a(135,135,135,255),gray54:new a(138,138,138,255),grey54:new a(138,138,138,255),gray55:new a(140,140,140,255),grey55:new a(140,140,140,255),gray56:new a(143,143,143,255),grey56:new a(143,143,143,255),gray57:new a(145,145,145,255),grey57:new a(145,145,145,255),gray58:new a(148,148,148,255),grey58:new a(148,148,148,255),gray59:new a(150,150,150,255),grey59:new a(150,150,150,255),gray60:new a(153,153,153,255),grey60:new a(153,153,153,255),gray61:new a(156,156,156,255),grey61:new a(156,156,156,255),gray62:new a(158,158,158,255),grey62:new a(158,158,158,255),gray63:new a(161,161,161,255),grey63:new a(161,161,161,255),gray64:new a(163,163,163,255),grey64:new a(163,163,163,255),gray65:new a(166,166,166,255),grey65:new a(166,166,166,255),gray66:new a(168,168,168,255),grey66:new a(168,168,168,255),gray67:new a(171,171,171,255),grey67:new a(171,171,171,255),gray68:new a(173,173,173,255),grey68:new a(173,173,173,255),gray69:new a(176,176,176,255),grey69:new a(176,176,176,255),gray70:new a(179,179,179,255),grey70:new a(179,179,179,255),gray71:new a(181,181,181,255),grey71:new a(181,181,181,255),gray72:new a(184,184,184,255),grey72:new a(184,184,184,255),gray73:new a(186,186,186,255),grey73:new a(186,186,186,255),gray74:new a(189,189,189,255),grey74:new a(189,189,189,255),gray75:new a(191,191,191,255),grey75:new a(191,191,191,255),gray76:new a(194,194,194,255),grey76:new a(194,194,194,255),gray77:new a(196,196,196,255),grey77:new a(196,196,196,255),gray78:new a(199,199,199,255),grey78:new a(199,199,199,255),gray79:new a(201,201,201,255),grey79:new a(201,201,201,255),gray80:new a(204,204,204,255),grey80:new a(204,204,204,255),gray81:new a(207,207,207,255),grey81:new a(207,207,207,255),gray82:new a(209,209,209,255),grey82:new a(209,209,209,255),gray83:new a(212,212,212,255),grey83:new a(212,212,212,255),gray84:new a(214,214,214,255),grey84:new a(214,214,214,255),gray85:new a(217,217,217,255),grey85:new a(217,217,217,255),gray86:new a(219,219,219,255),grey86:new a(219,219,219,255),gray87:new a(222,222,222,255),grey87:new a(222,222,222,255),gray88:new a(224,224,224,255),grey88:new a(224,224,224,255),gray89:new a(227,227,227,255),grey89:new a(227,227,227,255),gray90:new a(229,229,229,255),grey90:new a(229,229,229,255),gray91:new a(232,232,232,255),grey91:new a(232,232,232,255),gray92:new a(235,235,235,255),grey92:new a(235,235,235,255),gray93:new a(237,237,237,255),grey93:new a(237,237,237,255),gray94:new a(240,240,240,255),grey94:new a(240,240,240,255),gray95:new a(242,242,242,255),grey95:new a(242,242,242,255),gray96:new a(245,245,245,255),grey96:new a(245,245,245,255),gray97:new a(247,247,247,255),grey97:new a(247,247,247,255),gray98:new a(250,250,250,255),grey98:new a(250,250,250,255),gray99:new a(252,252,252,255),grey99:new a(252,252,252,255),gray100:new a(255,255,255,255),grey100:new a(255,255,255,255),"dark grey":new a(169,169,169,255),DarkGrey:new a(169,169,169,255),"dark gray":new a(169,169,169,255),DarkGray:new a(169,169,169,255),"dark blue":new a(0,0,139,255),DarkBlue:new a(0,0,139,255),"dark cyan":new a(0,139,139,255),DarkCyan:new a(0,139,139,255),"dark magenta":new a(139,0,139,255),DarkMagenta:new a(139,0,139,255),"dark red":new a(139,0,0,255),DarkRed:new a(139,0,0,255),"light green":new a(144,238,144,255),LightGreen:new a(144,238,144,255),indigo:new a(75,0,130,255)}};return{make_color_table:a}}),define("src/color",["./color-x11"],function(a){var b=function(a){return a<0?0:a>255?255:a},c=Math.max,d=Math.min,e=function(a,b,c,d){this.red=a,this.green=b,this.blue=c,this.alpha=d};e.prototype={copy:function(){return new e(this.red,this.green,this.blue,this.alpha)},set:function(a,b,c,d){this.red=a,this.green=b,this.blue=c,this.alpha=d},set_from_color:function(a){this.set(a.red,a.green,a.blue,a.alpha)},to_string:function(){function a(a){var b=a.toString(16);while(b.length<2)b="0"+b;return b}return"#"+a(this.red)+a(this.green)+a(this.blue)+a(this.alpha)},to_hls:function(){var a=this.red/255,b=this.green/255,e=this.blue/255,f=c(c(a,b),e),g=d(d(a,b),e),h=(f+g)/2,i=0,j=0;if(f!==g){h<=.5?i=(f-g)/(f+g):i=(f-g)/(2-f-g);var k=f-g;a===f?j=(b-e)/k:b===f?j=2+(e-a)/k:e===f&&(j=4+(a-b)/k),j*=60,j<0&&(j+=360)}return[j,h,i]},to_pixel:function(){return this.alpha|this.blue<<8|this.green<<16|this.red<<24},add:function(a){return e.add(this,a)},subtract:function(a){return e.subtract(this,a)},lighten:function(){return this.shade(1.3)},darken:function(){return this.shade(.7)},shade:function(a){var b,c=this.to_hls();c[1]*=a,c[2]*=a;for(b=1;b<3;b++)c[b]=c[b]>1?1:c[b]<0?0:c[b];return e.from_hls(c[0],c[1],c[2],this.alpha)}};var f=a.make_color_table(e),g=/\(\s*([\-+]?\d*\.?\d+)\s*(%\s*)?,\s*([\-+]?\d*\.?\d+)\s*(%\s*)?,\s*([\-+]?\d*\.?\d+)\s*(%\s*)?(,\s*([\-+]?\d*\.?\d+)\s*(%\s*)?)?\)/,h=function(a,c){var d=a.trim().match(g);if(!d)return null;var f=parseFloat(d[1]);d[2]&&(f=f/100*255);var h=parseFloat(d[3]);d[4]&&(h=h/100*255);var i=parseFloat(d[5]);d[6]&&(i=i/100*255);var j=255;if(c){if(!d[7])return null;j=parseFloat(d[8]),d[9]&&(j/=100),j*=255}return new e(b(Math.round(f)),b(Math.round(h)),b(Math.round(i)),b(Math.round(j)))},i=function(a,c){var d=a.trim().match(g);if(!d)return null;var f=parseFloat(d[1]);d[2]&&(f=f/100*360),f=f<0?0:f>360?360:f;var h=parseFloat(d[3]);d[4]&&(h/=100),h=h<0?0:h>1?1:h;var i=parseFloat(d[5]);d[6]&&(i/=100),i=i<0?0:i>1?1:i;var j=255;if(c){if(!d[7])return null;j=parseFloat(d[8]),d[9]&&(j/=100),j*=255}return j=b(Math.round(j)),e.from_hls(f,h,i,j)},j=function(a){var b,c,d,f,g=parseInt(a,16);return g!==g?null:a.length===8?e.from_pixel(g):a.length===6?e.from_pixel(g<<8|255):a.length===4?(b=g>>12&15,c=g>>8&15,d=g>>4&15,f=g&15,new e(b*17,c*17,d*17,f*17)):a.length===3?(b=g>>8&15,c=g>>4&15,d=g&15,new e(b*17,c*17,d*17,255)):null};return e.from_string=function(a){return a.substr(0,3)==="rgb"?a.substr(0,4)==="rgba"?h(a.substr(4),!0):h(a.substr(3),!1):a.substr(0,3)==="hsl"?a.substr(0,4)==="hsla"?i(a.substr(4),!0):i(a.substr(3),!1):a.substr(0,1)==="#"?j(a.substr(1)):a in f?f[a]:null},e.from_pixel=function(a){return new e(a>>24&255,a>>16&255,a>>8&255,a&255)},e.from_hls=function(a,b,c,d){d===undefined&&(d=255),a/=360;if(c===0){var f=b*255;return new e(f,f,f,d)}var g;b<=.5?g=b*(1+c):g=b+c-b*c;var h=2*b-g,i=[a+1/3,a,a-1/3],j=[0,0,0],k;for(k=0;k<3;k++)i[k]<0&&(i[k]+=1),i[k]>1&&(i[k]-=1),6*i[k]<1?j[k]=h+(g-h)*i[k]*6:2*i[k]<1?j[k]=g:3*i[k]<2?j[k]=h+(g-h)*(2/3-i[k])*6:j[k]=h;return new e(Math.round(j[0]*255),Math.round(j[1]*255),Math.round(j[2]*255),d)},e.equal=function(a,b){return a===b?!0:a.red===b.red&&a.green===b.green&&a.blue===b.blue&&a.alpha===b.alpha},e.add=function(a,d){return new e(b(a.red+d.red),b(a.green+d.green),b(a.blue+d.blue),c(a.alpha,d.alpha))},e.subtract=function(a,c){return new e(b(a.red-c.red),b(a.green-c.green),b(a.blue-c.blue),d(a.alpha,c.alpha))},e.interpolate=function(a,b,c){return new e(a.red+(b.red-a.red)*c,a.green+(b.green-a.green)*c,a.blue+(b.blue-a.blue)*c,a.alpha+(b.alpha-a.alpha)*c)},e.WHITE=e.from_string("#ffffffff"),e.BLACK=e.from_string("#000000ff"),e.RED=e.from_string("#ff0000ff"),e.DARK_RED=e.from_string("#800000ff"),e.GREEN=e.from_string("#00ff00ff"),e.DARK_GREEN=e.from_string("#008000ff"),e.BLUE=e.from_string("#0000ffff"),e.DARK_BLUE=e.from_string("#000080ff"),e.CYAN=e.from_string("#00ffffff"),e.DARK_CYAN=e.from_string("#008080ff"),e.MAGENTA=e.from_string("#ff00ffff"),e.DARK_MAGENTA=e.from_string("#800080ff"),e.YELLOW=e.from_string("#ffff00ff"),e.DARK_YELLOW=e.from_string("#808000ff"),e.GRAY=e.from_string("#a0a0a4ff"),e.DARK_GRAY=e.from_string("#808080ff"),e.LIGHT_GRAY=e.from_string("#c0c0c0ff"),e.BUTTER=e.from_string("#edd400ff"),e.BUTTER_LIGHT=e.from_string("#fce94fff"),e.BUTTER_DARK=e.from_string("#c4a000ff"),e.ORANGE=e.from_string("#f57900ff"),e.ORANGE_LIGHT=e.from_string("#fcaf3fff"),e.ORANGE_DARK=e.from_string("#ce5c00ff"),e.CHOCOLATE=e.from_string("#c17d11ff"),e.CHOCOLATE_LIGHT=e.from_string("#e9b96eff"),e.CHOCOLATE_DARK=e.from_string("#8f5902ff"),e.CHAMELEON=e.from_string("#73d216ff"),e.CHAMELEON_LIGHT=e.from_string("#8ae234ff"),e.CHAMELEON_DARK=e.from_string("#4e9a06ff"),e.SKY_BLUE=e.from_string("#3465a4ff"),e.SKY_BLUE_LIGHT=e.from_string("#729fcfff"),e.SKY_BLUE_DARK=e.from_string("#204a87ff"),e.PLUM=e.from_string("#75507bff"),e.PLUM_LIGHT=e.from_string("#ad7fa8ff"),e.PLUM_DARK=e.from_string("#5c3566ff"),e.SCARLET_RED=e.from_string("#cc0000ff"),e.SCARLET_RED_LIGHT=e.from_string("#ef2929ff"),e.SCARLET_RED_DARK=e.from_string("#a40000ff"),e.ALUMINIUM_1=e.from_string("#eeeeecff"),e.ALUMINIUM_2=e.from_string("#d3d7cfff"),e.ALUMINIUM_3=e.from_string("#babdb6ff"),e.ALUMINIUM_4=e.from_string("#888a85ff"),e.ALUMINIUM_5=e.from_string("#555753ff"),e.ALUMINIUM_6=e.from_string("#2e3436ff"),e.TRANSPARENT=e.from_string("#00000000"),e}),define("src/compat",[],function(){return typeof Function.prototype.bind=="undefined"&&(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a||null,Array.prototype.slice.call(arguments))}}),{Uint8Array:typeof Uint8Array=="undefined"?Array:Uint8Array,Float64Array:typeof Float64Array=="undefined"?Array:Float64Array}}),define("src/brush",["./color","./compat"],function(a,b){var c=b.Uint8Array,d={HARD:0,SOFT:1,NUM_BRUSHES:2};Object.freeze(d);var e=256,f=e/2,g=256,h=65,i=1.023,j=function(){var a=new c(e*e),b,d,g,h,i;for(b=0;b<e;b++)for(d=0;d<e;d++)g=b-f,h=d-f,i=Math.sqrt(g*g+h*h),a[b+d*e]=Math.floor(Math.min(255,i*255/f));return a},k=j(),l=function(a){return Math.sin((a*a-.5)*Math.PI)*.5+.5},m=function(a,b){var d=new c(g*h),e=0,f,j,k;for(f=g-1;f>=0;f--){j=f/g,k=1-(j-a)/(1-a);if(Math.round(l(k)*b)>=2){e=f;break}}var m=(e+2)/g/g,n,o,p=[];for(o=0;o<h;o++){var q=i+o*2/64;for(f=0;f<g;f++)j=Math.min(f*m*q,1),j<a?p[f]=Math.floor(b):(k=1-(j-a)/(1-a),k=l(k)*b,p[f]=Math.round(k));var r=Math.round(o*g/(q*64)),s=0;for(n=0;n<g;n++){var t=0,u;for(u=n-r;u<n+r+1;u++)f=Math.min(Math.max(u,0),g-1),f<g&&(t+=p[f]);var v=t/(r*2+1);v>s&&(s=v),d[n+o*g]=Math.floor(v)}}return{intensity_tbl:d}},n=function(){return m(.8,255)},o=function(){return m(0,128)},p=function(b,c,e,f,g){this.color=b||a.BLACK,this.type=c||d.HARD,this.size=e||32,this.opacity=f||1,this.spacing=g||.225};return p.brush_type=[],p.brush_type[d.HARD]=n(),p.brush_type[d.SOFT]=o(),p.Type=d,p.prototype.clone=function(){return new p(this.color,this.type,this.size,this.opacity,this.spacing)},p.prototype.toCanvas=function(){var a=this.size;a<2&&(a=2);var b=Math.ceil(a),c=document.createElement("canvas");c.width=c.height=b;var d=c.getContext("2d"),i=d.createImageData(b,b),j=a/2,l=Math.floor(b/2),m=(e-1)/a,n=Math.floor(h/a),o,q;for(o=0;o<b;o++)for(q=0;q<b;q++){var r=o-l,s=q-l,t=r*m+f,u=s*m+f;t=Math.max(0,Math.min(t,e-1)),u=Math.max(0,Math.min(u,e-1));var v=k[Math.floor(t)+Math.floor(u)*e],w=p.brush_type[this.type].intensity_tbl[v+n*g],x=(o+q*b)*4;i.data[x+0]=this.color.red,i.data[x+1]=this.color.green,i.data[x+2]=this.color.blue,i.data[x+3]=w}return d.putImageData(i,0,0),c},p}),define("src/dom",[],function(){var a=function(a){var b=[[["charset","UTF-8"]],[["name","viewport"],["content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"]],[["name","apple-mobile-web-app-capable"],["content","yes"]],[["name","apple-mobile-web-app-status-bar-style"],["content","black"]]],c=a.getElementsByTagName("meta"),d,e,f;for(d=0;d<b.length;d++){var g=b[d],h=!1;for(e=0;e<c.length&&!h;e++){var i=c[e],j=!0;for(f=0;f<g.length&&j;f++){var k=g[f][0],l=g[f][1];i.getAttribute(k)!==l&&(j=!1)}j&&(h=!0)}if(h)continue;var m=a.createElement("meta");for(f=0;f<g.length;f++)m.setAttribute(g[f][0],g[f][1]);a.head.appendChild(m)}},b=function(a,b){a.document.title=b},c=function(a){var b=a.document,c=document.createElement("canvas");c.id="ncolors",c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.right="0px",c.style.bottom="0px",document.body.appendChild(c);var d=function(b){var d=a.innerWidth,e=a.innerHeight,f=a.devicePixelRatio||1;c.width=d*f,c.height=e*f,console.log("Resizing canvas",d,e,f),c.resizeHandler&&c.resizeHandler()};return a.addEventListener("resize",d,!1),d(),c},d=function(d){return a(d.document),b(d,"Colors for Nell"),c(d)},e=function(d){var e=d.open("","_blank");return a(e),b(e,"Colors for Nell"),c(e)};return{insertMeta:a,new_canvas:function(){return e(window)},set_title:function(a,b){a.ownerDocument.title=b},get_title:function(a){return a.ownerDocument.title}}}),define("src/drawcommand",["./color","./brush"],function(a,b){var c={DRAW:0,DRAW_END:1,COLOR_CHANGE:2,BRUSH_CHANGE:3,NUM_COMMAND_TYPES:4};Object.freeze(c);var d=function(a){console.assert(a>=0&&a<c.NUM_COMMAND_TYPES),this.type=a};return d.Type=c,d.create_draw=function(a){var b=new d(c.DRAW);return b.pos={x:a.x,y:a.y},b},d.create_draw_end=function(){var a=new d(c.DRAW_END);return a},d.create_color_change=function(a){var b=new d(c.COLOR_CHANGE);return b.color=a.copy(),b},d.create_brush_change=function(a,b,e,f){var g=new d(c.BRUSH_CHANGE);return g.brush_type=a,g.size=b,g.opacity=e,g.spacing=f,g},d}),define("src/point",[],function(){var a=function(a,b,c){this.x=a,this.y=b,this.isUp=c||!1};return a.prototype={clone:function(){return new a(this.x,this.y,this.isUp)},equals:function(b){return a.equals(this,b)},dist:function(b){return a.dist(this,b)},interp:function(b,c){return a.interp(this,b,c)}},a.equals=function(a,b){return a===b?!0:a.x===b.x&&a.y===b.y&&a.isUp===b.isUp},a.dist2=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},a.dist=function(b,c){return Math.sqrt(a.dist2(b,c))},a.interp=function(b,c,d){var e=b.x+d*(c.x-b.x),f=b.y+d*(c.y-b.y);return new a(e,f,c.isUp)},a}),define("src/layer",["./drawcommand","./brush","./point"],function(a,b,c){var d=0,e=function(){this.domElement=document.createElement("div"),this.completedCanvas=document.createElement("canvas"),this.progressCanvas=document.createElement("canvas"),this.domElement.appendChild(this.completedCanvas),this.domElement.appendChild(this.progressCanvas),this.domElement.id="layer"+d++,[this.domElement,this.completedCanvas,this.progressCanvas].forEach(function(a){a.style.position="absolute",a.style.left=a.style.top=a.style.right=a.style.bottom="0px",a.style.width="100%",a.style.height="100%"}),this.progressContext=this.progressCanvas.getContext("2d"),this.completedContext=this.completedCanvas.getContext("2d"),this.brush=new b,this.brush_stamp=null,this.progressCanvas.style.opacity=this.brush.opacity,this.isDrawingPath=!1};return e.prototype={_getBrushStamp:function(){return this.brush_stamp===null&&(this.brush_stamp=this.brush.toCanvas()),this.brush_stamp},execColorChange:function(a){console.assert(!this.isDrawingPath),this.brush=new b(a,this.brush.type,this.brush.size,this.brush.opacity,this.brush.spacing),this.brush_stamp=null},execBrushChange:function(a,c,d,e){console.assert(!this.isDrawingPath),this.brush=new b(this.brush.color,a,c,d,e),this.brush_stamp=null,this.progressCanvas.style.opacity=this.brush.opacity},_drawStamp:function(a){this.lastPoint=a;var b=this._getBrushStamp(),c=Math.floor(b.width/2),d=Math.round(a.x)-c,e=Math.round(a.y)-c;this.progressContext.drawImage(b,d,e)},execDraw:function(a,b){var d={x:a,y:b};if(!this.isDrawingPath)this._drawStamp(d),this.isDrawingPath=!0;else{var e=this.lastPoint,f=d,g=c.dist(e,f),h,i=this.brush.size*this.brush.spacing;if(!(g<i))for(h=i;h<g;h+=i)this._drawStamp(c.interp(e,f,h/g))}},execDrawEnd:function(){console.assert(this.isDrawingPath),this.completedContext.globalAlpha=this.brush.opacity,this.completedContext.drawImage(this.progressCanvas,0,0),this.progressContext.clearRect(0,0,this.width,this.height),this.isDrawingPath=!1},execCommand:function(b){switch(b.type){case a.Type.DRAW:this.execDraw(b.pos.x*this.pixel_ratio,b.pos.y*this.pixel_ratio);break;case a.Type.DRAW_END:this.execDrawEnd();break;case a.Type.COLOR_CHANGE:this.execColorChange(b.color);break;case a.Type.BRUSH_CHANGE:this.execBrushChange(b.brush_type,b.size*this.pixel_ratio,b.opacity,b.spacing);break;default:console.assert(!1,b)}},cancelCurrentStroke:function(){this.progressContext.clearRect(0,0,this.width,this.height),this.isDrawingPath=!1},clear:function(){[this.progressContext,this.completedContext].forEach(function(a){a.clearRect(0,0,this.width,this.height)}.bind(this)),this.isDrawingPath=!1,this.brush=new b,this.brush_stamp=null},resize:function(a,b,c){var d=a*c,e=b*c;[this,this.completedCanvas,this.progressCanvas].forEach(function(a){a.width=d,a.height=e}),this.pixel_ratio=c},currentBrush:function(){return this.brush.clone()}},e}),define("hammer",[],function(){return function(b,c,d){function x(a){return a.touches?a.touches.length:1}function y(a){a=a||window.event;if(!a.touches){var b=document,c=b.body;return[{x:a.pageX||a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b&&b.clientLeft||c&&b.clientLeft||0),y:a.pageY||a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&b.clientTop||0)}]}var d=[],e;for(var f=0,g=a.touches.length;f<g;f++)e=a.touches[f],d.push({x:e.pageX,y:e.pageY});return d}function z(a,b){return Math.atan2(b.y-a.y,b.x-a.x)*180/Math.PI}function A(a,b){b.touches=y(b.originalEvent),b.type=a,H(e["on"+a])&&e["on"+a].call(e,b)}function B(a){a=a||window.event,a.preventDefault?a.preventDefault():(a.returnValue=!1,a.cancelBubble=!0)}function C(){j={},l=!1,k=0,g=0,h=0,m=null}function E(a){switch(a.type){case"mousedown":case"touchstart":j.start=y(a),o=(new Date).getTime(),k=x(a),l=!0,u=a;var d=b.getBoundingClientRect(),e=b.clientTop||document.body.clientTop||0,f=b.clientLeft||document.body.clientLeft||0,p=window.pageYOffset||b.scrollTop||document.body.scrollTop,q=window.pageXOffset||b.scrollLeft||document.body.scrollLeft;s={top:d.top+p-e,left:d.left+q-f},t=!0,D.hold(a),c.prevent_default&&B(a);break;case"mousemove":case"touchmove":if(!t)return!1;v=a,j.move=y(a),D.transform(a)||D.drag(a);break;case"mouseup":case"mouseout":case"touchcancel":case"touchend":if(!t||m!="transform"&&a.touches&&a.touches.length>0)return!1;t=!1,w=a,m=="drag"?A("dragend",{originalEvent:a,direction:i,distance:g,angle:h}):m=="transform"?A("transformend",{originalEvent:a,position:j.center,scale:a.scale,rotation:a.rotation}):D.tap(u),n=m,C()}}function F(a,b){!b&&window.event&&window.event.toElement&&(b=window.event.toElement);if(a===b)return!0;if(b){var c=b.parentNode;while(c!==null){if(c===a)return!0;c=c.parentNode}}return!1}function G(a,b){var c={};if(!b)return a;for(var d in a)d in b?c[d]=b[d]:c[d]=a[d];return c}function H(a){return Object.prototype.toString.call(a)=="[object Function]"}var e=this,f={prevent_default:!1,css_hacks:!0,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_double_distance:20,hold:!0,hold_timeout:500};c=G(f,c),function(){if(!c.css_hacks)return!1;var a=["webkit","moz","ms","o",""],d={userSelect:"none",touchCallout:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},e="";for(var f=0;f<a.length;f++)for(var g in d)e=g,a[f]&&(e=a[f]+e.substring(0,1).toUpperCase()+e.substring(1)),b.style[e]=d[g]}();var g=0,h=0,i=0,j={},k=0,l=!1,m=null,n=null,o=null,p={x:0,y:0},q=null,r=null,s={},t=!1,u,v,w;this.getDirectionFromAngle=function(a){var b={down:a>=45&&a<135,left:a>=135||a<=-135,up:a<-45&&a>-135,right:a>=-45&&a<=45},c,d;for(d in b)if(b[d]){c=d;break}return c};var D={hold:function(a){c.hold&&(m="hold",clearTimeout(r),r=setTimeout(function(){m=="hold"&&A("hold",{originalEvent:a,position:j.start})},c.hold_timeout))},drag:function(a){var b=j.move[0].x-j.start[0].x,d=j.move[0].y-j.start[0].y;g=Math.sqrt(b*b+d*d);if(c.drag&&g>c.drag_min_distance||m=="drag"){h=z(j.start[0],j.move[0]),i=e.getDirectionFromAngle(h);var f=i=="up"||i=="down";if((f&&!c.drag_vertical||!f&&!c.drag_horizontal)&&g>c.drag_min_distance)return;m="drag";var k={x:j.move[0].x-s.left,y:j.move[0].y-s.top},n={originalEvent:a,position:k,direction:i,distance:g,distanceX:b,distanceY:d,angle:h};l&&(A("dragstart",n),l=!1),A("drag",n),B(a)}},transform:function(a){if(c.transform){var b=a.scale||1,d=a.rotation||0;if(x(a)!=2)return!1;if(m!="drag"&&(m=="transform"||Math.abs(1-b)>c.scale_treshold||Math.abs(d)>c.rotation_treshold)){m="transform",j.center={x:(j.move[0].x+j.move[1].x)/2-s.left,y:(j.move[0].y+j.move[1].y)/2-s.top};var e={originalEvent:a,position:j.center,scale:b,rotation:d};return l&&(A("transformstart",e),l=!1),A("transform",e),B(a),!0}}return!1},tap:function(a){var b=(new Date).getTime(),d=b-o;if(c.hold&&!(c.hold&&c.hold_timeout>d))return;var e=function(){if(p&&c.tap_double&&n=="tap"&&o-q<c.tap_max_interval){var a=Math.abs(p[0].x-j.start[0].x),b=Math.abs(p[0].y-j.start[0].y);return p&&j.start&&Math.max(a,b)<c.tap_double_distance}return!1}();e?(m="double_tap",q=null,A("doubletap",{originalEvent:a,position:j.start}),B(a)):(m="tap",q=b,p=j.start,c.tap&&(A("tap",{originalEvent:a,position:j.start}),B(a)))}};"ontouchstart"in window?(b.addEventListener("touchstart",E,!1),b.addEventListener("touchmove",E,!1),b.addEventListener("touchend",E,!1),b.addEventListener("touchcancel",E,!1)):b.addEventListener?(b.addEventListener("mouseout",function(a){F(b,a.relatedTarget)||E(a)},!1),b.addEventListener("mouseup",E,!1),b.addEventListener("mousedown",E,!1),b.addEventListener("mousemove",E,!1)):document.attachEvent&&(b.attachEvent("onmouseout",function(a){F(b,a.relatedTarget)||E(a)},!1),b.attachEvent("onmouseup",E),b.attachEvent("onmousedown",E),b.attachEvent("onmousemove",E))}}),define("src/postmessage",[],function(){return function(b,c,d,e){try{b.postMessage(c,d,e)}catch(f){typeof c!="string"&&(c=JSON.stringify(c)),b.postMessage(c,e,d)}}}),define("raf",[],function(){var a=0,b=["ms","moz","webkit","o"],c;for(c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(console.log("Using requestAnimationFrame fallback."),window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),window.requestAnimationFrame}),define("src/hand/features",["../point","../compat"],function(a,b){var c=b.Float64Array,d=3,e=.25,f=1/7,g=2,h=2,i=function(a,b){this.tl=a,this.br=b};i.prototype={unionPt:function(a){a.x<this.tl.x&&(this.tl.x=a.x),a.y<this.tl.y&&(this.tl.y=a.y),a.x>this.br.x&&(this.br.x=a.x),a.y>this.br.y&&(this.br.y=a.y)},union:function(a){this.unionPt(a.tl),this.unionPt(a.br)},size:function(){return{width:this.br.x-this.tl.x,height:this.br.y-this.tl.y}}},i.fromPts=function(a){var b=new i(a[0].clone(),a[0].clone());return a.forEach(function(a){b.unionPt(a)}),b};var j=function(b){var c=b.ppmm,d=function(b){return new a(b[0],b[1])};b.strokes=b.strokes.map(function(a){a=a.map(d);var b=[a[0]],c;for(c=1;c<a.length;c++){if(a[c].equals(a[c-1]))continue;b.push(a[c])}return b}),b.strokes=b.strokes.filter(function(a){return a.length>1});if(b.strokes.length===0)return;var e=b.strokes.map(function(a){return i.fromPts(a)}),f=e[0];e.forEach(function(a){f.union(a)});var g=f.size();g=Math.max(g.width/c.x,g.height/c.y);var h=function(b){var d=(b.x-f.tl.x)/(c.x*g),e=(b.y-f.tl.y)/(c.y*g);return new a(d,e)};b.strokes=b.strokes.map(function(a){return a.map(h)})},k=function(b){b.strokes=b.strokes.map(function(b){var c=[],f,g;for(f=0;f<b.length;f++){var h=new a(b[f].x*e,b[f].y*e),i=d;while(i>0&&(f<i||f>=b.length-i))i--;for(g=1;g<=i;g++)h.x+=b[f-g].x+b[f+g].x,h.y+=b[f-g].y+b[f+g].y;h.x/=2*i+e,h.y/=2*i+e,c.push(h)}return c})},l=function(b){var c=[];b.strokes.forEach(function(b){var d=b[0],e;c.push(new a(d.x,d.y,!0));for(e=1;e<b.length;e++)c.push(b[e])}),b.strokes=[c]},m=function(b,c){console.assert(b.strokes.length===1),c||(c=f);var d=b.strokes[0];if(d.length===0)return;var e=[],g=d[0],h=0,i=!0,j=!0;d.forEach(function(b){var d=a.dist(g,b);while(h<=d){var f=j?0:h/d,k=a.interp(g,b,f),l=b.isUp;i&&(k.isUp=!0),i=j?!1:l,e.push(k),h+=c,j=!1}h-=d,g=b}),e[e.length-1].isUp&&(console.assert(!g.isUp,arguments[2]),e.push(g)),b.strokes=[e]},n=function(a){var b,c=a.strokes[0],d=c.map(function(){return[]});for(b=0;b<c.length;b++){var e=c[b<2?0:b-2],f=c[b<1?0:b-1],g=c[b],h=c[b+1<c.length?b+1:c.length-1],j=c[b+2<c.length?b+2:c.length-1],k=h.x-f.x,l=h.y-f.y,m=Math.sqrt(k*k+l*l),n=j.x-e.x,o=j.y-e.y,p=Math.sqrt(n*n+o*o),q=i.fromPts([e,f,g,h,j]).size(),r=e.dist(f)+f.dist(g)+g.dist(h)+h.dist(j),s=function(a){return Math.abs(n*(e.y-a.y)-o*(e.x-a.x))/p},t=s(f),u=s(g),v=s(h),w=3;f.equals(e)&&w--,h.equals(j)&&w--,d[b]=[0,0,k/m,l/m,g.y,(q.height-q.width)/(q.height+q.width),r/Math.max(q.height,q.width)-2,(t*t+u*u+v*v)/w,n/p,g.isUp?1:-1]}for(b=0;b<d.length;b++){var x=d[b<1?0:b-1],y=d[b],z=d[b+1<d.length?b+1:d.length-1],A=x[2],B=x[3],C=z[2],D=z[3];y[0]=A*C+B*D,y[1]=A*D-B*C}for(b=0;b<d.length;b++)d[b][4]=2*d[b][4]-1,d[b][6]=(d[b][6]+1)/3.2*2-1,d[b][7]=d[b][7]*50-1;a.features=d},o=function(){return 0},p=function(a,b){var c=a.length-1,d,e,f,g,h,i,j,k=[];for(e=0;e<=c;e++){i=a[e].map(o),j=0;for(d=1;d<=b;d++){f=Math.min(e+d,c),g=Math.max(e-d,0);for(h=0;h<a[e].length;h++)i[h]+=d*(a[f][h]-a[g][h]);j+=d*d}j*=2,k[e]=[];for(h=0;h<a[e].length;h++)k[e][h]=i[h]/j}return k},q=function(a){a.deltas=p(a.features,g),a.accels=p(a.deltas,h)},r=function(a){a.features=a.features.map(function(b,c){return b.concat(a.deltas[c],a.accels[c])}),delete a.deltas,delete a.accels},s=function(a){console.assert(a.Type==="linear"),console.assert(a.CovKind==="euclidean");var b=function(b,d){var e=[];a.Nodes.forEach(function(a){var b=d*(a.VQ-1);a.Mean.forEach(function(a,c){e[b+c]=a})});var f=new c(e.length);return e.forEach(function(a,b){f[b]=a}),f},d=function(a,b,c){var d=c.length*b,e=0,f,g;for(g=0;g<c.length;g++)f=c[g]-a[d+g],e+=f*f;return e},e=function(a,b){var c=0,e=d(a,0,b),f;for(f=1;f*b.length<a.length;f++){var g=d(a,f,b);g<e&&(e=g,c=f)}return c},f=a.Streams.map(function(a,c){return b(c+1,a)}),g=function(a,b){return e(f[b],a)},h=function(){return Array.prototype.map.call(arguments,g)};return h},t=function(a){console.assert(a.Type==="tree"),console.assert(a.CovKind==="euclidean");var b=function(b,d){var e={},f=[],g=[];a.Nodes.forEach(function(a){a.Stream===b&&(e[a.Id]=a)});var h=function(a,b){g[b]=a.VQ;var c=b*d;a.Mean.forEach(function(a,b){f[c+b]=a}),a.LeftId&&h(e[a.LeftId],1+2*b),a.RightId&&h(e[a.RightId],2+2*b)};h(e[1],0);var i=new c(f.length);f.forEach(function(a,b){i[b]=a});var j=new Uint16Array(g.length);return g.forEach(function(a,b){j[b]=a}),[j,i]},d=function(a,b,c){var d=c.length*b,e=0,f,g;for(g=0;g<c.length;g++)f=c[g]-a[d+g],e+=f*f;return e},e=function(a,b,c){var e=0;for(;;){if(a[e]!==0)return a[e]-1;var f=d(b,1+2*e,c),g=d(b,2+2*e,c);e=1+2*e,f>g&&e++}},f=a.Streams.map(function(a,c){return b(c+1,a)}),g=function(a,b){return e(f[b][0],f[b][1],a)},h=function(){return Array.prototype.map.call(arguments,g)};return h},u=function(a){var b;return a.Type==="tree"?b=t(a):a.Type==="linear"?b=s(a):console.assert(!1,a.Type),function(a){a.vq=[];var c;for(c=0;c<a.features.length;c++)a.vq[c]=b(a.features[c],a.deltas[c],a.accels[c])}};return{SMOOTH_N:d,SMOOTH_ALPHA:e,RESAMPLE_INTERVAL:f,normalize:j,smooth:k,singleStroke:l,equidist:m,features:n,delta_and_accel:q,merge_delta_and_accel:r,make_vq:u}}),define("src/recog",["./drawcommand","./hand/features"],function(a,b,c,d){var e=function(c,d,e){var f,g,h=[],i=[];for(f=d;f<e;f++){g=c[f];switch(g.type){case a.Type.DRAW:i.push([g.pos.x,-g.pos.y]);break;case a.Type.DRAW_END:i.length>0&&(h.push(i),i=[]);break;default:}}if(h.length===0)return null;var j={strokes:h,ppmm:{x:1,y:1}};return b.normalize(j),b.smooth(j),b.singleStroke(j),b.equidist(j),j.strokes[0].length===0?null:(b.features(j),j.features.length===0?null:(b.delta_and_accel(j),j))},f=new Worker("src/worker.js"),g=null,h=!0,i=function(){if(h||g===null)return;var a={type:"recog",data_set:g};f.postMessage(JSON.stringify(a)),g=null,h=!0};f.addEventListener("message",function(a){var b=JSON.parse(a.data);switch(b.type){case"debug":console.log.apply(console,b.args);break;case"ready":h=!1,i();break;case"recog":console.log("Got results",b.model,"prob",b.prob),h=!1,i();break;default:console.error("Unexpected message from worker",a)}}),f.postMessage(JSON.stringify({type:"start"}));var j=function(a,b,c){typeof b!="number"&&(b=0),typeof c!="number"&&(c=a.length);var d=e(a,b,c);if(!d)return;g=d,i();return};return{attemptRecognition:j}}),define("ncolors",["domReady!","./src/brush","./src/color","./src/compat","./src/dom","./src/drawcommand","./src/layer","./hammer","./src/postmessage","./raf","./src/recog"],function(a,b,c,d,e,f,g,h,i,j,k){var l=typeof MessageChannel!="undefined",m=null,n=1e3;e.insertMeta(a);var o=new g;a.body.appendChild(o.domElement);var p=new h(o.domElement,{prevent_default:!0,drag_min_distance:2}),q=[],r=[];q.last=0;var s=new b(c.BLACK,b.Type.SOFT,20,.7,.2);q.push(f.create_color_change(s.color)),q.push(f.create_brush_change(s.type,s.size,s.opacity,s.spacing)),q.recog=q.length;var t=null,u=function(){t&&(clearTimeout(t),t=null)},v=function(){q.recog=q.length,u()},w=function(){t=null,v()},x=function(){t&&clearTimeout(t),t=setTimeout(w,n)},y=!1,z=function(){while(q.last<q.length)o.execCommand(q[q.last++]);y=!1},A=function(){y||(y=!0,j(z))},B=!1;p.ondrag=function(a){B=!0,q.push(f.create_draw(a.position)),r.length=0,A(),u()},p.ondragend=function(a){B=!1,q.push(f.create_draw_end()),r.length=0,A(),a&&k.attemptRecognition(q,q.recog,q.length),x()};var C=function(){var a={type:"brush",color:s.color.to_string(),brush_type:s.type,size:s.size,opacity:s.opacity,spacing:s.spacing};m.postMessage(JSON.stringify(a))},D=function(){console.assert(!B);if(q.length===0)return;var a=q.length-1;while(a>=0&&q[a].type!==f.Type.DRAW_END)a--;if(a<0)return;a--;while(a>=0&&q[a].type===f.Type.DRAW)a--;a++,r.push(q.slice(a)),q.length=a,o.clear(),q.last=0,z(),s=o.currentBrush(),C(),v()},E=function(){if(r.length===0)return;r.pop().forEach(function(a){q.push(a)}),z(),s=o.currentBrush(),C(),v()},F=function(a){var b=window.innerWidth,c=window.innerHeight,d=window.devicePixelRatio||1;o.resize(b,c,d),q.last=0,z()};window.addEventListener("resize",F,!1),F(),a.getElementById("loading").style.display="none";var G=function(a){B&&p.ondragend();var d=JSON.parse(a.data);switch(d.type){case"swatchButton":var e=c.from_string(d.color);if(c.equal(s.color,e))break;s.color=e,q.push(f.create_color_change(s.color));break;case"undoButton":D();break;case"redoButton":E();break;case"hardButton":if(s.type===b.Type.HARD)break;s.type=b.Type.HARD,q.push(f.create_brush_change(s.type,s.size,s.opacity,s.spacing));break;case"softButton":if(s.type===b.Type.SOFT)break;s.type=b.Type.SOFT,q.push(f.create_brush_change(s.type,s.size,s.opacity,s.spacing));break;case"opacitySlider":if(s.opacity===+d.value)break;s.opacity=+d.value,q.push(f.create_brush_change(s.type,s.size,s.opacity,s.spacing));break;case"sizeSlider":if(s.size===+d.value)break;s.size=+d.value,q.push(f.create_brush_change(s.type,s.size,s.opacity,s.spacing));break;default:console.warn("Unexpected child toolbar message",a)}},H=function(a){var b=a.data;typeof b=="string"&&(b=JSON.parse(b));switch(b.type){case"toolbar":return m.dispatchEvent({data:b.msg});default:console.warn("Unexpected child message",a)}};window.addEventListener("message",H,!1);var I={type:"childReady"};if(l){var J=new MessageChannel;m=J.port1,m.addEventListener("message",G,!1),m.start(),i(window.parent,JSON.stringify(I),"*",[J.port2])}else m={dispatchEvent:function(a){G(a)},postMessage:function(a){var b={type:"toolbar",msg:a};i(window.parent,JSON.stringify(b),"*")}},i(window.parent,JSON.stringify(I),"*");C()})
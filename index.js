/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t+=1)e[t](s)}function a(){var e=o;i&&e.length&&(o=[],u(e))}function f(){i||(i=!0,n&&clearInterval(n),a())}function c(e){return i?e(s):o.push(e),c}var e,t,n,r=typeof window!="undefined"&&window.document,i=!r,s=r?document:null,o=[];if(r){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),t=document.createElement("div");try{e=window.frameElement===null}catch(l){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll(),f()}catch(e){}},30))}document.readyState==="complete"&&f()}return c.version="2.0.1",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),define("src/coords",[],function(){var e=function(t){if(t.getBoundingClientRect){var n=t.getBoundingClientRect();return{x:n.left+document.body.scrollLeft,y:n.top+document.body.scrollTop}}var r={x:t.offsetLeft,y:t.offsetTop};if(t.offsetParent){var i=e(t.offsetParent);r.x+=i.x,r.y+=i.y}return r},t=function(t,n){var r,i,s;t=t||window.event;var o=t.target||t.srcElement;if(!window.opera&&typeof t.offsetX!="undefined"){s={x:t.offsetX,y:t.offsetY};var u=o;while(u)u.mouseX=s.x,u.mouseY=s.y,s.x+=u.offsetLeft,s.y+=u.offsetTop,u=u.offsetParent;u=n;var a={x:0,y:0};while(u){if(typeof u.mouseX!="undefined"){r=u.mouseX-a.x,i=u.mouseY-a.y;break}a.x+=u.offsetLeft,a.y+=u.offsetTop,u=u.offsetParent}u=o;while(u)u.mouseX=undefined,u.mouseY=undefined,u=u.offsetParent}else s=e(n),r=t.pageX-s.x,i=t.pageY-s.y;return{x:r,y:i}};return{getRelativeEventPosition:t,getAbsolutePosition:e}}),define("src/dom",[],function(){var e=function(e){var t=[[["charset","UTF-8"]],[["name","viewport"],["content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"]],[["name","apple-mobile-web-app-capable"],["content","yes"]],[["name","apple-mobile-web-app-status-bar-style"],["content","black"]]],n=e.getElementsByTagName("meta"),r,i,s;for(r=0;r<t.length;r++){var o=t[r],u=!1;for(i=0;i<n.length&&!u;i++){var a=n[i],f=!0;for(s=0;s<o.length&&f;s++){var l=o[s][0],c=o[s][1];a.getAttribute(l)!==c&&(f=!1)}f&&(u=!0)}if(u)continue;var h=e.createElement("meta");for(s=0;s<o.length;s++)h.setAttribute(o[s][0],o[s][1]);e.head.appendChild(h)}},t=function(e,t){e.document.title=t},n=function(e){var t=e.document,n=document.createElement("canvas");n.id="ncolors",n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style.right="0px",n.style.bottom="0px",document.body.appendChild(n);var r=function(t){var r=e.innerWidth,i=e.innerHeight,s=e.devicePixelRatio||1;n.width=r*s,n.height=i*s,console.log("Resizing canvas",r,i,s),n.resizeHandler&&n.resizeHandler()};return e.addEventListener("resize",r,!1),r(),n},r=function(r){return e(r.document),t(r,"Nell's Colors"),n(r)},i=function(r){var i=r.open("","_blank");return e(i),t(i,"Nell's Colors"),n(i)};return{insertMeta:e,new_canvas:function(){return i(window)},set_title:function(e,t){e.ownerDocument.title=t},get_title:function(e){return e.ownerDocument.title}}}),define("lib/hammer",[],function(){return function(t,n,r){function x(e){return e.touches?e.touches.length:1}function T(e){e=e||window.event;if(!e.touches){var t=document,n=t.body;return[{x:e.pageX||e.clientX+(t&&t.scrollLeft||n&&n.scrollLeft||0)-(t&&t.clientLeft||n&&t.clientLeft||0),y:e.pageY||e.clientY+(t&&t.scrollTop||n&&n.scrollTop||0)-(t&&t.clientTop||n&&t.clientTop||0)}]}var r=[],i;for(var s=0,o=e.touches.length;s<o;s++)i=e.touches[s],r.push({x:i.pageX,y:i.pageY});return r}function N(e,t){return Math.atan2(t.y-e.y,t.x-e.x)*180/Math.PI}function C(e,t){t.touches=T(t.originalEvent),t.type=e,D(i["on"+e])&&i["on"+e].call(i,t)}function k(e){e=e||window.event,e.preventDefault?e.preventDefault():(e.returnValue=!1,e.cancelBubble=!0)}function L(){f={},c=!1,l=0,o=0,u=0,h=null}function O(e){switch(e.type){case"mousedown":case"touchstart":f.start=T(e),d=(new Date).getTime(),l=x(e),c=!0,w=e;var r=t.getBoundingClientRect(),i=t.clientTop||document.body.clientTop||0,s=t.clientLeft||document.body.clientLeft||0,v=window.pageYOffset||t.scrollTop||document.body.scrollTop,m=window.pageXOffset||t.scrollLeft||document.body.scrollLeft;y={top:r.top+v-i,left:r.left+m-s},b=!0,n.apply_hover&&t.classList.add("hover"),A.hold(e),n.prevent_default&&k(e);break;case"mousemove":case"touchmove":if(!b)return!1;E=e,f.move=T(e),A.transform(e)||A.drag(e);break;case"mouseup":case"mouseout":case"touchcancel":case"touchend":if(!b||h!="transform"&&e.touches&&e.touches.length>0)return!1;b=!1,S=e,n.apply_hover&&t.classList.remove("hover"),h=="drag"?C("dragend",{originalEvent:e,direction:a,distance:o,angle:u}):h=="transform"?C("transformend",{originalEvent:e,position:f.center,scale:e.scale,rotation:e.rotation}):A.tap(w),p=h,L()}}function M(e,t){!t&&window.event&&window.event.toElement&&(t=window.event.toElement);if(e===t)return!0;if(t){var n=t.parentNode;while(n!==null){if(n===e)return!0;n=n.parentNode}}return!1}function _(e,t){var n={};if(!t)return e;for(var r in e)r in t?n[r]=t[r]:n[r]=e[r];return n}function D(e){return Object.prototype.toString.call(e)=="[object Function]"}var i=this,s={prevent_default:!1,css_hacks:!0,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_double_distance:20,hold:!0,hold_timeout:500,apply_hover:!1,only_touch:!1};n=_(s,n),function(){if(!n.css_hacks)return!1;var e=["webkit","moz","ms","o",""],r={userSelect:"none",touchCallout:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},i="";for(var s=0;s<e.length;s++)for(var o in r)i=o,e[s]&&(i=e[s]+i.substring(0,1).toUpperCase()+i.substring(1)),t.style[i]=r[o]}();var o=0,u=0,a=0,f={},l=0,c=!1,h=null,p=null,d=null,v={x:0,y:0},m=null,g=null,y={},b=!1,w,E,S;this.getDirectionFromAngle=function(e){var t={down:e>=45&&e<135,left:e>=135||e<=-135,up:e<-45&&e>-135,right:e>=-45&&e<=45},n,r;for(r in t)if(t[r]){n=r;break}return n};var A={hold:function(e){n.hold&&(h="hold",clearTimeout(g),g=setTimeout(function(){h=="hold"&&C("hold",{originalEvent:e,position:f.start})},n.hold_timeout))},drag:function(e){var t=f.move[0].x-f.start[0].x,r=f.move[0].y-f.start[0].y;o=Math.sqrt(t*t+r*r);if(n.drag&&o>n.drag_min_distance||h=="drag"){u=N(f.start[0],f.move[0]),a=i.getDirectionFromAngle(u);var s=a=="up"||a=="down";if((s&&!n.drag_vertical||!s&&!n.drag_horizontal)&&o>n.drag_min_distance)return;h="drag";var l={x:f.move[0].x-y.left,y:f.move[0].y-y.top},p={originalEvent:e,position:l,direction:a,distance:o,distanceX:t,distanceY:r,angle:u};c&&(C("dragstart",p),c=!1),C("drag",p),k(e)}},transform:function(e){if(n.transform){var t=e.scale||1,r=e.rotation||0;if(x(e)!=2)return!1;if(h!="drag"&&(h=="transform"||Math.abs(1-t)>n.scale_treshold||Math.abs(r)>n.rotation_treshold)){h="transform",f.center={x:(f.move[0].x+f.move[1].x)/2-y.left,y:(f.move[0].y+f.move[1].y)/2-y.top};var i={originalEvent:e,position:f.center,scale:t,rotation:r};return c&&(C("transformstart",i),c=!1),C("transform",i),k(e),!0}}return!1},tap:function(e){var t=(new Date).getTime(),r=t-d;if(n.hold&&!(n.hold&&n.hold_timeout>r))return;var i=function(){if(v&&n.tap_double&&p=="tap"&&d-m<n.tap_max_interval){var e=Math.abs(v[0].x-f.start[0].x),t=Math.abs(v[0].y-f.start[0].y);return v&&f.start&&Math.max(e,t)<n.tap_double_distance}return!1}();i?(h="double_tap",m=null,C("doubletap",{originalEvent:e,position:f.start}),k(e)):(h="tap",m=t,v=f.start,n.tap&&(C("tap",{originalEvent:e,position:f.start}),k(e)))}};"ontouchstart"in window?(t.addEventListener("touchstart",O,!1),t.addEventListener("touchmove",O,!1),t.addEventListener("touchend",O,!1),t.addEventListener("touchcancel",O,!1)):n.only_touch||(t.addEventListener?(t.addEventListener("mouseout",function(e){M(t,e.relatedTarget)||O(e)},!1),t.addEventListener("mouseup",O,!1),t.addEventListener("mousedown",O,!1),t.addEventListener("mousemove",O,!1)):document.attachEvent&&(t.attachEvent("onmouseout",function(e){M(t,e.relatedTarget)||O(e)},!1),t.attachEvent("onmouseup",O),t.attachEvent("onmousedown",O),t.attachEvent("onmousemove",O))),n.prevent_default&&!n.only_touch&&(t.addEventListener?(t.addEventListener("click",k,!1),t.addEventListener("contextmenu",k,!1)):t.attachEvent("click",k))}}),define("src/nodefault",[],function(){var e=function(e){return function(t){return t.preventDefault(),e?e.apply(this,arguments):!1}};return e}),define("index",["domReady!","./src/coords","./src/dom","./lib/hammer","./src/nodefault"],function(e,t,n,r,i){n.insertMeta(e),e.body.classList.contains("dev")&&e.body.classList.add("appcache-allinfo");var s=e.getElementById("toolbar"),o="no-mode",u,a,f,l=function(e,t){return function(n){if(this[e]===n)return;this[e]=n,t.call(this,n)}},c=function(e,t,n){n?e.classList.add(t):e.classList.remove(t)},h={shown:!1,dragging:!1,captureEvents:!0,targetDropping:!1,x:0,y:0,elem:e.createElement("div"),hammer:null,uuid:null,setVisible:l("shown",function(e){c(this.elem,"visible",e)}),setCapture:l("captureEvents",function(e){this.elem.style.pointerEvents=e?null:"none"}),setDragging:l("isDragging",function(e){c(this.elem,"dragging",e)}),setThumb:l("thumb",function(e){this.elem.style.backgroundImage=e?"url('"+e+"')":null}),setTargetDropping:l("targetDropping",function(e){c(this.target.elem,"dropping",e)}),updateTarget:function(){var n=e.querySelector(".icon.trash"),r=t.getAbsolutePosition(n);this.target={elem:n,x:r.x,y:r.y,width:n.offsetWidth,height:n.offsetHeight};var i=e.getElementById("wrapper"),s=t.getAbsolutePosition(i);this.source={x:s.x,y:s.y,width:this.elem.offsetWidth,height:this.elem.offsetHeight}},move:function(e,t){var n=Math.round(e)+"px,"+Math.round(t)+"px";this.elem.style.WebkitTransform="translate3d("+n+",0)",this.elem.style.MozTransform=this.elem.style.transform="translate("+n+")";var r=this.source.x+e<this.target.x+this.target.width&&this.source.y+t<this.target.y+this.target.height&&this.source.x+e+this.source.width>this.target.x&&this.source.y+t+this.source.height>this.target.y;this.setTargetDropping(r)},drop:function(){var e=this.targetDropping;this.setVisible(!1),this.setTargetDropping(!1),this.setDragging(!1),e&&f({type:"trashDrop",uuid:this.uuid})}},p=e.createElement("iframe"),d=null;f=function(e){if(!d)return;d.postMessage(JSON.stringify(e))};var v,m,g,y=function(e){var t=e.data;typeof t=="string"&&(t=JSON.parse(t));switch(t.type){case"toolbar-mode-switch":s.classList.remove(o),o=t.mode,s.classList.add(o);break;case"drag-shadow":if(h.isDragging&&!t.show)break;h.updateTarget(),h.uuid=t.uuid,h.x=t.x,h.y=t.y,h.move(h.x,h.y),h.setDragging(!!t.dragging),h.setCapture(!!t.captureEvents),h.setThumb(t.thumb||null),h.setVisible(!!t.show);break;case"drag-shadow-move":h.move(h.x+t.x,h.y+t.y);break;case"drag-shadow-drop":h.drop();break;case"color":var n=Math.max(.3,t.opacity);u(n),a("rgba("+t.red+","+t.green+","+t.blue+","+n+")");break;case"brush":break;case"playing":g("playing");break;case"stopping":g("stopping");break;case"stopped":g("stopped");break;default:console.warn("Unexpected parent toolbar message",e)}};g=function(e){var t=s.querySelector(".play");["playing","stopping","stopped"].forEach(function(n){e===n?t.classList.add(n):t.classList.remove(n)})};var b=function(t){var n=t.data;typeof n=="string"&&(n=JSON.parse(n));switch(n.type){case"toolbar":return d.dispatchEvent({data:n.msg});case"hashchange":n.replace&&window.history.replaceState?window.history.replaceState(null,n.title,n.hash||"#"):window.location.hash=n.hash;break;case"childReady":console.assert(t.source===p.contentWindow),e.body.classList.remove("splash"),t.ports&&t.ports.length>0?(d=t.ports[0],d.addEventListener("message",y,!1),d.start()):(console.log("Using emulated MessageChannel"),d={dispatchEvent:function(e){y(e)},postMessage:function(e){var n={type:"toolbar",msg:e};t.source.postMessage(JSON.stringify(n),t.origin)}});break;default:console.warn("Unexpected parent message",t)}};window.addEventListener("message",b,!1);var w=function(){p.contentWindow.location.hash=e.location.hash};window.addEventListener("hashchange",w,!1);var E=e.getElementById("wrapper");p.id="inner",p.scrolling="no",p.src="ncolors.html"+e.location.hash,E.appendChild(p),E.appendChild(h.elem),h.elem.id="dragshadow",h.hammer=new r(h.elem,{prevent_default:!0,transform:!1,tap_double:!1}),h.hammer.ondragstart=function(e){h.setDragging(!0)},h.hammer.ondrag=function(e){h.move(h.x+e.distanceX,h.y+e.distanceY)},h.hammer.ondragend=function(e){h.drop()};var S=e.getElementById("toolbarButtons"),x=function(t,n,r){var s,o=e.createElement("a");return o.href="#",o.classList.add("icon"),o.classList.add(t),typeof r=="string"&&(r=[r]),r.forEach(function(e){o.classList.add("mode-"+e)}),n?(s=S.querySelector(".group."+n),s||(s=e.createElement("span"),s.classList.add("group"),s.classList.add(n),S.appendChild(s))):s=S,s.appendChild(o),o.addEventListener("click",i(function(e){f({type:t+"Button"})}),!1),o.addEventListener("dblclick",i(),!1),e.body.classList.contains("dev")||o.addEventListener("contextmenu",i(),!1),o},T=x("undo","left","drawing"),N=x("redo","left","drawing"),C=x("play","left","drawing"),k=x("color","center",["drawing","brushdialog"]),L=x("brush","center",["drawing","brushdialog"]),A=function(t){var n=e.createElement("a");return n.href="#",n.classList.add("swatch"),n.classList.add(t),n.classList.add("mode-drawing"),n.classList.add("mode-brushdialog"),S.querySelector(".group.center").appendChild(n),n},O=["red","orange","yellow","green","blue","indigo","violet","white","brown","black"],M=O.map(function(e){return A(e)});M.forEach(function(t,n){var r=O[n];t.addEventListener("click",i(function(e){f({type:"swatchButton",color:r})}),!1),t.addEventListener("dblclick",i(),!1),e.body.classList.contains("dev")||t.addEventListener("contextmenu",i(),!1)}),u=function(t){var n=e.querySelectorAll(".swatch > span");Array.prototype.forEach.call(n,function(e){e.style.opacity=t})},a=function(e){S.querySelector(".icon.color").style.color=e};var _=x("layer","right","drawing"),D=x("save","right","drawing");_.classList.add("dev-only"),D.classList.add("dev-only");var P=x("trash","right","gallery");P.setAttribute("dropzone","move string:text/x-nell-colors"),P.addEventListener("dragenter",function(e){var t;for(t=0;t<e.dataTransfer.items.length;t++){var n=e.dataTransfer.items[t];if(n.type==="text/x-nell-colors"){e.preventDefault(),P.classList.add("dropping");return}}},!1),P.addEventListener("dragover",i(function(e){e.dataTransfer.dropEffect="move"}),!1),P.addEventListener("dragleave",i(function(e){P.classList.remove("dropping")}),!1),P.addEventListener("drop",function(e){var t;P.classList.remove("dropping");for(t=0;t<e.dataTransfer.items.length;t++){var n=e.dataTransfer.items[t];if(n.type==="text/x-nell-colors"){n.getAsString(function(e){f({type:"trashDrop",uuid:e})});return}}},!1)})